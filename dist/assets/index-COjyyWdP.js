import{r as a,j as e,V as ur,h as pr,i as jr,k as gr,X as fs,T as Nr,D as fr,l as Bn,m as br,n as Wn,U as Yn,L as yr,E as Hn,o as Re,S as vr,p as Ar,q as wr,t as Cr,v as Gn,w as Sr,I as kr,x as Lr,y as Dr,z as ws,B as Mr,F as _n,G as Pr,H as Er,J as qn,K as Kn,M as Tr,N as Jn,Q as Es,W as ka,Y as Xn,Z as tt,_ as Ut,$ as dt,a0 as Zt,a1 as Ns,a2 as Rs,a3 as ze,a4 as qe,a5 as Va,a6 as Zn,a7 as Qn,a8 as Ir,a9 as el,aa as Fr,ab as sl,ac as tl,O as Rr,c as al,C as Or,ad as rl,ae as Vr,af as $r,b as nl,ag as ll,ah as zs,ai as Vt,aj as La,ak as ra,al as Ts,am as Ya,an as zr,ao as us,ap as Ur,aq as Br,ar as il,as as na,at as Wr,au as dl,av as Yr,aw as cl,ax as Hr,ay as ol,az as Gr,aA as _r,aB as ml,aC as xl,aD as qr,aE as hl,aF as ul,aG as pl,R as Kr,aH as ma,aI as Jr,aJ as jl,aK as Xr,aL as Zr,aM as Qr,aN as en,aO as sn,aP as gl,aQ as Nl,aR as Le,aS as ps,aT as xa,aU as Ha,aV as Pt,aW as Et,aX as Xs,aY as la,aZ as Os,a_ as tn,a$ as fl,b0 as Vs,b1 as bl,b2 as an,b3 as rn,b4 as nn,b5 as yl,b6 as Qt,b7 as vl,b8 as Al,b9 as wl,ba as Cl,bb as Sl,bc as ia,bd as mt,be as ln,bf as xt,bg as Ps,bh as kl,bi as dn,bj as Ll,bk as ys,bl as cn,bm as Dl,bn as Ml,bo as Pl,bp as El,bq as Da,br as Ga,bs as ea,bt as on,bu as mn,bv as sa,bw as Tl,bx as Il,by as Fl,bz as xn,bA as hn,bB as ha,bC as Rl,bD as _a,bE as Ol,bF as Vl,bG as $l,bH as we,bI as _e,bJ as zl}from"./vendor-react-5YpA8TiW.js";import{H as Ul,I as Bl,J as da,K as Wl,$ as Yl,L as me,M as gs,N as Ae,R as Ma,O as $a,X as ht,Y as ut,T as Pa,Q as qa,S as qs,U as za,V as Ua,W as Ba,Z as Hl,a0 as Gl,a1 as Ot,a2 as un,a3 as Ea,a4 as _l,a5 as ua,a6 as pn,a7 as jn,a8 as gn,a9 as As,aa as Nn,ab as ql}from"./vendor-BgTKwk53.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const x of i)if(x.type==="childList")for(const g of x.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&n(g)}).observe(document,{childList:!0,subtree:!0});function t(i){const x={};return i.integrity&&(x.integrity=i.integrity),i.referrerPolicy&&(x.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?x.credentials="include":i.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function n(i){if(i.ep)return;i.ep=!0;const x=t(i);fetch(i.href,x)}})();const Kl=1,Jl=1e6;let pa=0;function Xl(){return pa=(pa+1)%Number.MAX_SAFE_INTEGER,pa.toString()}const ja=new Map,Ka=s=>{if(ja.has(s))return;const r=setTimeout(()=>{ja.delete(s),Tt({type:"REMOVE_TOAST",toastId:s})},Jl);ja.set(s,r)},Zl=(s,r)=>{switch(r.type){case"ADD_TOAST":return{...s,toasts:[r.toast,...s.toasts].slice(0,Kl)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(t=>t.id===r.toast.id?{...t,...r.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=r;return t?Ka(t):s.toasts.forEach(n=>{Ka(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===t||t===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return r.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(t=>t.id!==r.toastId)}}},qt=[];let Kt={toasts:[]};function Tt(s){Kt=Zl(Kt,s),qt.forEach(r=>{r(Kt)})}function Ql({...s}){const r=Xl(),t=i=>Tt({type:"UPDATE_TOAST",toast:{...i,id:r}}),n=()=>Tt({type:"DISMISS_TOAST",toastId:r});return Tt({type:"ADD_TOAST",toast:{...s,id:r,open:!0,onOpenChange:i=>{i||n()}}}),{id:r,dismiss:n,update:t}}function os(){const[s,r]=a.useState(Kt);return a.useEffect(()=>(qt.push(r),()=>{const t=qt.indexOf(r);t>-1&&qt.splice(t,1)}),[s]),{...s,toast:Ql,dismiss:t=>Tt({type:"DISMISS_TOAST",toastId:t})}}function ie(...s){return Ul(Bl(s))}const ei=Bn,fn=a.forwardRef(({className:s,...r},t)=>e.jsx(ur,{ref:t,className:ie("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...r}));fn.displayName=ur.displayName;const si=da("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),bn=a.forwardRef(({className:s,variant:r,...t},n)=>e.jsx(pr,{ref:n,className:ie(si({variant:r}),s),...t}));bn.displayName=pr.displayName;const ti=a.forwardRef(({className:s,...r},t)=>e.jsx(jr,{ref:t,className:ie("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...r}));ti.displayName=jr.displayName;const yn=a.forwardRef(({className:s,...r},t)=>e.jsx(gr,{ref:t,className:ie("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...r,children:e.jsx(fs,{className:"h-4 w-4"})}));yn.displayName=gr.displayName;const vn=a.forwardRef(({className:s,...r},t)=>e.jsx(Nr,{ref:t,className:ie("text-sm font-semibold",s),...r}));vn.displayName=Nr.displayName;const An=a.forwardRef(({className:s,...r},t)=>e.jsx(fr,{ref:t,className:ie("text-sm opacity-90",s),...r}));An.displayName=fr.displayName;function ai(){const{toasts:s}=os();return e.jsxs(ei,{children:[s.map(function({id:r,title:t,description:n,action:i,...x}){return e.jsxs(bn,{...x,children:[e.jsxs("div",{className:"grid gap-1",children:[t&&e.jsx(vn,{children:t}),n&&e.jsx(An,{children:n})]}),i,e.jsx(yn,{})]},r)}),e.jsx(fn,{})]})}const ri=({...s})=>{const{theme:r="system"}=Wl();return e.jsx(Yl,{theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...s})},ni=Wn,li=a.forwardRef(({className:s,sideOffset:r=4,...t},n)=>e.jsx(br,{ref:n,sideOffset:r,className:ie("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t}));li.displayName=br.displayName;const wn=a.createContext({user:null,isLoading:!0,login:()=>{},logout:()=>{}}),Cs=()=>a.useContext(wn),ii=({children:s})=>{const[r,t]=a.useState(null),[n,i]=a.useState(!0);a.useEffect(()=>{const p=localStorage.getItem("token"),d=localStorage.getItem("user");if(p&&d){const j=JSON.parse(d);t({...j,token:p})}i(!1)},[]),a.useEffect(()=>{const p=me.interceptors.request.use(d=>{const j=localStorage.getItem("token");return j&&(d.headers&&"set"in d.headers?d.headers.set("Authorization",`Bearer ${j}`):d.headers.Authorization=`Bearer ${j}`),d},d=>Promise.reject(d));return()=>{me.interceptors.request.eject(p)}},[]);const x=p=>{t(p),localStorage.setItem("token",p.token),localStorage.setItem("user",JSON.stringify(p))},g=()=>{t(null),localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"};return e.jsx(wn.Provider,{value:{user:r,isLoading:n,login:x,logout:g},children:s})},Ja=({onSuccess:s,backgroundImage:r=null})=>{const{login:t}=Cs(),[n,i]=a.useState({username:"",password:""}),[x,g]=a.useState(!1),[p,d]=a.useState(""),[j,P]=a.useState(!1),W=async T=>{var J,X;T.preventDefault(),d(""),P(!0);try{const V=await me.post("http://13.202.62.178:9090/backend-dfds/api/auth/login",{username:n.username.trim(),password:n.password});if(V.data&&V.data.token){const F={token:V.data.token,mobile:V.data.mobile,agencyCode:V.data.agencyCode,role:V.data.role,designation:V.data.designation,fullName:V.data.fullName,districtId:V.data.districtId,districtName:V.data.districtName,username:n.username.trim()};t(F),s()}else d("Invalid response from server.")}catch(w){d(((X=(J=w.response)==null?void 0:J.data)==null?void 0:X.message)||"Invalid username or password. Please try again.")}finally{P(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-br from-blue-600/5 via-purple-600/5 to-indigo-600/5"}),e.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-blue-400/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-purple-400/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-80 h-80 bg-indigo-400/5 rounded-full blur-3xl"})]}),e.jsx("div",{className:"relative z-10 pt-8 pb-4 text-center",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-bold text-gray-800 mb-4",children:"e-SAMARTH"}),e.jsx("p",{className:"text-lg sm:text-xl md:text-2xl text-gray-600 font-medium leading-relaxed",children:"System For Allocation Of Anudan For Representatives of The House"}),e.jsx("div",{className:"w-24 h-1 bg-gradient-to-r from-blue-500 to-purple-600 mx-auto mt-4 rounded-full"})]})}),e.jsx("div",{className:"relative z-10 flex items-center justify-center px-4 py-8",children:e.jsxs("form",{onSubmit:W,className:"bg-white/95 backdrop-blur-sm mt-5 border border-gray-200 p-4 sm:p-6 rounded-lg shadow-xl w-full max-w-xs sm:max-w-sm md:max-w-md lg:max-w-sm relative z-10 transform transition-all duration-300 hover:scale-[1.01] hover:shadow-2xl animate-fade-in",autoComplete:"off",children:[e.jsx("div",{className:"mb-4 sm:mb-5 text-center",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-base sm:text-lg md:text-xl font-bold text-gray-800",children:"Welcome Back"}),e.jsx("p",{className:"text-gray-500 text-xs sm:text-sm",children:"Sign in to your account"})]})}),p&&e.jsx("div",{className:"mb-3 p-2 bg-gradient-to-r from-red-50 to-red-100 border border-red-200 rounded-md text-center transform transition-all duration-300 animate-shake",children:e.jsx("span",{className:"text-red-700 font-medium text-xs",children:p})}),e.jsxs("div",{className:"mb-3 sm:mb-4 relative group",children:[e.jsx("label",{className:"block mb-1 font-medium text-gray-700 text-xs sm:text-sm",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-2.5 sm:pl-3 flex items-center pointer-events-none",children:e.jsx(Yn,{className:"text-gray-400 group-focus-within:text-blue-500 transition-colors duration-200",size:14})}),e.jsx("input",{type:"text",className:"w-full pl-8 sm:pl-10 pr-3 sm:pr-4 py-2 sm:py-2.5 bg-white border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-transparent outline-none transition-all duration-200 placeholder-gray-400 text-xs sm:text-sm",placeholder:"Enter your username",value:n.username,onChange:T=>i({...n,username:T.target.value}),autoFocus:!0,required:!0})]})]}),e.jsxs("div",{className:"mb-4 sm:mb-5 relative group",children:[e.jsx("label",{className:"block mb-1 font-medium text-gray-700 text-xs sm:text-sm",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-2.5 sm:pl-3 flex items-center pointer-events-none",children:e.jsx(yr,{className:"text-gray-400 group-focus-within:text-blue-500 transition-colors duration-200",size:14})}),e.jsx("input",{type:x?"text":"password",className:"w-full pl-8 sm:pl-10 pr-8 sm:pr-10 py-2 sm:py-2.5 bg-white border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-transparent outline-none transition-all duration-200 placeholder-gray-400 text-xs sm:text-sm",placeholder:"Enter your password",value:n.password,onChange:T=>i({...n,password:T.target.value}),required:!0}),e.jsx("button",{type:"button",tabIndex:-1,onClick:()=>g(T=>!T),className:"absolute inset-y-0 right-0 pr-2.5 sm:pr-3 flex items-center text-gray-400 hover:text-blue-500 transition-colors duration-200","aria-label":x?"Hide password":"Show password",children:x?e.jsx(Hn,{size:14}):e.jsx(Re,{size:14})})]})]}),e.jsx("button",{type:"submit",className:"w-full py-2 sm:py-2.5 md:py-3 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-md font-semibold text-sm sm:text-base shadow-md transform transition-all duration-200 hover:scale-[1.01] hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",disabled:j,children:j?e.jsxs("div",{className:"flex items-center justify-center space-x-1.5 sm:space-x-2",children:[e.jsx("div",{className:"w-3 h-3 sm:w-4 sm:h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Signing in..."})]}):e.jsx("span",{children:"Sign In"})}),e.jsxs("div",{className:"mt-4 sm:mt-5 text-center",children:[e.jsx("div",{className:"w-full h-px bg-gradient-to-r from-transparent via-gray-300 to-transparent mb-2 sm:mb-3"}),e.jsxs("p",{className:"text-xs sm:text-sm text-gray-500",children:["© ",new Date().getFullYear()," e-SAMARTH"]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"Maharashtra Government"})]})]})})]})},Wa=da("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),L=a.forwardRef(({className:s,variant:r,size:t,asChild:n=!1,...i},x)=>{const g=n?vr:"button";return e.jsx(g,{className:ie(Wa({variant:r,size:t,className:s})),ref:x,...i})});L.displayName="Button";const Xa=qn,Za=Kn,di=a.forwardRef(({className:s,inset:r,children:t,...n},i)=>e.jsxs(Ar,{ref:i,className:ie("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",r&&"pl-8",s),...n,children:[t,e.jsx(wr,{className:"ml-auto h-4 w-4"})]}));di.displayName=Ar.displayName;const ci=a.forwardRef(({className:s,...r},t)=>e.jsx(Cr,{ref:t,className:ie("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r}));ci.displayName=Cr.displayName;const Ta=a.forwardRef(({className:s,sideOffset:r=4,...t},n)=>e.jsx(Gn,{children:e.jsx(Sr,{ref:n,sideOffset:r,className:ie("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t})}));Ta.displayName=Sr.displayName;const Dt=a.forwardRef(({className:s,inset:r,...t},n)=>e.jsx(kr,{ref:n,className:ie("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r&&"pl-8",s),...t}));Dt.displayName=kr.displayName;const oi=a.forwardRef(({className:s,children:r,checked:t,...n},i)=>e.jsxs(Lr,{ref:i,className:ie("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:t,...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Dr,{children:e.jsx(ws,{className:"h-4 w-4"})})}),r]}));oi.displayName=Lr.displayName;const mi=a.forwardRef(({className:s,children:r,...t},n)=>e.jsxs(Mr,{ref:n,className:ie("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Dr,{children:e.jsx(_n,{className:"h-2 w-2 fill-current"})})}),r]}));mi.displayName=Mr.displayName;const Ia=a.forwardRef(({className:s,inset:r,...t},n)=>e.jsx(Pr,{ref:n,className:ie("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",s),...t}));Ia.displayName=Pr.displayName;const Jt=a.forwardRef(({className:s,...r},t)=>e.jsx(Er,{ref:t,className:ie("-mx-1 my-1 h-px bg-muted",s),...r}));Jt.displayName=Er.displayName;const xi=da("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ye({className:s,variant:r,...t}){return e.jsx("div",{className:ie(xi({variant:r}),s),...t})}const hi=()=>{const s=Tr(),{user:r,logout:t}=Cs(),[n]=a.useState([{id:1,message:"New fund allocation approved",type:"success"}]),i=()=>{t(),s("/login",{replace:!0})};return e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 h-16 fixed top-0 left-64 right-0 z-40",children:e.jsxs("div",{className:"flex items-center justify-between h-full px-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"E-SAMARTH Portal"}),e.jsxs(ye,{variant:"secondary",className:"bg-primary/10 text-primary",children:[r==null?void 0:r.role," Dashboard"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(Xa,{children:[e.jsx(Za,{asChild:!0,children:e.jsxs(L,{variant:"ghost",size:"sm",className:"relative",children:[e.jsx(Jn,{className:"h-5 w-5"}),n.length>0&&e.jsx(ye,{className:"absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center bg-red-500 text-white text-xs",children:n.length})]})}),e.jsxs(Ta,{align:"end",className:"w-80",children:[e.jsx(Ia,{children:"Notifications"}),e.jsx(Jt,{}),n.map(x=>e.jsx(Dt,{className:"p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${x.type==="success"?"bg-green-500":x.type==="warning"?"bg-yellow-500":"bg-blue-500"}`}),e.jsx("span",{className:"text-sm",children:x.message})]})},x.id))]})]}),e.jsxs(Xa,{children:[e.jsx(Za,{asChild:!0,children:e.jsxs(L,{variant:"ghost",size:"sm",className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center",children:e.jsx(Es,{className:"h-4 w-4 text-white"})}),e.jsx("span",{className:"font-medium",children:r==null?void 0:r.name})]})}),e.jsxs(Ta,{align:"end",children:[e.jsx(Ia,{children:"My Account"}),e.jsx(Jt,{}),e.jsxs(Dt,{children:[e.jsx(Es,{className:"mr-2 h-4 w-4"}),"Profile"]}),e.jsxs(Dt,{children:[e.jsx(ka,{className:"mr-2 h-4 w-4"}),"Settings"]}),e.jsx(Jt,{}),e.jsxs(Dt,{onClick:i,className:"text-red-600",children:[e.jsx(Xn,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]})]})]})})},Qa={STATE_ADMIN:[{path:"/dashboard",icon:tt,label:"Dashboard"},{path:"/budget-allocation",icon:Zt,label:"Budget Allocation"},{path:"/mla-fund-demands",icon:Ut,label:"View Fund Demands"},{path:"/mla-mlc-master",icon:Ns,label:"MLA|MLC Master"},{path:"/district-management",icon:Va,label:"District Master"},{path:"/fund-history",icon:Zn,label:"Vouchers"},{path:"/reports",icon:dt,label:"Reports"}],DISTRICT_ADMIN:[{path:"/district-dashboard",icon:tt,label:"Dashboard"},{path:"/view-demands",icon:qe,label:"View IA Demands"},{path:"/mla-mlc-recommendation",icon:Ut,label:"MLA Recommendations"},{path:"/ia-master",icon:Ns,label:"IA Master"},{path:"/reports",icon:dt,label:"Reports"}],IA_ADMIN:[{path:"/iadashboard",icon:tt,label:"Dashboard"},{path:"/fund-demand",icon:Zt,label:"Fund Demand"},{path:"/vendor-master",icon:Ns,label:"Vendor Master"},{path:"/work-vendor",icon:Rs,label:"Work Vendor Mapping"},{path:"/tax-master",icon:ze,label:"Tax/Deduction Master"},{path:"/reports",icon:dt,label:"Reports"}],MLA:[{path:"/mla/dashboard",icon:tt,label:"Dashboard"},{path:"/mla/view-recommendation",icon:Ut,label:"Recommend Work"},{path:"/mla/reports",icon:dt,label:"Reports"}],MLC:[{path:"/mlc/dashboard",icon:tt,label:"Dashboard"},{path:"/mlc/view-recommendation",icon:Ut,label:"Recommend Work"},{path:"/mlc/reports",icon:dt,label:"Reports"}],VENDOR:[{path:"/vendor/dashboard",icon:tt,label:"Dashboard"}]},ui=()=>{const{user:s}=Cs(),r=(s==null?void 0:s.role)||"IA_ADMIN",t=Qa[r]||Qa.IA_ADMIN;return e.jsxs("aside",{className:"bg-white shadow-lg h-full w-64 fixed left-0 top-0 z-50 border-r border-gray-200 flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"MH"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-gray-900 text-lg",children:"FMS"}),e.jsxs("p",{className:"text-xs text-gray-600",children:[r.replace("_"," ")," Portal"]})]})]})}),e.jsx("nav",{className:"flex-1 mt-6 px-4",children:e.jsx("ul",{className:"space-y-2",children:t.map(n=>e.jsx("li",{children:e.jsxs(Qn,{to:n.path,className:({isActive:i})=>`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors duration-200 ${i?"bg-primary text-white shadow-md":"text-gray-700 hover:bg-gray-100 hover:text-primary"}`,children:[e.jsx(n.icon,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:n.label})]})},n.path))})}),e.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s==null?void 0:s.username}),e.jsx("p",{className:"text-xs text-gray-600",children:(s==null?void 0:s.designation)||""}),e.jsx("p",{className:"text-xs text-gray-500",children:(s==null?void 0:s.mobile)||""})]})})]})},pi=({children:s})=>e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(ui,{}),e.jsx(hi,{}),e.jsx("main",{className:"ml-64 pt-16",children:e.jsx("div",{className:"p-6",children:s})})]}),O=a.forwardRef(({className:s,...r},t)=>e.jsx("div",{ref:t,className:ie("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r}));O.displayName="Card";const se=a.forwardRef(({className:s,...r},t)=>e.jsx("div",{ref:t,className:ie("flex flex-col space-y-1.5 p-6",s),...r}));se.displayName="CardHeader";const ee=a.forwardRef(({className:s,...r},t)=>e.jsx("h3",{ref:t,className:ie("text-2xl font-semibold leading-none tracking-tight",s),...r}));ee.displayName="CardTitle";const Ce=a.forwardRef(({className:s,...r},t)=>e.jsx("p",{ref:t,className:ie("text-sm text-muted-foreground",s),...r}));Ce.displayName="CardDescription";const $=a.forwardRef(({className:s,...r},t)=>e.jsx("div",{ref:t,className:ie("p-6 pt-0",s),...r}));$.displayName="CardContent";const ji=a.forwardRef(({className:s,...r},t)=>e.jsx("div",{ref:t,className:ie("flex items-center p-6 pt-0",s),...r}));ji.displayName="CardFooter";const gi=da("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),S=a.forwardRef(({className:s,...r},t)=>e.jsx(Ir,{ref:t,className:ie(gi(),s),...r}));S.displayName=Ir.displayName;const Ke=a.forwardRef(({className:s,...r},t)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:t,className:ie("w-full caption-bottom text-sm",s),...r})}));Ke.displayName="Table";const Be=a.forwardRef(({className:s,...r},t)=>e.jsx("thead",{ref:t,className:ie("[&_tr]:border-b",s),...r}));Be.displayName="TableHeader";const We=a.forwardRef(({className:s,...r},t)=>e.jsx("tbody",{ref:t,className:ie("[&_tr:last-child]:border-0",s),...r}));We.displayName="TableBody";const js=a.forwardRef(({className:s,...r},t)=>e.jsx("tfoot",{ref:t,className:ie("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...r}));js.displayName="TableFooter";const ue=a.forwardRef(({className:s,...r},t)=>e.jsx("tr",{ref:t,className:ie("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...r}));ue.displayName="TableRow";const U=a.forwardRef(({className:s,...r},t)=>e.jsx("th",{ref:t,className:ie("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...r}));U.displayName="TableHead";const h=a.forwardRef(({className:s,...r},t)=>e.jsx("td",{ref:t,className:ie("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...r}));h.displayName="TableCell";const Ni=a.forwardRef(({className:s,...r},t)=>e.jsx("caption",{ref:t,className:ie("mt-4 text-sm text-muted-foreground",s),...r}));Ni.displayName="TableCaption";const $t=sl,zt=tl,jt=a.forwardRef(({className:s,align:r="center",sideOffset:t=4,...n},i)=>e.jsx(el,{children:e.jsx(Fr,{ref:i,align:r,sideOffset:t,className:ie("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})}));jt.displayName=Fr.displayName;const ts=nl,gt=ll,fi=al,Cn=a.forwardRef(({className:s,...r},t)=>e.jsx(Rr,{ref:t,className:ie("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r}));Cn.displayName=Rr.displayName;const Ze=a.forwardRef(({className:s,children:r,...t},n)=>e.jsxs(fi,{children:[e.jsx(Cn,{}),e.jsxs(Or,{ref:n,className:ie("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t,children:[r,e.jsxs(rl,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(fs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ze.displayName=Or.displayName;const as=({className:s,...r})=>e.jsx("div",{className:ie("flex flex-col space-y-1.5 text-center sm:text-left",s),...r});as.displayName="DialogHeader";const ta=({className:s,...r})=>e.jsx("div",{className:ie("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...r});ta.displayName="DialogFooter";const rs=a.forwardRef(({className:s,...r},t)=>e.jsx(Vr,{ref:t,className:ie("text-lg font-semibold leading-none tracking-tight",s),...r}));rs.displayName=Vr.displayName;const Zs=a.forwardRef(({className:s,...r},t)=>e.jsx($r,{ref:t,className:ie("text-sm text-muted-foreground",s),...r}));Zs.displayName=$r.displayName;const Nt=a.forwardRef(({className:s,...r},t)=>e.jsx(gs,{ref:t,className:ie("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",s),...r}));Nt.displayName=gs.displayName;const ft=a.forwardRef(({className:s,...r},t)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(zs,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(gs.Input,{ref:t,className:ie("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",s),...r})]}));ft.displayName=gs.Input.displayName;const bi=a.forwardRef(({className:s,...r},t)=>e.jsx(gs.List,{ref:t,className:ie("max-h-[300px] overflow-y-auto overflow-x-hidden",s),...r}));bi.displayName=gs.List.displayName;const bt=a.forwardRef((s,r)=>e.jsx(gs.Empty,{ref:r,className:"py-6 text-center text-sm",...s}));bt.displayName=gs.Empty.displayName;const yt=a.forwardRef(({className:s,...r},t)=>e.jsx(gs.Group,{ref:t,className:ie("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",s),...r}));yt.displayName=gs.Group.displayName;const yi=a.forwardRef(({className:s,...r},t)=>e.jsx(gs.Separator,{ref:t,className:ie("-mx-1 h-px bg-border",s),...r}));yi.displayName=gs.Separator.displayName;const vt=a.forwardRef(({className:s,...r},t)=>e.jsx(gs.Item,{ref:t,className:ie("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",s),...r}));vt.displayName=gs.Item.displayName;const ct=[{districtCode:"HADP-AMB",district:"Pune",taluka:"Ambegaon",planType:"HADP",financialYear:"2025-26",demandCode:"Ambegaon",schemeCode:"HADP01",schemeName:"HADP Special Scheme",head:"—",demandAmount:2e4,spillAmount:98.18,remainingBalance:101.82,status:"Approved"},{districtCode:"HADP-JUN",district:"Pune",taluka:"Junnar",planType:"HADP",financialYear:"2025-26",demandCode:"Junnar",schemeCode:"HADP02",schemeName:"HADP Development Grant",head:"—",demandAmount:2e4,spillAmount:57.29,remainingBalance:142.71,status:"Approved"},{districtCode:"HADP-MAW",district:"Pune",taluka:"Mawal",planType:"HADP",financialYear:"2025-26",demandCode:"Mawal",schemeCode:"HADP03",schemeName:"HADP Rural Infrastructure",head:"—",demandAmount:2e4,spillAmount:114.18,remainingBalance:85.82,status:"Approved"},{districtCode:"HADP-BHO",district:"Pune",taluka:"Bhor",planType:"HADP",financialYear:"2025-26",demandCode:"Bhor",schemeCode:"HADP04",schemeName:"HADP Infrastructure Upgrade",head:"—",demandAmount:2e4,spillAmount:52.15,remainingBalance:147.85,status:"Approved"},{districtCode:"HADP-MUL",district:"Pune",taluka:"Mulshi",planType:"HADP",financialYear:"2025-26",demandCode:"Mulshi",schemeCode:"HADP05",schemeName:"HADP Special Grant",head:"—",demandAmount:2e4,spillAmount:60,remainingBalance:140,status:"Approved"},{districtCode:"HADP-VEL",district:"Pune",taluka:"Velhe",planType:"HADP",financialYear:"2025-26",demandCode:"Velhe",schemeCode:"HADP06",schemeName:"HADP Village Development",head:"—",demandAmount:2e4,spillAmount:65,remainingBalance:135,status:"Approved"},{districtCode:"HADP-PUR",district:"Pune",taluka:"Purandar",planType:"HADP",financialYear:"2025-26",demandCode:"Purandar",schemeCode:"HADP07",schemeName:"HADP Sustainable Growth",head:"—",demandAmount:2e4,spillAmount:22.29,remainingBalance:177.71,status:"Approved"},{districtCode:"HADP-KHE",district:"Pune",taluka:"Khed",planType:"HADP",financialYear:"2025-26",demandCode:"Khed",schemeCode:"HADP08",schemeName:"HADP Rural Roads",head:"—",demandAmount:2e4,spillAmount:101.98,remainingBalance:98.02,status:"Approved"},{districtCode:"HADP-HAW",district:"Pune",taluka:"Haweli",planType:"HADP",financialYear:"2025-26",demandCode:"Haweli",schemeCode:"HADP09",schemeName:"HADP Green Pune",head:"—",demandAmount:2e4,spillAmount:33.54,remainingBalance:166.46,status:"Approved"},{districtCode:"HADP-SHI",district:"Pune",taluka:"Shirur",planType:"HADP",financialYear:"2025-26",demandCode:"Shirur",schemeCode:"HADP10",schemeName:"HADP Urban-Rural Link",head:"—",demandAmount:1e4,spillAmount:49.98,remainingBalance:50.02,status:"Approved"},{districtCode:"HADP-DAU",district:"Pune",taluka:"Daund",planType:"HADP",financialYear:"2025-26",demandCode:"Daund",schemeCode:"HADP11",schemeName:"HADP Development Package",head:"—",demandAmount:1e4,spillAmount:105,remainingBalance:-5,status:"Approved"}],Hs=s=>Array.from(new Set(s)),at={financialYear:"2025-2026",data:[{district:"PUNE",taluka:"Pimpri",type:"MLA",term:15,name:"Anna Dadu Bansode",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:2e4},{district:"PUNE",taluka:"Baramati",type:"MLA",term:14,name:"Ajit Anantrao Pawar",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:1e4},{district:"PUNE",taluka:"Khed Alandi",type:"MLA",term:15,name:"Babaji Ramchandra Kale",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:1e4},{district:"PUNE",taluka:"Vadgaon Sheri",type:"MLA",term:14,name:"Bapusaheb Tukaram Pathare",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Khadakwasala",type:"MLA",term:14,name:"Bhimrao Dhondiba Tapkir",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Bhosari",type:"MLA",term:15,name:"Mahesh Landge",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Hadapsar",type:"MLA",term:15,name:"Chetan Tupe",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Kothrud",type:"MLA",term:15,name:"Chandrakant Bachhu Patil",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Indapur",type:"MLA",term:15,name:"Dattatraya Vithoba Bharne",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Shirur",type:"MLA",term:14,name:"Dnyaneshwar Katke",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Ambegaon",type:"MLA",term:14,name:"Dilip Walse-Patil",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Kasba Peth",type:"MLA",term:15,name:"Hemant Narayan Rasane",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Chinchwad",type:"MLA",term:14,name:"Shankar Jagtap",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Bhor",type:"MLA",term:15,name:"Shankar Hiraman Mandekar",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Shivajinagar",type:"MLA",term:15,name:"Siddharth Shirole",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Pune Cantonment",type:"MLA",term:14,name:"Suni Dnyandev Kamble",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Maval",type:"MLA",term:15,name:"Sunil Shankarrao Shelke",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Parvati",type:"MLA",term:15,name:"Madhuri Satish Misal",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Daund",type:"MLA",term:14,name:"Rahul Subhashrao Kul",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Junnar",type:"MLA",term:14,name:"Sharad Sonavane",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Purandar",type:"MLA",term:14,name:"Vijay Shivtare",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Purandar",type:"MLC",term:14,name:"Vijay Shivtare",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:"150000",fundUtilized:0,balance:7e4,pendingDemands:0}]};function ga(...s){return s.filter(Boolean).join(" ")}function Fs({value:s,onValueChange:r,options:t,placeholder:n="Select...",className:i}){const[x,g]=a.useState(!1),p=a.useMemo(()=>{const j=[...t],P=j.includes("All"),W=j.filter(T=>T!=="All").sort((T,J)=>T.localeCompare(J,"en",{sensitivity:"base"}));return P?["All",...W]:W},[t]),d=s||n;return e.jsxs($t,{open:x,onOpenChange:g,children:[e.jsx(zt,{asChild:!0,children:e.jsxs(L,{variant:"outline",role:"combobox","aria-expanded":x,className:ga("w-full justify-between",i),children:[e.jsx("span",{className:ga(!s&&"text-muted-foreground"),children:d||n}),e.jsx(Vt,{className:"ml-2 h-4 w-4 opacity-50"})]})}),e.jsx(jt,{className:"p-0 w-[--radix-popover-trigger-width] min-w-[220px]",children:e.jsxs(Nt,{children:[e.jsx(ft,{placeholder:"Search..."}),e.jsx(bt,{children:"No results found."}),e.jsx(yt,{className:"max-h-64 overflow-auto",children:p.map(j=>{const P=s===j;return e.jsxs(vt,{value:j,onSelect:W=>{r(W),g(!1)},children:[e.jsx(ws,{className:ga("mr-2 h-4 w-4",P?"opacity-100":"opacity-0")}),e.jsx("span",{children:j})]},j)})})]})})]})}const er=()=>{const[s,r]=a.useState(at.financialYear),[t,n]=a.useState("ML-MLA"),[i,x]=a.useState("All"),[g,p]=a.useState("All"),[d,j]=a.useState("All"),[P,W]=a.useState("All"),[T,J]=a.useState("All"),[X,w]=a.useState("All"),[V,F]=a.useState(!1);a.useEffect(()=>{F(!1),x("All"),p("All"),j("All"),W("All"),J("All"),w("All")},[t]),a.useEffect(()=>{p("All"),F(!1)},[i]),a.useEffect(()=>{W("All"),F(!1)},[d]),a.useEffect(()=>{w("All")},[T]);const N=a.useMemo(()=>["All",at.financialYear],[]),b=["ML-MLA","ML-MLC","HADP"],A=a.useMemo(()=>at.data.filter(E=>E.type==="MLA"),[]),C=a.useMemo(()=>["All",...Hs(A.map(E=>E.district))],[A]),q=a.useMemo(()=>{const E=A.filter(R=>i==="All"||R.district===i).map(R=>R.name);return["All",...Hs(E)]},[A,i]),Z=a.useMemo(()=>at.data.filter(E=>E.type==="MLC"),[]),B=a.useMemo(()=>["All",...Hs(Z.map(E=>E.district))],[Z]),te=a.useMemo(()=>{const E=Z.filter(R=>d==="All"||R.district===d).map(R=>R.name);return["All",...Hs(E)]},[Z,d]),Q=a.useMemo(()=>["All",...Hs(ct.map(E=>E.district||"Unknown"))],[]),G=a.useMemo(()=>T==="All"?["All",...Hs(ct.map(E=>E.taluka||"Unknown"))]:["All",...Hs(ct.filter(E=>E.district===T).map(E=>E.taluka||"Unknown"))],[T]),l=a.useMemo(()=>{let E=A.filter(R=>s==="All"||at.financialYear===s).filter(R=>i==="All"||R.district===i).filter(R=>g==="All"||R.name===g).filter(R=>!V||R.pendingDemands>0);return E=[...E].sort((R,z)=>R.name.localeCompare(z.name,"en",{sensitivity:"base"})),E},[A,s,i,g,V]),M=a.useMemo(()=>{let E=Z.filter(R=>s==="All"||at.financialYear===s).filter(R=>d==="All"||R.district===d).filter(R=>P==="All"||R.name===P).filter(R=>!V||R.pendingDemands>0);return E=[...E].sort((R,z)=>R.name.localeCompare(z.name,"en",{sensitivity:"base"})),E},[Z,s,d,P,V]),m=a.useMemo(()=>{let E=ct;T!=="All"&&(E=E.filter(re=>re.district===T)),X!=="All"&&(E=E.filter(re=>re.taluka===X));const R={};E.forEach(re=>{R[re.demandCode]||(R[re.demandCode]={budget:0,utilized:0,balance:0,pendingDemands:0,demandCode:re.demandCode}),R[re.demandCode].budget+=re.demandAmount,re.status==="Approved"?R[re.demandCode].utilized+=re.demandAmount:R[re.demandCode].balance+=re.demandAmount,re.status!=="Approved"&&(R[re.demandCode].pendingDemands+=re.demandAmount)});let z=Object.values(R);return z=z.sort((re,xe)=>re.demandCode.localeCompare(xe.demandCode,"en",{sensitivity:"base"})),z},[T,X,V]),y=E=>(E/1).toFixed(1),o=(E,R)=>R>0?`${(E/R*100).toFixed(1)}%`:"0%",ne=a.useMemo(()=>A.reduce((E,R)=>E+R.budget,0),[A]),he=a.useMemo(()=>Z.reduce((E,R)=>E+R.budget,0),[Z]),k=a.useMemo(()=>ct.reduce((E,R)=>E+R.demandAmount,0),[]),c=a.useMemo(()=>l.reduce((E,R)=>(E.budget+=R.budget,E.utilized+=R.fundUtilized,E.pendingDemands+=R.pendingDemands,E.balance+=R.balance,E),{budget:0,utilized:0,pendingDemands:0,balance:0}),[l]),D=a.useMemo(()=>M.reduce((E,R)=>(E.budget+=R.budget,E.utilized+=R.fundUtilized,E.pendingDemands+=R.pendingDemands,E.balance+=R.balance,E),{budget:0,utilized:0,pendingDemands:0,balance:0}),[M]),de=a.useMemo(()=>m.reduce((E,R)=>(E.budget+=R.budget,E.utilized+=R.utilized,E.balance+=R.balance,E.pendingDemands+=R.pendingDemands,E),{budget:0,utilized:0,pendingDemands:0,balance:0}),[m]),I=a.useMemo(()=>A.length,[A]),H=0,oe=13,pe=a.useMemo(()=>t==="ML-MLA"?[{title:"Total MLA Budget Sanctioned",value:c.budget,whole:c.budget,color:"green",sub:`Total MLAs: ${I}`},{title:"Disbursed Amount",value:c.utilized,whole:c.budget,color:"yellow",sub:`Demands: ${H}`},{title:"MLA Balance Amount",value:c.balance,whole:c.budget,color:"red",sub:""},{title:"MLA Pending Demands",value:c.pendingDemands,whole:c.budget,color:"orange",sub:`No. of Demands: ${oe}`}]:t==="ML-MLC"?[{title:"Total MLC Budget",value:D.budget,whole:D.budget,color:"blue",sub:""},{title:"MLC Total Funds Disbursed",value:D.utilized,whole:D.budget,color:"green",sub:""},{title:"MLC Balance Budget Amount",value:D.balance,whole:D.budget,color:"red",sub:""},{title:"Pending Demand Amount",value:D.pendingDemands,whole:D.budget,color:"yellow",sub:""}]:[{title:"Total HADP Budget",value:de.budget,whole:de.budget,color:"blue",sub:""},{title:"Total Funds Approved",value:de.utilized,whole:de.budget,color:"green",sub:""},{title:"HADP Balance Budget ",value:de.balance,whole:de.budget,color:"red",sub:""},{title:"HADP Pending Demand Amount",value:de.pendingDemands,whole:de.budget,color:"yellow",sub:""}],[t,c,D,de,I]);return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm",children:[e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx(S,{className:"mb-1 block",htmlFor:"fy",children:"Financial Year"}),e.jsx(Fs,{value:s,onValueChange:r,options:N,placeholder:"Select Financial Year"})]}),e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx(S,{className:"mb-1 block",htmlFor:"plan",children:"Plan Type"}),e.jsx(Fs,{value:t,onValueChange:E=>n(E),options:b,placeholder:"Select Plan Type"})]}),t==="ML-MLA"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1 min-w-[220px]",children:[e.jsx(S,{className:"mb-1 block",htmlFor:"mlaDistrict",children:"District"}),e.jsx(Fs,{value:i,onValueChange:x,options:C,placeholder:"Select District"})]}),e.jsxs("div",{className:"flex-1 min-w-[220px]",children:[e.jsx(S,{className:"mb-1 block",htmlFor:"mlaname",children:"MLA Name"}),e.jsx(Fs,{value:g,onValueChange:p,options:q,placeholder:"Select MLA"})]})]}),t==="ML-MLC"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1 min-w-[220px]",children:[e.jsx(S,{className:"mb-1 block",htmlFor:"mlcDistrict",children:"Nodal District"}),e.jsx(Fs,{value:d,onValueChange:j,options:B,placeholder:"Select District"})]}),e.jsxs("div",{className:"flex-1 min-w-[220px]",children:[e.jsx(S,{className:"mb-1 block",htmlFor:"mlcname",children:"MLC Name"}),e.jsx(Fs,{value:P,onValueChange:W,options:te,placeholder:"Select MLC"})]})]}),t==="HADP"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1 min-w-[220px]",children:[e.jsx(S,{className:"mb-1 block",htmlFor:"hadpDistrict",children:"District"}),e.jsx(Fs,{value:T,onValueChange:J,options:Q,placeholder:"Select District"})]}),e.jsxs("div",{className:"flex-1 min-w-[220px]",children:[e.jsx(S,{className:"mb-1 block",htmlFor:"hadpTaluka",children:"Taluka"}),e.jsx(Fs,{value:X,onValueChange:w,options:G,placeholder:"Select Taluka"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3",children:[e.jsxs(Ae.div,{className:"col-span-6 sm:col-span-3 lg:col-span-2 border-l-4 border-purple-600 bg-white p-3 rounded-md shadow-sm",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:[e.jsx("p",{className:"text-xs font-semibold text-purple-600 uppercase",children:"Overview"}),e.jsx("div",{className:"mt-1 text-xs space-y-0.5",children:[{label:"Total MLA Fund",val:ne},{label:"Total MLC Fund",val:he},{label:"HADP",val:k}].map((E,R)=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:E.label}),e.jsxs("span",{children:["₹",y(E.val)]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("small",{className:"text-gray-500",children:o(E.val,ne+he+k)})})]},R))})]}),pe.map((E,R)=>e.jsxs(Ae.div,{className:`col-span-6 sm:col-span-3 lg:col-span-1 border-l-4 border-${E.color}-500 bg-${E.color}-50 p-2 rounded-md shadow-sm cursor-pointer`,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1*(R+1)},whileHover:{scale:1.02},onClick:()=>{String(E.title).toLowerCase().includes("pending")?F(z=>!z):F(!1)},children:[e.jsx("p",{className:`text-xs font-semibold text-${E.color}-700`,children:E.title}),e.jsx("p",{className:`mt-1 text-lg font-bold text-${E.color}-900`,children:String(E.title).toLowerCase().includes("pending")?E.value:`₹${y(E.value)}`}),E.sub?e.jsx("p",{className:`mt-0.5 text-[11px] text-${E.color}-700/80`,children:E.sub}):null,e.jsx("div",{className:"flex justify-end",children:e.jsx("small",{className:`text-${E.color}-700 opacity-80`,children:o(E.value,E.whole)})})]},R))]}),t==="ML-MLA"&&e.jsxs(O,{className:"rounded-md shadow-sm",children:[e.jsx(se,{children:e.jsxs(ee,{className:"text-sm",children:["MLA Details",e.jsxs("div",{className:"flex gap-2 text-right",children:[e.jsx("span",{className:"text-[10px] text-red-500",children:"*Balance = Budget Amount - Fund Distributed |"}),e.jsx("span",{className:"text-[10px] text-red-500",children:"*Amounts In Thousand"})]})]})}),e.jsx($,{className:"overflow-x-auto p-0",children:e.jsxs(Ke,{className:"min-w-full border border-gray-300",children:[e.jsx(Be,{children:e.jsxs(ue,{children:[e.jsx(U,{className:"border px-2 py-1",children:"S.No"}),e.jsx(U,{className:"border px-2 py-1",children:"MLA Name"}),e.jsx(U,{className:"border px-2 py-1",children:"Assembly Constituency"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Budgeted Amount"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Funds Disbursed"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Balance Funds"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Pending Demands"})]})}),e.jsx(We,{children:l.map((E,R)=>e.jsxs(ue,{children:[e.jsx(h,{className:"border px-2 py-1 text-xs",children:R+1}),e.jsx(h,{className:"border px-2 py-1 text-xs",children:E.name}),e.jsx(h,{className:"border px-2 py-1 text-xs",children:E.taluka}),e.jsx(h,{className:"border px-2 py-1 text-right",children:y(E.budget)}),e.jsx(h,{className:"border px-2 py-1 text-right",children:y(E.fundUtilized)}),e.jsx(h,{className:"border px-2 py-1 text-right",children:y(E.balance)}),e.jsx(h,{className:"border px-2 py-1 text-right",children:e.jsx(L,{variant:"link",className:"text-blue-600 underline p-0 h-auto",onClick:()=>handlePendingClick("ML-MLA",E),children:y(E.pendingDemands)})})]},`${E.name}|${R}`))}),e.jsx(js,{children:e.jsxs(ue,{children:[e.jsx(h,{colSpan:3,className:"border px-2 py-1 font-semibold",children:"Total"}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:c.budget.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:c.utilized.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:c.balance.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:c.pendingDemands.toLocaleString()})]})})]})})]}),t==="ML-MLC"&&e.jsxs(O,{className:"rounded-md shadow-sm",children:[e.jsx(se,{children:e.jsxs(ee,{className:"text-sm",children:["MLC Details",e.jsxs("div",{className:"flex gap-2 text-right",children:[e.jsx("span",{className:"text-[10px] text-red-500",children:"*Balance = Budget Amount - Fund Distributed |"}),e.jsx("span",{className:"text-[10px] text-red-500",children:"*Amounts In Thousand"})]})]})}),e.jsx($,{className:"overflow-x-auto p-0",children:e.jsxs(Ke,{className:"min-w-full border border-gray-300",children:[e.jsx(Be,{children:e.jsxs(ue,{children:[e.jsx(U,{className:"border px-2 py-1",children:"Sr No"}),e.jsx(U,{className:"border px-2 py-1",children:"MLC NAME"}),e.jsx(U,{className:"border px-2 py-1",children:"Nodal District"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Budget Amount"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Total funds disbursed"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Balance Funds"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Pending Demands"})]})}),e.jsx(We,{children:M.map((E,R)=>e.jsxs(ue,{children:[e.jsx(h,{className:"border px-2 py-1 text-xs",children:R+1}),e.jsx(h,{className:"border px-2 py-1 text-xs",children:E.name}),e.jsx(h,{className:"border px-2 py-1 text-xs",children:E.district}),e.jsx(h,{className:"border px-2 py-1 text-right",children:y(E.budget)}),e.jsx(h,{className:"border px-2 py-1 text-right",children:y(E.fundUtilized)}),e.jsx(h,{className:"border px-2 py-1 text-right",children:y(E.balance)}),e.jsx(h,{className:"border px-2 py-1 text-right",children:e.jsx(L,{variant:"link",className:"text-blue-600 underline p-0 h-auto",onClick:()=>handlePendingClick("ML-MLC",E),children:y(E.pendingDemands)})})]},`${E.name}|${R}`))}),e.jsx(js,{children:e.jsxs(ue,{children:[e.jsx(h,{colSpan:3,className:"border px-2 py-1 font-semibold",children:"Total"}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:D.budget.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:D.utilized.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:D.balance.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:D.pendingDemands.toLocaleString()})]})})]})})]}),t==="HADP"&&e.jsxs(O,{className:"rounded-md shadow-sm",children:[e.jsx(se,{children:e.jsxs(ee,{className:"text-sm",children:["HADP Summary ",e.jsx("span",{className:"text-xs text-red-300 italic",children:"*Amounts In Thousands"})]})}),e.jsx($,{className:"overflow-x-auto p-0",children:e.jsxs(Ke,{className:"min-w-full border border-gray-300",children:[e.jsx(Be,{children:e.jsxs(ue,{children:[e.jsx(U,{className:"border px-2 py-1",children:"S.No"}),e.jsx(U,{className:"border px-2 py-1",children:"Taluka / Demand Code"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Budget Amount"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Disbursed Amount"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Balance Amount"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Pending Demand Amount"})]})}),e.jsx(We,{children:m.map((E,R)=>e.jsxs(ue,{children:[e.jsx(h,{className:"border px-2 py-1 text-xs",children:R+1}),e.jsx(h,{className:"border px-2 py-1 text-xs",children:E.demandCode}),e.jsx(h,{className:"border px-2 py-1 text-right",children:y(E.budget)}),e.jsx(h,{className:"border px-2 py-1 text-right",children:y(E.utilized)}),e.jsx(h,{className:"border px-2 py-1 text-right",children:y(E.balance)}),e.jsx(h,{className:"border px-2 py-1 text-right",children:e.jsx(L,{variant:"link",className:"text-blue-600 underline p-0 h-auto",onClick:()=>handlePendingClick("HADP",E),children:y(E.pendingDemands)})})]},E.demandCode))}),e.jsx(js,{children:e.jsxs(ue,{children:[e.jsx(h,{colSpan:2,className:"border px-2 py-1 font-semibold",children:"Total"}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:de.budget.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:de.utilized.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:de.balance.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:de.pendingDemands.toLocaleString()})]})})]})})]})]})},vi="http://localhost:5002",Ai={hidden:{opacity:0,y:12},visible:s=>({opacity:1,y:0,transition:{delay:s*.05,duration:.25,ease:"easeOut"}})},sr=s=>s.financialYear||s.fy||s.fyear||"NA",Na=s=>`${s.schemeId??s.schemeID??s.scheme_id??""}`,wi=s=>s.schemeName||s.scheme||"NA",rt=s=>`${s.workId??s.workID??s.work_id??""}`,Bt=s=>s.workName||s.name||"NA",wt=s=>s.iaDistrict||s.districtName||s.district||"NA",nt=s=>s.talukaName||s.taluka||"",Wt=s=>`${s.iaId??s.implementingAgencyId??s.ia_id??""}`,Ci=s=>s.iaName||s.ia||"",lt=s=>s.mlaName||s.memberName||s.accountName||"",Ct=s=>s.mlcName||s.memberName||s.accountName||"",fa=s=>{const r=(s.workType||s.type||(s.isNodal?"NODAL":"NON-NODAL")||"").toString().toUpperCase();return r.includes("NODAL")?"NODAL":r.includes("NON")?"NON-NODAL":s.isNodal?"NODAL":"NON-NODAL"},It=s=>Number(s.demandAmount??s.requestedAmount??s.totalDemand??0)||0,aa=s=>Number(s.aaAmount??s.adminApprovedAmount??s.approvedAmount??0)||0,Sn=s=>Number(s.grossWorkOrderAmount??s.grossAmount??0)||0,tr=s=>Number(s.fundReceivedFromState??s.amountReceivedFromState??s.receivedAmount??s.disbursedToIA??0)||0,Si=s=>(s.aaStatus||s.approvalStatus||s.statusAA||s.status||"").toString().toLowerCase()==="approved"||s.aaApproved===!0,ki=s=>(s.status||s.demandStatus||"").toString().toLowerCase()==="rejected",Ft=s=>!!(s.vendorMapped===!0||s.vendorId||s.vendorID||s.vendor_id||Array.isArray(s.vendors)&&s.vendors.length>0),Li=s=>Ft(s)&&(aa(s)||Sn(s)||It(s))||0,Di=s=>Ft(s)?0:aa(s)||Sn(s)||It(s)||0;function Gs(s,r,t){const n=new Map;for(const i of s){const x=r(i);if(!x)continue;const g=t?t(i):x;n.has(x)||n.set(x,{id:x,name:g||x})}return Array.from(n.values())}const _s=s=>`₹${(s||0).toLocaleString()}`;function ar(s,r){const t=new Map;for(const i of s){const x=r(i);if(!x)continue;const g=t.get(x)||{val:x,c:0};g.c+=1,t.set(x,g)}let n=null;for(const i of t.values())(!n||i.c>n.c)&&(n=i);return(n==null?void 0:n.val)||""}const Ls=({i:s,title:r,subtitle:t,value:n,icon:i,shade:x,onView:g})=>e.jsx(Ae.div,{initial:"hidden",animate:"visible",variants:Ai,custom:s,className:`${x} rounded-xl shadow-sm border h-full`,children:e.jsxs("div",{className:"relative h-full p-3 flex flex-col",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"shrink-0",children:i}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[10px] uppercase tracking-wide text-gray-600",children:t}),e.jsx("div",{className:"text-[13px] font-semibold text-gray-800",children:r}),e.jsx("div",{className:"text-xl font-bold text-gray-900 mt-0.5 whitespace-nowrap overflow-hidden text-ellipsis",children:n})]})]}),g&&e.jsx("div",{className:"mt-auto",children:e.jsxs(L,{size:"sm",variant:"outline",className:"mt-2 h-7 px-2 text-[11px]",onClick:g,children:[e.jsx(Re,{className:"w-3.5 h-3.5 mr-1"})," View"]})})]})}),Yt=({title:s,subtitle:r,children:t})=>e.jsxs(O,{className:"p-3 md:p-4 border border-gray-200 rounded-2xl bg-white h-full",children:[e.jsx("div",{className:"flex items-baseline justify-between mb-2",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:s}),r?e.jsx("p",{className:"text-[12px] text-gray-500",children:r}):null]})}),e.jsx("div",{className:"grid gap-3 [grid-template-columns:repeat(auto-fit,minmax(200px,1fr))]",children:t})]});function Mi(){const{toast:s}=os(),r="2025-2026",t=["2024-2025","2025-2026"],[n,i]=a.useState([]),[x,g]=a.useState(!1),[p,d]=a.useState(r),[j,P]=a.useState("All"),[W,T]=a.useState(""),[J,X]=a.useState(""),[w,V]=a.useState("All"),[F,N]=a.useState("All"),[b,A]=a.useState("All"),[C,q]=a.useState([{id:"All",name:"All"}]),[Z,B]=a.useState([{id:"All",name:"All"}]),[te,Q]=a.useState([{id:"All",name:"All"}]),[G,l]=a.useState("All"),[M,m]=a.useState("All"),[y,o]=a.useState("All"),[ne,he]=a.useState([{id:"All",name:"All"}]),[k,c]=a.useState([{id:"All",name:"All"}]),[D,de]=a.useState("All"),[I,H]=a.useState("All"),[oe,pe]=a.useState([{id:"All",name:"All"}]),[E,R]=a.useState([{id:"All",name:"All"}]),[z,re]=a.useState(!1),[xe,Ee]=a.useState(""),[De,Fe]=a.useState([]);a.useEffect(()=>{ms()},[p,j]);const ms=async()=>{var v;g(!0);try{const le={};p!=="All"&&(le.financialYear=p),j!=="All"&&(le.planType=j);const ce=await me.get(`${vi}/api/ia-dashboard`,{params:le,headers:{Authorization:localStorage.getItem("token")||""}});let ve=[];Array.isArray(ce.data)?ve=ce.data:Array.isArray((v=ce.data)==null?void 0:v.data)&&(ve=ce.data.data);const ns=localStorage.getItem("iaId")||""||ar(ve,Wt),Se=ve.filter(st=>Wt(st)===ns),et=ar(Se.length?Se:ve,wt);T(ns),X(et),i(ve||[])}catch{i([]),s({title:"Error",description:"Failed to fetch IA Dashboard data.",variant:"destructive"})}finally{g(!1)}},Ye=a.useMemo(()=>(Array.isArray(n)?n:[]).filter(v=>p==="All"?!0:sr(v)===p),[n,p]);a.useEffect(()=>{if(j!=="MLA")return;const v=Ye.filter(Se=>J?wt(Se)===J:!0),le=[{id:"All",name:"All"},...Gs(v,lt,lt)];q(le),le.find(Se=>Se.id===w)||V("All");const ce=v.filter(Se=>w==="All"?!0:lt(Se)===w),ve=[{id:"All",name:"All"},...Gs(ce,Na,wi)];B(ve),ve.find(Se=>Se.id===F)||N("All");const Pe=ce.filter(Se=>F==="All"?!0:Na(Se)===F),ns=[{id:"All",name:"All"},...Gs(Pe,rt,Bt)];Q(ns),ns.find(Se=>Se.id===b)||A("All")},[j,Ye,J,w,F]),a.useEffect(()=>{if(j!=="MLC")return;const v=Ye,le=[{id:"All",name:"All"},...Gs(v,Ct,Ct)];he(le),le.find(Se=>Se.id===G)||l("All");const Pe=v.filter(Se=>G==="All"?!0:Ct(Se)===G).filter(Se=>M==="All"?!0:fa(Se)===M).filter(Se=>!W||Wt(Se)===W),ns=[{id:"All",name:"All"},...Gs(Pe,rt,Bt)];c(ns),ns.find(Se=>Se.id===y)||o("All")},[j,Ye,G,M,W]),a.useEffect(()=>{if(j!=="HADP")return;const v=Ye.filter(Pe=>J?wt(Pe)===J:!0),le=[{id:"All",name:"All"},...Gs(v,nt,nt)];pe(le),le.find(Pe=>Pe.id===D)||de("All");const ce=v.filter(Pe=>D==="All"?!0:nt(Pe)===D),ve=[{id:"All",name:"All"},...Gs(ce,rt,Bt)];R(ve),ve.find(Pe=>Pe.id===I)||H("All")},[j,Ye,J,D]);const Te=a.useMemo(()=>{let v=Ye;return j==="MLA"?(v=v.filter(le=>J?wt(le)===J:!0),v=v.filter(le=>w==="All"?!0:lt(le)===w),v=v.filter(le=>F==="All"?!0:Na(le)===F),v=v.filter(le=>b==="All"?!0:rt(le)===b)):j==="MLC"?(v=v.filter(le=>G==="All"?!0:Ct(le)===G),v=v.filter(le=>M==="All"?!0:fa(le)===M),v=v.filter(le=>W?Wt(le)===W:!0),v=v.filter(le=>y==="All"?!0:rt(le)===y)):j==="HADP"&&(v=v.filter(le=>J?wt(le)===J:!0),v=v.filter(le=>D==="All"?!0:nt(le)===D),v=v.filter(le=>I==="All"?!0:rt(le)===I)),v},[Ye,j,J,W,w,F,b,G,M,y,D,I]),xs=a.useMemo(()=>Te.filter(Si),[Te]),He=a.useMemo(()=>Te.filter(Ft),[Te]),Ue=a.useMemo(()=>Te.filter(v=>!Ft(v)),[Te]),Je=a.useMemo(()=>Te.filter(ki),[Te]),$e=a.useMemo(()=>{const v=xs.length,le=xs.reduce((u,Y)=>u+aa(Y),0),ce=He.length,ve=He.reduce((u,Y)=>u+Li(Y),0),Pe=Ue.length,ns=Ue.reduce((u,Y)=>u+Di(Y),0),Se=Je.length,et=Te.reduce((u,Y)=>u+It(Y),0),st=Te.reduce((u,Y)=>u+tr(Y),0);return{aaApprovedCount:v,aaApprovedAmount:le,vendorDoneCount:ce,vendorDoneAmount:ve,vendorPendingCount:Pe,vendorPendingAmount:ns,rejectedCount:Se,totalDemandedToState:et,totalReceivedFromState:st}},[Te,xs,He,Ue,Je]),Ss=a.useMemo(()=>{const v=new Map;for(const le of Te){const ce=sr(le);v.has(ce)||v.set(ce,{fy:ce,demanded:0,received:0});const ve=v.get(ce);ve.demanded+=It(le),ve.received+=tr(le)}return Array.from(v.values()).sort((le,ce)=>le.fy>ce.fy?1:-1)},[Te]),Bs=a.useMemo(()=>[{name:"Mapping Done",value:He.length},{name:"Mapping Pending",value:Ue.length}],[He.length,Ue.length]),Ws="bg-purple-50 border-purple-200",ks="bg-emerald-50 border-emerald-200",Is="bg-rose-50 border-rose-200",Ys="bg-sky-50 border-sky-200",f="bg-amber-50 border-amber-200",K=(v,le)=>{Ee(v),Fe(le),re(!0)};return e.jsxs("div",{className:"p-5 space-y-5 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"IA Dashboard"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Filters default to the current Financial Year (",r,")."]})]}),e.jsx(O,{className:"p-3 md:p-4 border border-gray-200 rounded-2xl bg-white",children:e.jsxs("div",{className:"grid gap-3 [grid-template-columns:repeat(auto-fit,minmax(220px,1fr))]",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1",children:"Financial Year"}),e.jsx("select",{className:"border border-gray-300 rounded px-3 py-2 text-sm",value:p,onChange:v=>d(v.target.value),children:["All",...t].map(v=>e.jsx("option",{value:v,children:v},v))})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1",children:"Plan Type"}),e.jsx("select",{className:"border border-gray-300 rounded px-3 py-2 text-sm",value:j,onChange:v=>{P(v.target.value),V("All"),N("All"),A("All"),l("All"),m("All"),o("All"),de("All"),H("All")},children:["All","MLA","MLC","HADP"].map(v=>e.jsx("option",{value:v,children:v},v))})]}),j==="MLA"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"IA District"}),e.jsx("input",{className:"border border-gray-200 rounded px-3 py-2 text-sm bg-gray-50",value:J||"-",readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1",children:"MLA"}),e.jsx("select",{className:"border border-gray-300 rounded px-3 py-2 text-sm",value:w,onChange:v=>V(v.target.value),children:C.map(v=>e.jsx("option",{value:v.id,children:v.name},v.id))})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1",children:"Scheme (for MLA)"}),e.jsx("select",{className:"border border-gray-300 rounded px-3 py-2 text-sm",value:F,onChange:v=>N(v.target.value),children:Z.map(v=>e.jsx("option",{value:v.id,children:v.name},v.id))})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1",children:"Work (under Scheme & MLA)"}),e.jsx("select",{className:"border border-gray-300 rounded px-3 py-2 text-sm",value:b,onChange:v=>A(v.target.value),children:te.map(v=>e.jsx("option",{value:v.id,children:v.name},v.id))})]})]}),j==="MLC"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1",children:"MLC"}),e.jsx("select",{className:"border border-gray-300 rounded px-3 py-2 text-sm",value:G,onChange:v=>l(v.target.value),children:ne.map(v=>e.jsx("option",{value:v.id,children:v.name},v.id))})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1",children:"Work Type"}),e.jsx("select",{className:"border border-gray-300 rounded px-3 py-2 text-sm",value:M,onChange:v=>m(v.target.value),children:["All","NODAL","NON-NODAL"].map(v=>e.jsx("option",{value:v,children:v},v))})]}),e.jsxs("div",{className:"flex flex-col md:col-span-2",children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1",children:"Work (assigned to this IA)"}),e.jsx("select",{className:"border border-gray-300 rounded px-3 py-2 text-sm",value:y,onChange:v=>o(v.target.value),children:k.map(v=>e.jsx("option",{value:v.id,children:v.name},v.id))})]})]}),j==="HADP"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"IA District"}),e.jsx("input",{className:"border border-gray-200 rounded px-3 py-2 text-sm bg-gray-50",value:J||"-",readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1",children:"Taluka"}),e.jsx("select",{className:"border border-gray-300 rounded px-3 py-2 text-sm",value:D,onChange:v=>de(v.target.value),children:oe.map(v=>e.jsx("option",{value:v.id,children:v.name},v.id))})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1",children:"Work (in Taluka)"}),e.jsx("select",{className:"border border-gray-300 rounded px-3 py-2 text-sm",value:I,onChange:v=>H(v.target.value),children:E.map(v=>e.jsx("option",{value:v.id,children:v.name},v.id))})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4",children:[e.jsx("div",{className:"md:col-span-6",children:e.jsxs(Yt,{title:"State",subtitle:"Totals to and from State (₹)",children:[e.jsx(Ls,{i:0,title:"Demanded to State",subtitle:"Total Amount",value:_s($e.totalDemandedToState),icon:e.jsx(La,{className:"w-5 h-5 text-purple-600"}),shade:Ws}),e.jsx(Ls,{i:1,title:"Received from State",subtitle:"Total Amount",value:_s($e.totalReceivedFromState),icon:e.jsx(La,{className:"w-5 h-5 text-green-600"}),shade:Ws})]})}),e.jsx("div",{className:"md:col-span-6",children:e.jsxs(Yt,{title:"AA (District Approved)",subtitle:"Sanctioned works & amounts",children:[e.jsx(Ls,{i:0,title:"AA Approved Works",subtitle:"Count",value:$e.aaApprovedCount,icon:e.jsx(ra,{className:"w-5 h-5 text-emerald-600"}),shade:ks,onView:()=>K("AA Approved Works",xs)}),e.jsx(Ls,{i:1,title:"AA Approved Amount",subtitle:"Total",value:_s($e.aaApprovedAmount),icon:e.jsx(Rs,{className:"w-5 h-5 text-emerald-600"}),shade:ks})]})}),e.jsx("div",{className:"md:col-span-4",children:e.jsx(Yt,{title:"Demands",subtitle:"Exceptions & rejections",children:e.jsx(Ls,{i:0,title:"Rejected Demands",subtitle:"Count",value:Je.length,icon:e.jsx(Ts,{className:"w-5 h-5 text-rose-600"}),shade:Is,onView:()=>K("Rejected Demands",Je)})})}),e.jsx("div",{className:"md:col-span-8",children:e.jsxs(Yt,{title:"Vendor Mapping",subtitle:"Progress on mapping",children:[e.jsx(Ls,{i:0,title:"Mapping Done",subtitle:"Count",value:He.length,icon:e.jsx(Ya,{className:"w-5 h-5 text-sky-700"}),shade:Ys,onView:()=>K("Vendor Mapping - Done",He)}),e.jsx(Ls,{i:1,title:"Done Amount",subtitle:"Total",value:_s($e.vendorDoneAmount),icon:e.jsx(Rs,{className:"w-5 h-5 text-sky-700"}),shade:Ys}),e.jsx(Ls,{i:2,title:"Mapping Pending",subtitle:"Count",value:Ue.length,icon:e.jsx(Ya,{className:"w-5 h-5 text-amber-700"}),shade:f,onView:()=>K("Vendor Mapping - Pending",Ue)}),e.jsx(Ls,{i:3,title:"Pending Amount",subtitle:"Total",value:_s($e.vendorPendingAmount),icon:e.jsx(Rs,{className:"w-5 h-5 text-amber-700"}),shade:f})]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-12",children:[e.jsxs(O,{className:"md:col-span-8 p-4 border border-gray-200 rounded-2xl bg-white",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Fund Demanded vs Received (by Financial Year)"}),e.jsx("div",{className:"w-full h-72",children:e.jsx(Ma,{width:"100%",height:"100%",children:e.jsxs($a,{data:Ss,children:[e.jsx(ht,{dataKey:"fy"}),e.jsx(ut,{tickFormatter:v=>`₹${(v/1e5).toFixed(0)}L`}),e.jsx(Pa,{formatter:v=>`₹${v.toLocaleString()}`}),e.jsx(qa,{}),e.jsx(qs,{dataKey:"demanded",name:"Demanded to State"}),e.jsx(qs,{dataKey:"received",name:"Received from State"})]})})})]}),e.jsxs(O,{className:"md:col-span-4 p-4 border border-gray-200 rounded-2xl bg-white",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Vendor Mapping Status (Count)"}),e.jsx("div",{className:"w-full h-72",children:e.jsx(Ma,{width:"100%",height:"100%",children:e.jsxs(za,{children:[e.jsx(Ua,{data:Bs,dataKey:"value",nameKey:"name",outerRadius:90,label:v=>`${v.name}: ${v.value}`,children:Bs.map((v,le)=>e.jsx(Ba,{fill:["#10b981","#f59e0b"][le%2]},`cell-${le}`))}),e.jsx(Pa,{}),e.jsx(qa,{})]})})})]})]}),e.jsx(ts,{open:z,onOpenChange:re,children:e.jsxs(Ze,{className:"max-w-5xl",children:[e.jsx(as,{children:e.jsx(rs,{children:xe})}),e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"min-w-full table-auto",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:["Sr No","Work Title","IA Name","Plan Entity","Demand Amount","AA Amount","Status","Vendor Mapped"].map(v=>e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold border-b",children:v},v))})}),e.jsx("tbody",{children:De.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"text-center text-sm text-gray-500 py-6",children:"No records."})}):De.map((v,le)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 text-sm border-b",children:le+1}),e.jsx("td",{className:"px-3 py-2 text-sm border-b",children:Bt(v)}),e.jsx("td",{className:"px-3 py-2 text-sm border-b",children:Ci(v)||"-"}),e.jsx("td",{className:"px-3 py-2 text-sm border-b",children:j==="MLA"?lt(v)||"-":j==="MLC"?`${Ct(v)} • ${fa(v)}`:j==="HADP"?nt(v)||"-":lt(v)||nt(v)||"-"}),e.jsx("td",{className:"px-3 py-2 text-sm border-b",children:_s(It(v))}),e.jsx("td",{className:"px-3 py-2 text-sm border-b",children:_s(aa(v))}),e.jsx("td",{className:"px-3 py-2 text-sm border-b",children:v.status||v.demandStatus||"-"}),e.jsx("td",{className:"px-3 py-2 text-sm border-b",children:Ft(v)?"Yes":"No"})]},v.id??le))})]})})]})})]})}const _=a.forwardRef(({className:s,type:r,...t},n)=>e.jsx("input",{type:r,className:ie("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:n,...t}));_.displayName="Input";const Mt="http://13.202.62.178:9090/backend-dfds";function Pi(s){return e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-semibold
      ${s==="Completed"?"bg-green-100 text-green-700":s==="Pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:s})}const Ei=({open:s,onClose:r,work:t,onAssign:n,vendors:i,taxes:x})=>{var B;const{toast:g}=os(),[p,d]=a.useState(""),[j,P]=a.useState([]),[W,T]=a.useState((t==null?void 0:t.workPortionAmount)??0),[J,X]=a.useState(!1),[w,V]=a.useState(null);if(a.useEffect(()=>{t&&(T(t.workPortionAmount??0),d(""),P([]),V(null))},[t,s]),!s||!t)return null;const F=x.filter(te=>j.includes(te.taxName)),N=F.reduce((te,Q)=>te+W*Q.taxPercentage/100,0),b=W+N,A=i.find(te=>te.id===Number(p)),C=A&&W>0&&b<=(t.workLimit??t.adminApprovedAmount),q=te=>{var Q;(Q=te.target.files)!=null&&Q.length&&V(te.target.files[0])},Z=async()=>{var te,Q;if(!C){g({title:"Validation Error",description:"Please fill all required fields correctly",variant:"destructive"});return}X(!0);try{await me.post(`${Mt}/api/work-vendor-mapping/assign-vendor`,{workId:t.id,vendorId:Number(p),workPortionAmount:W,taxes:F.map(G=>({taxName:G.taxName,taxPercentage:G.taxPercentage,taxAmount:W*G.taxPercentage/100}))},{headers:{Authorization:localStorage.getItem("token")||""}}),n({assignedVendor:A,assignedTax:F,workPortionAmount:W,grossTotal:b,status:"Completed",workOrderFile:w}),g({title:"Success",description:"Vendor assigned successfully",variant:"default"}),X(!1),r()}catch(G){console.error("Error assigning vendor:",G);const l=((Q=(te=G.response)==null?void 0:te.data)==null?void 0:Q.message)||"Failed to assign vendor. Please try again.";g({title:"Error",description:l,variant:"destructive"}),X(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-[70vw] max-w-4xl p-8 relative",children:[e.jsx("button",{className:"absolute top-4 right-4",onClick:r,children:e.jsx(fs,{className:"w-5 h-5 text-gray-400 hover:text-red-500"})}),e.jsx("h2",{className:"text-2xl font-bold mb-4 text-primary",children:"Assign Vendor to Work"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 bg-blue-50 p-5 rounded-lg mb-5",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Work Title"}),e.jsx("div",{children:t.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Financial Year"}),e.jsx("div",{children:t.financialYear})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Admin Approved Limit"}),e.jsxs("div",{children:["₹",(t.adminApprovedAmount??0).toLocaleString()]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"font-semibold text-gray-700 block mb-1",children:["Select Vendor ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{className:"w-full border rounded px-3 py-2",value:p,onChange:te=>d(te.target.value),children:[e.jsx("option",{value:"",children:"-- Select Vendor --"}),i.map(te=>{var Q;return e.jsxs("option",{value:te.id,children:[te.name," (**** **** ",((Q=te.aadhaarNumber)==null?void 0:Q.slice(-4))||"----",")"]},te.id)})]}),A&&e.jsxs("div",{className:"mt-3 border rounded-lg bg-gray-50 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-x-6 gap-y-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Account:"}),e.jsx("span",{className:"font-mono text-gray-800",children:A.bankAccountNumber??"-"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"IFSC:"}),e.jsx("span",{className:"font-mono text-gray-800",children:A.bankIfsc??"-"})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[e.jsx(qe,{className:"inline w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-green-700 font-medium",children:"Verified"})]})]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"GST:"})," ",A.gstNumber]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Aadhaar:"})," ","**** **** ",((B=A.aadhaarNumber)==null?void 0:B.slice(-4))||"----"]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"font-semibold text-gray-700 block mb-1",children:["Work Portion Amount (Work Order Amount) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(_,{type:"number",value:W,min:1,max:t.adminApprovedAmount,onChange:te=>T(Number(te.target.value))}),W>t.adminApprovedAmount&&e.jsxs("div",{className:"text-red-500 text-xs mt-1 flex items-center gap-1",children:[e.jsx(us,{className:"w-3 h-3"}),"Portion amount cannot exceed Admin Approved Amount."]}),e.jsx("label",{className:"font-semibold text-gray-700 block mb-1 mt-4",children:"Tax/Deductions (select one or more)"}),e.jsx("select",{className:"w-full border rounded px-3 py-2",multiple:!0,value:j,onChange:te=>P(Array.from(te.target.selectedOptions,Q=>Q.value)),size:Math.min(4,x.length),children:x.map(te=>e.jsxs("option",{value:te.taxName,children:[te.taxName," (",te.taxPercentage,"%)"]},te.taxName))}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-semibold text-gray-700 block mb-1",children:"Work Order Letter (PDF, Image)"}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(Ur,{className:"w-5 h-5 text-blue-600"}),e.jsx("input",{type:"file",accept:"application/pdf,image/*",className:"hidden",onChange:q}),e.jsx("span",{className:"text-sm",children:w?w.name:"Select file"})]}),w&&e.jsx("div",{className:"mt-2 text-xs text-green-700",children:"File attached (Not uploaded to backend)"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 my-4 bg-gray-50 p-3 rounded-xl text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"Deducted Amount:"}),e.jsxs("div",{children:["₹",N.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"Gross Total:"}),e.jsxs("div",{children:["₹",b.toLocaleString()]})]})]}),b>(t.adminApprovedAmount??0)&&e.jsxs("div",{className:"text-red-500 text-xs mb-2 flex items-center gap-1",children:[e.jsx(us,{className:"w-3 h-3"}),"Gross amount cannot exceed Admin Approved Amount!"]}),e.jsxs(L,{className:"w-full mt-2",disabled:!C||J,onClick:Z,children:[J?e.jsx(zr,{className:"animate-spin h-4 w-4 mr-2"}):e.jsx(qe,{className:"h-4 w-4 mr-2"}),"Assign Vendor"]})]})})},Ti=()=>{const{toast:s}=os(),[r,t]=a.useState([]),[n,i]=a.useState([]),[x,g]=a.useState([]),[p,d]=a.useState({}),[j,P]=a.useState({open:!1,work:null}),[W,T]=a.useState(!0),[J,X]=a.useState(null),[w,V]=a.useState(""),[F,N]=a.useState(""),[b,A]=a.useState(""),[C,q]=a.useState("");a.useEffect(()=>{(async()=>{var M,m;T(!0),X(null);try{const[y,o,ne,he]=await Promise.all([me.get(`${Mt}/api/work-vendor-mapping/works`,{headers:{Authorization:localStorage.getItem("token")||""}}),me.get(`${Mt}/api/work-vendor-mapping/vendors`,{headers:{Authorization:localStorage.getItem("token")||""}}),me.get(`${Mt}/api/tax-master`,{headers:{Authorization:localStorage.getItem("token")||""}}),me.get(`${Mt}/api/work-vendor-mapping/counts`,{headers:{Authorization:localStorage.getItem("token")||""}})]);t(y.data||[]),i(o.data||[]),g(ne.data||[]),d(he.data||{})}catch(y){console.error("Error fetching data:",y);const o=((m=(M=y.response)==null?void 0:M.data)==null?void 0:m.message)||"Failed to fetch data";X(o),s({title:"Error",description:o,variant:"destructive"})}finally{T(!1)}})()},[s]);const Z=a.useMemo(()=>{let l=r;return w&&(l=l.filter(M=>M.financialYear===w)),F&&(l=l.filter(M=>String(M.schemeId)===F)),b&&(l=l.filter(M=>M.name===b)),C&&(l=l.filter(M=>C==="Completed"?M.status==="Completed"&&M.assignedVendor:M.status==="Pending"&&!M.assignedVendor)),l},[r,w,F,b,C]),B=(l,M)=>{t(m=>m.map(y=>y.id===l?{...y,assignedVendor:M.assignedVendor,assignedTax:M.assignedTax,workPortionAmount:M.workPortionAmount,grossTotal:M.grossTotal,status:M.status,workOrderFile:M.workOrderFile}:y))},te=a.useMemo(()=>[...new Set(r.map(l=>l.financialYear))],[r]),Q=a.useMemo(()=>{const l=new Set;return r.forEach(M=>l.add(String(M.schemeId||""))),Array.from(l)},[r]),G=a.useMemo(()=>[...new Set(r.map(l=>l.name))],[r]);return W?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(zr,{className:"w-6 h-6 animate-spin text-blue-600"}),e.jsx("span",{className:"text-lg font-medium text-gray-600",children:"Loading work vendor data..."})]})}):J?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx(us,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading Data"}),e.jsx("p",{className:"text-gray-600 mb-4",children:J}),e.jsx(L,{onClick:()=>window.location.reload(),children:"Retry"})]})}):e.jsxs("div",{className:"space-y-8 p-6 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[e.jsxs(O,{children:[e.jsx(se,{className:"pb-2",children:e.jsx(ee,{className:"text-sm font-medium",children:"Total Schemes"})}),e.jsxs($,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.totalSchemes??0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Schemes managed"})]})]}),e.jsxs(O,{children:[e.jsx(se,{className:"pb-2",children:e.jsx(ee,{className:"text-sm font-medium",children:"Total Works Assigned"})}),e.jsxs($,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.totalWorks??0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Works under schemes"})]})]}),e.jsxs(O,{children:[e.jsx(se,{className:"pb-2",children:e.jsx(ee,{className:"text-sm font-medium",children:"Total Vendor Registered"})}),e.jsxs($,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.totalVendors??0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Vendors registered to schemes"})]})]}),e.jsxs(O,{children:[e.jsx(se,{className:"pb-2",children:e.jsx(ee,{className:"text-sm font-medium",children:"Pending Work Vendor Registration"})}),e.jsxs($,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.pendingVendorReg??0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Works pending vendor assignment"})]})]})]}),e.jsxs("div",{className:"flex items-end gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{className:"block font-medium mb-1 text-gray-700",children:"Financial Year"}),e.jsxs("select",{className:"w-full border rounded px-3 py-2",value:w,onChange:l=>V(l.target.value),children:[e.jsx("option",{value:"",children:"All"}),te.map(l=>e.jsx("option",{value:l,children:l},l))]})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{className:"block font-medium mb-1 text-gray-700",children:"Scheme"}),e.jsxs("select",{className:"w-full border rounded px-3 py-2",value:F,onChange:l=>N(l.target.value),children:[e.jsx("option",{value:"",children:"All"}),Q.map(l=>e.jsx("option",{value:l,children:l},l))]})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{className:"block font-medium mb-1 text-gray-700",children:"Work"}),e.jsxs("select",{className:"w-full border rounded px-3 py-2",value:b,onChange:l=>A(l.target.value),children:[e.jsx("option",{value:"",children:"All"}),G.map(l=>e.jsx("option",{value:l,children:l},l))]})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{className:"block font-medium mb-1 text-gray-700",children:"Status"}),e.jsxs("select",{className:"w-full border rounded px-3 py-2",value:C,onChange:l=>q(l.target.value),children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Pending",children:"Pending Vendor Registration"}),e.jsx("option",{value:"Completed",children:"Completed Vendor Registration"})]})]})]}),e.jsx("div",{className:"overflow-x-auto rounded-2xl shadow border border-gray-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700",children:"Actions (Assign Vendor)"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Scheme ID"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Work Name"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Fin. Year"}),e.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700",children:"AA Amount"}),e.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Gross Total"}),e.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700",children:"Status"})]})}),e.jsxs("tbody",{children:[Z.map((l,M)=>e.jsxs("tr",{className:`${M%2===0?"bg-white":"bg-gray-50"} hover:bg-primary/5 transition border-b last:border-0`,children:[e.jsxs("td",{className:"px-4 py-2 text-center",children:[e.jsxs(L,{size:"sm",variant:"outline",onClick:()=>P({open:!0,work:l}),disabled:!!l.assignedVendor,children:[e.jsx(Es,{className:"w-4 h-4 mr-1"}),l.assignedVendor?"Assigned":"Assign Vendor"]}),l.assignedVendor&&e.jsxs("span",{className:"block mt-1 text-xs text-green-700 font-semibold",children:["Assigned: ",l.assignedVendor.name]}),l.workOrderFile&&e.jsxs("div",{className:"mt-1 text-xs text-blue-500",children:["📄 ",l.workOrderFile.name]})]}),e.jsx("td",{className:"px-4 py-2",children:l.schemeId??"-"}),e.jsx("td",{className:"px-4 py-2",children:l.name}),e.jsx("td",{className:"px-4 py-2",children:l.financialYear}),e.jsxs("td",{className:"px-4 py-2 text-right",children:["₹",(l.adminApprovedAmount??0).toLocaleString()]}),e.jsxs("td",{className:"px-4 py-2 text-right",children:["₹",(l.grossTotal??0).toLocaleString()]}),e.jsx("td",{className:"px-4 py-2 text-center",children:Pi(l.status)})]},l.id)),Z.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center text-gray-400 py-6",children:"No works found for selected filter"})})]})]})}),e.jsx(Ei,{open:j.open,onClose:()=>P({open:!1,work:null}),work:j.work,onAssign:l=>{var M;return B(((M=j.work)==null?void 0:M.id)||0,l)},vendors:n,taxes:x})]})},Ne=hl,fe=ul,je=a.forwardRef(({className:s,children:r,...t},n)=>e.jsxs(Br,{ref:n,className:ie("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...t,children:[r,e.jsx(il,{asChild:!0,children:e.jsx(na,{className:"h-4 w-4 opacity-50"})})]}));je.displayName=Br.displayName;const kn=a.forwardRef(({className:s,...r},t)=>e.jsx(Wr,{ref:t,className:ie("flex cursor-default items-center justify-center py-1",s),...r,children:e.jsx(dl,{className:"h-4 w-4"})}));kn.displayName=Wr.displayName;const Ln=a.forwardRef(({className:s,...r},t)=>e.jsx(Yr,{ref:t,className:ie("flex cursor-default items-center justify-center py-1",s),...r,children:e.jsx(na,{className:"h-4 w-4"})}));Ln.displayName=Yr.displayName;const ge=a.forwardRef(({className:s,children:r,position:t="popper",...n},i)=>e.jsx(cl,{children:e.jsxs(Hr,{ref:i,className:ie("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:t,...n,children:[e.jsx(kn,{}),e.jsx(ol,{className:ie("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),e.jsx(Ln,{})]})}));ge.displayName=Hr.displayName;const Ii=a.forwardRef(({className:s,...r},t)=>e.jsx(Gr,{ref:t,className:ie("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r}));Ii.displayName=Gr.displayName;const ae=a.forwardRef(({className:s,children:r,...t},n)=>e.jsxs(_r,{ref:n,className:ie("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ml,{children:e.jsx(ws,{className:"h-4 w-4"})})}),e.jsx(xl,{children:r})]}));ae.displayName=_r.displayName;const Fi=a.forwardRef(({className:s,...r},t)=>e.jsx(qr,{ref:t,className:ie("-mx-1 my-1 h-px bg-muted",s),...r}));Fi.displayName=qr.displayName;const St=[{id:467,planType:"MLA",workCode:"ML/2425/2572",name:"Baramati - State Level Kabaddi Tournament Support",district:"Pune",constituency:"Baramati",mlaName:"Ajit Anantrao Pawar",financialYear:"2024-25",adminApprovedAmount:2999,workPortionAmount:2800,taxDeductionAmount:100,vendor:{id:"1189",name:"Shree Ganesh Constructions Pvt. Ltd.",aadhar:"123412341234"}},{id:469,planType:"MLA",workCode:"ML/2425/2569",name:"Baramati - State Level Kabaddi Tournament Support (Phase 2)",district:"Pune",constituency:"Baramati",mlaName:"Ajit Anantrao Pawar",financialYear:"2024-25",adminApprovedAmount:1990,workPortionAmount:1800,taxDeductionAmount:100,vendor:{id:"1189",name:"Sadguru Infrastructure Ltd.",aadhar:"456789123456"}},{id:477,planType:"MLA",workCode:"ML/2425/2561",name:"Baramati - Kabaddi Tournament Grant",district:"Pune",constituency:"Baramati",mlaName:"Ajit Anantrao Pawar",financialYear:"2024-25",adminApprovedAmount:1e3,workPortionAmount:1e3,taxDeductionAmount:0,vendor:{id:"1189",name:"Sahyadri Construction Co.",aadhar:"147852369258"}},{id:468,planType:"MLA",workCode:"ML/2425/2151",name:"Shirur - Road to Kalamjai Mandir",district:"Pune",constituency:"Shirur",mlaName:"Dnyaneshwar Katke",financialYear:"2024-25",adminApprovedAmount:1400,workPortionAmount:1200,taxDeductionAmount:110,vendor:{id:"1189",name:"Maratha Nirman & Co.",aadhar:"987654321098"}},{id:470,planType:"MLA",workCode:"ML/2425/0325",name:"Maval - Sabha Mandap Construction",district:"Pune",constituency:"Maval",mlaName:"Sunil Shankarrao Shelke",financialYear:"2024-25",adminApprovedAmount:1600,workPortionAmount:1400,taxDeductionAmount:100,vendor:{id:"1189",name:"Maharashtra Builders & Developers",aadhar:"321098765432"}},{id:9001,planType:"MLC",workCode:"MLC/2425/0001",name:"Pune Division – Library Renovation Grant",district:"Pune",constituency:"Pune Division",mlaName:"Yogesh Tilekar",financialYear:"2024-25",adminApprovedAmount:1200,workPortionAmount:1150,taxDeductionAmount:50,vendor:{id:"V-9001",name:"Sahyog Infra",aadhar:"111122223333"}}],Ri=[{id:"MLD-467-1",workId:467,amount:500,date:"2025-02-01",status:"Approved",remarks:"First Installment"},{id:"MLD-469-1",workId:469,amount:500,date:"2025-02-03",status:"Approved",remarks:"First Installment"},{id:"MLD-477-1",workId:477,amount:500,date:"2025-02-09",status:"Approved",remarks:"First Installment"},{id:"MLD-477-2",workId:477,amount:500,date:"2025-03-09",status:"Approved",remarks:"Second Installment"},{id:"MLD-468-1",workId:468,amount:500,date:"2025-02-02",status:"Approved",remarks:"First Installment"},{id:"MLD-470-1",workId:470,amount:500,date:"2025-02-04",status:"Approved",remarks:"First Installment"},{id:"MLC-9001-1",workId:9001,amount:400,date:"2025-02-10",status:"Approved",remarks:"First Installment"}],vs=s=>"₹"+Number(s||0).toLocaleString("en-IN"),rr=s=>s?s.replace(/^(\d{8})(\d{4})$/,"********$2"):"********0000",Oi={"Ajit Anantrao Pawar":18e3,"Dnyaneshwar Katke":18e3,"Sunil Shankarrao Shelke":18e3,"Yogesh Tilekar":18e3};function Vi(){const[s,r]=a.useState(""),[t,n]=a.useState(""),[i,x]=a.useState(""),[g,p]=a.useState(""),[d,j]=a.useState({fy:"",planType:"",district:"",member:""}),P=a.useMemo(()=>Array.from(new Set(St.map(o=>o.financialYear))),[]),W=a.useMemo(()=>Array.from(new Set(St.map(o=>o.planType))),[]),T=a.useMemo(()=>Array.from(new Set(St.map(o=>o.district))),[]),J=a.useMemo(()=>Array.from(new Set(St.map(o=>o.mlaName))).sort(),[]),X=()=>j({fy:s,planType:t,district:i,member:g}),w=()=>{r(""),n(""),x(""),p(""),j({fy:"",planType:"",district:"",member:""})},V=a.useMemo(()=>St.filter(o=>(!d.fy||o.financialYear===d.fy)&&(!d.planType||o.planType===d.planType)&&(!d.district||o.district===d.district)&&(!d.member||o.mlaName===d.member)),[d]),F=a.useMemo(()=>new Set(V.map(o=>o.id)),[V]),N=a.useMemo(()=>Ri.filter(o=>F.has(o.workId)),[F]),b=a.useMemo(()=>{const o=new Map;for(const ne of V){const he=o.get(ne.mlaName)||[];he.push(ne),o.set(ne.mlaName,he)}return o},[V]),A=a.useMemo(()=>Array.from(b.entries()).map(([o,ne])=>({name:o,works:ne,noOfWorks:ne.length,totalWorkAmount:ne.reduce((he,k)=>he+(k.adminApprovedAmount||0),0)})).sort((o,ne)=>o.name.localeCompare(ne.name,"en",{sensitivity:"base"})),[b]),[C,q]=a.useState({}),Z=o=>q(ne=>({...ne,[o]:!ne[o]})),[B,te]=a.useState(null),[Q,G]=a.useState(null),l=a.useRef(null),M=o=>{const ne=b.get(o)||[],he=["Member Name","Plan Type","Work Code","Work Name","District","Constituency","FY","Total Work Amount"],k=ne.map(H=>[o,H.planType,H.workCode,H.name,H.district,H.constituency,H.financialYear,H.adminApprovedAmount]),c=[he,...k].map(H=>H.map(oe=>`"${String(oe).replace(/"/g,'""')}"`).join(",")).join(`
`),D=new Blob([c],{type:"text/csv;charset=utf-8;"}),de=URL.createObjectURL(D),I=document.createElement("a");I.href=de,I.download=`${o.replace(/\s+/g,"_")}_works.csv`,I.click(),URL.revokeObjectURL(de)},m=o=>{const ne=N.filter(H=>H.workId===o.id),he=["Demand ID","Amount","Date","Status","Remarks","Work Code","Work Name","Member","Plan Type"],k=ne.map(H=>[H.id,H.amount,H.date,H.status,H.remarks,o.workCode,o.name,o.mlaName,o.planType]),c=[he,...k].map(H=>H.map(oe=>`"${String(oe).replace(/"/g,'""')}"`).join(",")).join(`
`),D=new Blob([c],{type:"text/csv;charset=utf-8;"}),de=URL.createObjectURL(D),I=document.createElement("a");I.href=de,I.download=`${o.workCode}_vouchers.csv`,I.click(),URL.revokeObjectURL(de)},y=async()=>{if(!l.current||!Q)return;const o=await Hl(l.current,{scale:2}),ne=o.toDataURL("image/png"),he=new Gl({unit:"pt",format:"a4"}),k=20,c=he.internal.pageSize.getWidth()-k*2,D=o.height*c/o.width;he.addImage(ne,"PNG",k,k,c,D),he.save(`${Q.demand.id}.pdf`)};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs(O,{className:"border rounded shadow-sm",children:[e.jsx(se,{className:"pb-0",children:e.jsx(ee,{className:"text-lg",children:"Filters"})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-12 gap-3 items-end",children:[e.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[e.jsx("label",{className:"text-xs font-medium mb-1 block",children:"Financial Year"}),e.jsxs(Ne,{value:s,onValueChange:r,children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"All FYs"})}),e.jsx(ge,{children:P.map(o=>e.jsx(ae,{value:o,children:o},o))})]})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[e.jsx("label",{className:"text-xs font-medium mb-1 block",children:"Plan Type"}),e.jsxs(Ne,{value:t,onValueChange:o=>n(o),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"All Types"})}),e.jsx(ge,{children:W.map(o=>e.jsx(ae,{value:o,children:o},o))})]})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[e.jsx("label",{className:"text-xs font-medium mb-1 block",children:"District"}),e.jsxs(Ne,{value:i,onValueChange:x,children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"All Districts"})}),e.jsx(ge,{children:T.map(o=>e.jsx(ae,{value:o,children:o},o))})]})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[e.jsx("label",{className:"text-xs font-medium mb-1 block",children:"MLA/MLC"}),e.jsxs(Ne,{value:g,onValueChange:p,children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"All Members"})}),e.jsx(ge,{children:J.map(o=>e.jsx(ae,{value:o,children:o},o))})]})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-6 flex gap-2",children:[e.jsxs(L,{className:"flex-1",onClick:X,children:[e.jsx(zs,{className:"w-4 h-4 mr-2"})," Search"]}),e.jsxs(L,{variant:"outline",onClick:w,children:[e.jsx(pl,{className:"w-4 h-4 mr-2"})," Reset"]})]})]})})]}),e.jsxs(O,{className:"border rounded shadow-sm",children:[e.jsx(se,{className:"pb-0",children:e.jsx(ee,{className:"text-lg",children:"Transactions – Member Overview"})}),e.jsx($,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:["Sr No","Mla Name","No of works","Total Work Amount","Action (View more)"].map(o=>e.jsx("th",{className:"border px-3 py-2 text-left text-xs font-semibold whitespace-nowrap",children:o},o))})}),e.jsxs("tbody",{children:[A.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"border px-3 py-6 text-center text-sm text-gray-500",colSpan:5,children:"No records match the selected filters."})}),A.map((o,ne)=>{const he=!!C[o.name];return e.jsxs(Kr.Fragment,{children:[e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"border px-3 py-2 text-xs",children:ne+1}),e.jsx("td",{className:"border px-3 py-2 text-xs",children:o.name}),e.jsx("td",{className:"border px-3 py-2 text-xs",children:o.noOfWorks}),e.jsx("td",{className:"border px-3 py-2 text-xs",children:vs(o.totalWorkAmount)}),e.jsx("td",{className:"border px-3 py-2 text-xs",children:e.jsxs(L,{size:"sm",variant:"outline",onClick:()=>Z(o.name),children:[he?e.jsx(na,{className:"w-4 h-4 mr-2"}):e.jsx(wr,{className:"w-4 h-4 mr-2"}),he?"Hide":"View more"]})})]}),he&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-0",children:e.jsxs("div",{className:"p-4 border-t bg-white",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"rounded-md p-4 shadow-sm border-l-4 border-blue-500 bg-gradient-to-br from-blue-50 to-blue-100",children:[e.jsx("p",{className:"text-[11px] font-semibold text-blue-700 uppercase",children:"Mla Name"}),e.jsx("p",{className:"mt-1 text-base font-bold text-blue-900",children:o.name})]}),e.jsxs("div",{className:"rounded-md p-4 shadow-sm border-l-4 border-violet-500 bg-gradient-to-br from-violet-50 to-violet-100",children:[e.jsx("p",{className:"text-[11px] font-semibold text-violet-700 uppercase",children:"Total works"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-violet-900",children:o.noOfWorks})]}),e.jsxs("div",{className:"rounded-md p-4 shadow-sm border-l-4 border-emerald-500 bg-gradient-to-br from-emerald-50 to-emerald-100",children:[e.jsx("p",{className:"text-[11px] font-semibold text-emerald-700 uppercase",children:"Total amount disbursed"}),e.jsx("p",{className:"mt-1 text-xl font-bold text-emerald-900",children:vs(N.filter(k=>o.works.some(c=>c.id===k.workId)&&k.status==="Approved").reduce((k,c)=>k+c.amount,0))})]}),e.jsxs("div",{className:"rounded-md p-4 shadow-sm border-l-4 border-amber-500 bg-gradient-to-br from-amber-50 to-amber-100",children:[e.jsx("p",{className:"text-[11px] font-semibold text-amber-700 uppercase",children:"MLa limit"}),e.jsx("p",{className:"mt-1 text-xl font-bold text-amber-900",children:vs(Oi[o.name]??o.totalWorkAmount)})]})]}),e.jsxs("div",{className:"mt-4 overflow-x-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("p",{className:"text-xs text-gray-600",children:["Showing works under ",e.jsx("span",{className:"font-medium",children:o.name})]}),e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>M(o.name),children:[e.jsx(ma,{className:"w-4 h-4 mr-2"})," Download Works CSV"]})]}),e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:["Sr No","Work Name","Total No Of Demands","Total Amount Dirsbursed","Amount Pending","View Vouchers"].map(k=>e.jsx("th",{className:"border px-3 py-2 text-left text-xs font-semibold whitespace-nowrap",children:k},k))})}),e.jsxs("tbody",{children:[o.works.map((k,c)=>{const D=N.filter(oe=>oe.workId===k.id),de=D.length,I=D.filter(oe=>oe.status==="Approved").reduce((oe,pe)=>oe+pe.amount,0),H=D.filter(oe=>oe.status==="Pending").reduce((oe,pe)=>oe+pe.amount,0);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"border px-3 py-2 text-xs",children:c+1}),e.jsxs("td",{className:"border px-3 py-2 text-xs",children:[e.jsx("div",{className:"font-medium",children:k.name}),e.jsxs("div",{className:"text-[11px] text-gray-500",children:[e.jsx("span",{className:"font-mono",children:k.workCode})," • ",k.constituency,", ",k.district," • ",k.planType]})]}),e.jsx("td",{className:"border px-3 py-2 text-xs",children:de}),e.jsx("td",{className:"border px-3 py-2 text-xs",children:vs(I)}),e.jsx("td",{className:"border px-3 py-2 text-xs",children:vs(H)}),e.jsx("td",{className:"border px-3 py-2 text-xs",children:e.jsxs(L,{size:"sm",variant:"outline",onClick:()=>te(k),children:[e.jsx(Re,{className:"w-4 h-4 mr-2"})," View Vouchers"]})})]},k.id)}),o.works.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"border px-3 py-4 text-center text-sm text-gray-500",colSpan:6,children:"No works under this member for selected filters."})})]})]})]})]})})})]},o.name)})]})]})})})]}),B&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center",onClick:()=>te(null),children:e.jsxs("div",{className:"bg-white rounded-md shadow-lg w-full max-w-4xl p-6",onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base font-semibold",children:["Vouchers – ",B.name]}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Work Code: ",e.jsx("span",{className:"font-mono",children:B.workCode})," • Member: ",B.mlaName," • ",B.planType]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>m(B),children:[e.jsx(ma,{className:"w-4 h-4 mr-2"})," Export CSV"]}),e.jsx("button",{className:"p-1 rounded hover:bg-gray-100","aria-label":"Close",onClick:()=>te(null),children:e.jsx(fs,{size:18})})]})]}),(()=>{const o=N.filter(k=>k.workId===B.id),ne=o.filter(k=>k.status==="Approved").reduce((k,c)=>k+c.amount,0),he=o.filter(k=>k.status==="Pending").reduce((k,c)=>k+c.amount,0);return e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 mb-3",children:[e.jsxs("div",{className:"rounded-md p-3 shadow-sm border-l-4 border-emerald-500 bg-gradient-to-br from-emerald-50 to-emerald-100",children:[e.jsx("p",{className:"text-[11px] font-semibold text-emerald-700 uppercase",children:"Total Amount Dirsbursed"}),e.jsx("p",{className:"mt-1 text-lg font-bold text-emerald-900",children:vs(ne)})]}),e.jsxs("div",{className:"rounded-md p-3 shadow-sm border-l-4 border-amber-500 bg-gradient-to-br from-amber-50 to-amber-100",children:[e.jsx("p",{className:"text-[11px] font-semibold text-amber-700 uppercase",children:"Amount Pending"}),e.jsx("p",{className:"mt-1 text-lg font-bold text-amber-900",children:vs(he)})]}),e.jsxs("div",{className:"rounded-md p-3 shadow-sm border-l-4 border-blue-500 bg-gradient-to-br from-blue-50 to-blue-100",children:[e.jsx("p",{className:"text-[11px] font-semibold text-blue-700 uppercase",children:"Vendor"}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-blue-900",children:B.vendor.name}),e.jsxs("p",{className:"text-[11px] text-blue-700/70",children:["Aadhar: ",rr(B.vendor.aadhar)]})]})]})})(),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:["Demand ID","Amount","Date","Status","Remarks","Receipt"].map(o=>e.jsx("th",{className:"border px-3 py-2 text-left text-xs font-semibold whitespace-nowrap",children:o},o))})}),e.jsxs("tbody",{children:[N.filter(o=>o.workId===B.id).map(o=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"border px-3 py-2 text-xs font-mono",children:o.id}),e.jsx("td",{className:"border px-3 py-2 text-xs",children:vs(o.amount)}),e.jsx("td",{className:"border px-3 py-2 text-xs",children:o.date}),e.jsx("td",{className:"border px-3 py-2 text-xs",children:e.jsx(ye,{variant:o.status==="Approved"?"default":"secondary",children:o.status})}),e.jsx("td",{className:"border px-3 py-2 text-xs",children:o.remarks}),e.jsx("td",{className:"border px-3 py-2 text-xs",children:e.jsxs(L,{size:"sm",variant:"outline",onClick:()=>G({demand:o,work:B}),children:[e.jsx(Re,{className:"w-4 h-4 mr-2"})," View / PDF"]})})]},o.id)),N.filter(o=>o.workId===B.id).length===0&&e.jsx("tr",{children:e.jsx("td",{className:"border px-3 py-4 text-center text-sm text-gray-500",colSpan:6,children:"No vouchers."})})]})]})})]})}),Q&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center",onClick:()=>G(null),children:e.jsxs("div",{className:"bg-white rounded-md shadow-lg w-full max-w-3xl p-6 relative",onClick:o=>o.stopPropagation(),children:[e.jsx("button",{className:"absolute top-3 right-3 p-1 hover:bg-gray-100 rounded-full",onClick:()=>G(null),"aria-label":"Close",children:e.jsx(fs,{size:18})}),e.jsxs("div",{ref:l,className:"space-y-4 text-sm",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("img",{src:"./logo.png",alt:"Gov Seal",className:"h-12 mx-auto"}),e.jsx("h2",{className:"text-base font-bold",children:"Government of Maharashtra"}),e.jsx("p",{className:"text-xs text-gray-600 -mt-1",children:"Finance Department"}),e.jsx("p",{className:"text-xs font-medium",children:"Work Payment Receipt"})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-700 border-y py-1",children:[e.jsxs("span",{children:[e.jsx("strong",{children:"Voucher ID:"})," ",Q.demand.id]}),e.jsxs("span",{children:[e.jsx("strong",{children:"Date:"})," ",new Date().toLocaleDateString("en-IN")]}),e.jsxs("span",{children:[e.jsx("strong",{children:"Time:"})," ",new Date().toLocaleTimeString("en-IN")]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Work Code:"})," ",e.jsx("span",{className:"font-mono",children:Q.work.workCode})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Work Title:"})," ",Q.work.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Member:"})," ",Q.work.mlaName," • ",Q.work.planType]}),e.jsxs("p",{children:[e.jsx("strong",{children:"District:"})," ",Q.work.district]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Constituency:"})," ",Q.work.constituency]})]}),e.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Admin Approved Amount:"})," ",vs(Q.work.adminApprovedAmount)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Disbursed Now:"})," ",vs(Q.demand.amount)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",Q.demand.status]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Remarks:"})," ",Q.demand.remarks]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Vendor:"})," ",Q.work.vendor.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Aadhar:"})," ",rr(Q.work.vendor.aadhar)]})]}),e.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Bank:"})," State Bank of India"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"IFSC:"})," SBIN0000456"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"UTR No:"})," UTR20250717001"]})]})]}),e.jsxs("div",{className:"pt-3 border-t text-right text-xs",children:[e.jsx("p",{className:"text-gray-600",children:"Authorized Signatory"}),e.jsx("div",{className:"h-10 border-b w-40 ml-auto mt-1"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[e.jsx(L,{variant:"outline",size:"sm",onClick:()=>G(null),children:"Close"}),e.jsxs(L,{size:"sm",onClick:y,children:[e.jsx(ma,{className:"w-4 h-4 mr-2"})," Download PDF"]})]})]})})]})}const Ks=a.forwardRef(({className:s,...r},t)=>e.jsx("textarea",{className:ie("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...r}));Ks.displayName="Textarea";const $i=gl,zi=Nl,Ui=jl,Dn=a.forwardRef(({className:s,...r},t)=>e.jsx(Jr,{className:ie("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r,ref:t}));Dn.displayName=Jr.displayName;const Mn=a.forwardRef(({className:s,...r},t)=>e.jsxs(Ui,{children:[e.jsx(Dn,{}),e.jsx(Xr,{ref:t,className:ie("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...r})]}));Mn.displayName=Xr.displayName;const Pn=({className:s,...r})=>e.jsx("div",{className:ie("flex flex-col space-y-2 text-center sm:text-left",s),...r});Pn.displayName="AlertDialogHeader";const En=({className:s,...r})=>e.jsx("div",{className:ie("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...r});En.displayName="AlertDialogFooter";const Tn=a.forwardRef(({className:s,...r},t)=>e.jsx(Zr,{ref:t,className:ie("text-lg font-semibold",s),...r}));Tn.displayName=Zr.displayName;const In=a.forwardRef(({className:s,...r},t)=>e.jsx(Qr,{ref:t,className:ie("text-sm text-muted-foreground",s),...r}));In.displayName=Qr.displayName;const Fn=a.forwardRef(({className:s,...r},t)=>e.jsx(en,{ref:t,className:ie(Wa(),s),...r}));Fn.displayName=en.displayName;const Rn=a.forwardRef(({className:s,...r},t)=>e.jsx(sn,{ref:t,className:ie(Wa({variant:"outline"}),"mt-2 sm:mt-0",s),...r}));Rn.displayName=sn.displayName;function Bi(){var Je,$e,Ss,Bs,Ws,ks,Is,Ys;const{toast:s}=os(),[r,t]=a.useState([]),[n,i]=a.useState([]),[x,g]=a.useState([]),[p,d]=a.useState([]),[j,P]=a.useState(!1),[W,T]=a.useState(!1),[J,X]=a.useState(!1),[w,V]=a.useState(null),[F,N]=a.useState("MLA"),[b,A]=a.useState({fullname:"",username:"",email:"",password:"",mobile:"",districtId:null,mlaName:"",mlaParty:"",mlaTerm:null,constituencyId:null}),[C,q]=a.useState({fullname:"",username:"",email:"",password:"",mobile:"",districtId:null,mlcName:"",mlcContactNumber:"",mlcEmail:"",mlcTerm:null}),[Z,B]=a.useState({remark:"",deactivationLetter:null}),[te,Q]=a.useState("all"),[G,l]=a.useState("all"),[M,m]=a.useState("all"),[y,o]=a.useState(""),[ne,he]=a.useState(!0),[k,c]=a.useState(!1),[D,de]=a.useState(!1),I=async()=>{try{const f="http://13.202.62.178:9090/backend-dfds",K=localStorage.getItem("token"),v=await me.get(`${f}/api/dropdown/districts`,{headers:{Authorization:`Bearer ${K}`,"Content-Type":"application/json"}});i(v.data||[])}catch(f){console.error("Error fetching districts:",f)}},H=async f=>{try{de(!0);const K="http://13.202.62.178:9090/backend-dfds",v=localStorage.getItem("token"),le=await me.get(`${K}/api/dropdown/constituencies/by-district/${f}`,{headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/json"}});g(le.data||[])}catch(K){console.error("Error fetching constituencies:",K),g([])}finally{de(!1)}},oe=async()=>{try{const f="http://13.202.62.178:9090/backend-dfds",K=localStorage.getItem("token"),v=await me.get(`${f}/api/dropdown/financial-years`,{headers:{Authorization:`Bearer ${K}`,"Content-Type":"application/json"}});d(v.data||[])}catch(f){console.error("Error fetching financial years:",f)}},pe=async()=>{try{const f="http://13.202.62.178:9090/backend-dfds",K=localStorage.getItem("token"),le=((await me.get(`${f}/api/admin/mlas`,{headers:{Authorization:`Bearer ${K}`,"Content-Type":"application/json"}})).data||[]).map(ce=>({id:ce.id,type:"MLA",mlaName:ce.mlaName,party:ce.party,contactNumber:ce.contactNumber,email:ce.email,term:ce.term,status:ce.status,constituencyId:ce.constituencyId,constituencyName:ce.constituencyName,districtId:ce.districtId,districtName:ce.districtName,schemeIds:ce.schemeIds||[],schemeNames:ce.schemeNames||[],userId:ce.userId,username:ce.username,isActive:ce.status==="ACTIVE",createdAt:ce.createdAt||new Date().toISOString()}));t(ce=>[...ce.filter(Pe=>Pe.type!=="MLA"),...le])}catch(f){console.error("Error fetching MLA users:",f),s({title:"Error",description:"Failed to fetch MLA users",variant:"destructive"})}},E=async()=>{try{const f="http://13.202.62.178:9090/backend-dfds",K=localStorage.getItem("token"),le=((await me.get(`${f}/api/admin/mlc`,{headers:{Authorization:`Bearer ${K}`,"Content-Type":"application/json"}})).data||[]).map(ce=>({id:ce.id,type:"MLC",mlcName:ce.mlcName,category:ce.category,contactNumber:ce.contactNumber,email:ce.email,term:ce.term,status:ce.status,districtId:ce.districtId,districtName:ce.districtName,schemeIds:ce.schemeIds||[],schemeNames:ce.schemeNames||[],userId:ce.userId,username:ce.username,isActive:ce.status==="ACTIVE",createdAt:ce.createdAt||new Date().toISOString()}));t(ce=>[...ce.filter(Pe=>Pe.type!=="MLC"),...le])}catch(f){console.error("Error fetching MLC users:",f),s({title:"Error",description:"Failed to fetch MLC users",variant:"destructive"})}},R=async()=>{var f,K;try{c(!0);const v="http://13.202.62.178:9090/backend-dfds",le=localStorage.getItem("token");let ce,ve;F==="MLA"?(ce={fullname:b.fullname,username:b.username,email:b.email,password:b.password,mobile:parseInt(b.mobile)||0,districtId:b.districtId,mlaName:b.mlaName,mlaParty:b.mlaParty,mlaTerm:b.mlaTerm,constituencyId:b.constituencyId},ve="/api/user/mla"):(ce={fullname:C.fullname,username:C.username,email:C.email,password:C.password,mobile:parseInt(C.mobile)||0,districtId:C.districtId,mlcName:C.mlcName,mlcContactNumber:C.mlcContactNumber,mlcEmail:C.mlcEmail,mlcTerm:C.mlcTerm},ve="/api/user/mlc"),(await me.post(`${v}${ve}`,ce,{headers:{Authorization:`Bearer ${le}`,"Content-Type":"application/json"}})).data.success&&(P(!1),Ee(),await Promise.all([pe(),E()]),s({title:"Success",description:`${F} user created successfully`,variant:"default"}))}catch(v){console.error("Error creating user:",v);const le=((K=(f=v.response)==null?void 0:f.data)==null?void 0:K.message)||`Failed to create ${F} user`;s({title:"Error",description:le,variant:"destructive"})}finally{c(!1)}},z=async(f,K)=>{var v,le;try{const ce="http://13.202.62.178:9090/backend-dfds",ve=localStorage.getItem("token"),Pe=K==="MLA"?`/api/admin/mlas/${f}/status`:`/api/admin/mlc/${f}/status`,ns={status:"ACTIVE",alsoToggleUser:!0},Se=await me.patch(`${ce}${Pe}`,ns,{headers:{Authorization:`Bearer ${ve}`,"Content-Type":"application/json"}});await Promise.all([pe(),E()]),s({title:"Success",description:`${K} user activated successfully`,variant:"default"})}catch(ce){console.error("Error activating user:",ce);const ve=((le=(v=ce.response)==null?void 0:v.data)==null?void 0:le.message)||`Failed to activate ${K} user`;s({title:"Error",description:ve,variant:"destructive"})}},re=async()=>{var f,K;if(w)try{c(!0);const v="http://13.202.62.178:9090/backend-dfds",le=localStorage.getItem("token"),ce=w.type==="MLA"?`/api/admin/mlas/${w.id}/status`:`/api/admin/mlc/${w.id}/status`,ve={status:"INACTIVE",alsoToggleUser:!0},Pe=await me.patch(`${v}${ce}`,ve,{headers:{Authorization:`Bearer ${le}`,"Content-Type":"application/json"}});X(!1),De(),await Promise.all([pe(),E()]),s({title:"Success",description:`${w.type} user deactivated successfully`,variant:"default"})}catch(v){console.error("Error deactivating user:",v);const le=((K=(f=v.response)==null?void 0:f.data)==null?void 0:K.message)||`Failed to deactivate ${w.type} user`;s({title:"Error",description:le,variant:"destructive"})}finally{c(!1)}},xe=async()=>{var f,K;if(w)try{c(!0);const v="http://13.202.62.178:9090/backend-dfds",le=localStorage.getItem("token");let ce,ve;w.type==="MLA"?(ce={id:w.id,mlaName:b.mlaName,party:b.mlaParty,contactNumber:b.mobile,email:b.email,term:b.mlaTerm,status:w.status,constituencyId:b.constituencyId,constituencyName:w.constituencyName,districtId:b.districtId,districtName:w.districtName,schemeIds:w.schemeIds||[],schemeNames:w.schemeNames||[],userId:w.userId,username:b.username},ve=`/api/admin/mlas/${w.id}`):(ce={id:w.id,mlcName:C.mlcName,category:w.category,contactNumber:C.mlcContactNumber,email:C.mlcEmail,term:C.mlcTerm,status:w.status,districtId:C.districtId,districtName:w.districtName,schemeIds:w.schemeIds||[],schemeNames:w.schemeNames||[],userId:w.userId,username:C.username},ve=`/api/admin/mlc/${w.id}`);const Pe=await me.put(`${v}${ve}`,ce,{headers:{Authorization:`Bearer ${le}`,"Content-Type":"application/json"}});T(!1),Ee(),await Promise.all([pe(),E()]),s({title:"Success",description:`${w.type} user updated successfully`,variant:"default"})}catch(v){console.error("Error updating user:",v);const le=((K=(f=v.response)==null?void 0:f.data)==null?void 0:K.message)||`Failed to update ${w.type} user`;s({title:"Error",description:le,variant:"destructive"})}finally{c(!1)}},Ee=()=>{A({fullname:"",username:"",email:"",password:"",mobile:"",districtId:null,mlaName:"",mlaParty:"",mlaTerm:null,constituencyId:null}),q({fullname:"",username:"",email:"",password:"",mobile:"",districtId:null,mlcName:"",mlcContactNumber:"",mlcEmail:"",mlcTerm:null})},De=()=>{B({remark:"",deactivationLetter:null})},Fe=f=>{F==="MLA"?A(K=>({...K,districtId:f,constituencyId:null})):q(K=>({...K,districtId:f})),f?H(f):g([])},ms=r.filter(f=>{const K=te==="all"||f.type===te,v=G==="all"||f.districtId.toString()===G,le=M==="all"||M==="active"&&f.isActive||M==="inactive"&&!f.isActive,ce=y===""||f.fullname.toLowerCase().includes(y.toLowerCase())||f.username.toLowerCase().includes(y.toLowerCase())||f.email.toLowerCase().includes(y.toLowerCase());return K&&v&&le&&ce});a.useEffect(()=>{(async()=>{he(!0),await Promise.all([I(),oe(),pe(),E()]),he(!1)})()},[]);const Ye=async f=>{try{const K="http://13.202.62.178:9090/backend-dfds",v=localStorage.getItem("token");return(await me.get(`${K}/api/admin/mlas/${f}`,{headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/json"}})).data}catch(K){return console.error("Error fetching MLA details:",K),null}},Te=async f=>{try{const K="http://13.202.62.178:9090/backend-dfds",v=localStorage.getItem("token");return(await me.get(`${K}/api/admin/mlc/${f}`,{headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/json"}})).data}catch(K){return console.error("Error fetching MLC details:",K),null}},xs=f=>f?e.jsxs(ye,{className:"bg-green-100 text-green-800",children:[e.jsx(Pt,{className:"w-3 h-3 mr-1"}),"Active"]}):e.jsxs(ye,{className:"bg-red-100 text-red-800",children:[e.jsx(Et,{className:"w-3 h-3 mr-1"}),"Inactive"]}),He=f=>f==="MLA"?e.jsxs(ye,{className:"bg-blue-100 text-blue-800",children:[e.jsx(xa,{className:"w-3 h-3 mr-1"}),"MLA"]}):e.jsxs(ye,{className:"bg-purple-100 text-purple-800",children:[e.jsx(Ha,{className:"w-3 h-3 mr-1"}),"MLC"]}),Ue=f=>new Date(f).toLocaleDateString("en-IN");return ne?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"w-6 h-6 animate-spin text-blue-600"}),e.jsx("span",{className:"text-lg font-medium text-gray-600",children:"Loading MLA/MLC registry..."})]})}):e.jsxs("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-6 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"MLA/MLC Registry"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage MLA and MLC user registrations"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(L,{onClick:()=>{pe(),E()},variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Refresh"]}),e.jsxs(ts,{open:j,onOpenChange:P,children:[e.jsx(gt,{asChild:!0,children:e.jsxs(L,{className:"flex items-center w-full sm:w-auto",children:[e.jsx(ps,{className:"mr-2 h-4 w-4"}),"Register MLA/MLC"]})}),e.jsxs(Ze,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(as,{children:[e.jsxs(rs,{children:["Register New ",F]}),e.jsxs(Zs,{children:["Create a new ",F," user account with all required details."]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-6",children:[e.jsxs(L,{type:"button",variant:F==="MLA"?"default":"outline",onClick:()=>N("MLA"),className:"flex-1",children:[e.jsx(xa,{className:"w-4 h-4 mr-2"}),"MLA"]}),e.jsxs(L,{type:"button",variant:F==="MLC"?"default":"outline",onClick:()=>N("MLC"),className:"flex-1",children:[e.jsx(Ha,{className:"w-4 h-4 mr-2"}),"MLC"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[F==="MLA"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"mlaName",children:"MLA Name *"}),e.jsx(_,{id:"mlaName",value:b.mlaName,onChange:f=>A(K=>({...K,mlaName:f.target.value})),placeholder:"Enter MLA name"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"mlaParty",children:"MLA Party *"}),e.jsx(_,{id:"mlaParty",value:b.mlaParty,onChange:f=>A(K=>({...K,mlaParty:f.target.value})),placeholder:"Enter MLA party"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"mlaTerm",children:"MLA Term *"}),e.jsxs(Ne,{value:((Je=b.mlaTerm)==null?void 0:Je.toString())||"",onValueChange:f=>A(K=>({...K,mlaTerm:parseInt(f)})),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select MLA term"})}),e.jsx(ge,{children:p.map(f=>e.jsx(ae,{value:f.id.toString(),children:f.name},f.id))})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"district",children:"District *"}),e.jsxs(Ne,{value:(($e=b.districtId)==null?void 0:$e.toString())||"",onValueChange:f=>Fe(parseInt(f)),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select district"})}),e.jsx(ge,{children:n.map(f=>e.jsx(ae,{value:f.id.toString(),children:f.name},f.id))})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"constituency",children:"Constituency *"}),e.jsxs(Ne,{value:((Ss=b.constituencyId)==null?void 0:Ss.toString())||"",onValueChange:f=>A(K=>({...K,constituencyId:parseInt(f)})),disabled:!b.districtId||D,children:[e.jsx(je,{children:e.jsx(fe,{placeholder:D?"Loading...":"Select constituency"})}),e.jsx(ge,{children:x.map(f=>e.jsx(ae,{value:f.id.toString(),children:f.name},f.id))})]})]})]}),F==="MLC"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"mlcName",children:"MLC Name *"}),e.jsx(_,{id:"mlcName",value:C.mlcName,onChange:f=>q(K=>({...K,mlcName:f.target.value})),placeholder:"Enter MLC name"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"mlcContactNumber",children:"MLC Contact Number *"}),e.jsx(_,{id:"mlcContactNumber",value:C.mlcContactNumber,onChange:f=>q(K=>({...K,mlcContactNumber:f.target.value})),placeholder:"Enter MLC contact number"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"mlcEmail",children:"MLC Email *"}),e.jsx(_,{id:"mlcEmail",type:"email",value:C.mlcEmail,onChange:f=>q(K=>({...K,mlcEmail:f.target.value})),placeholder:"Enter MLC email"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"mlcTerm",children:"MLC Term *"}),e.jsxs(Ne,{value:((Bs=C.mlcTerm)==null?void 0:Bs.toString())||"",onValueChange:f=>q(K=>({...K,mlcTerm:parseInt(f)})),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select MLC term"})}),e.jsx(ge,{children:p.map(f=>e.jsx(ae,{value:f.id.toString(),children:f.name},f.id))})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"district",children:"District *"}),e.jsxs(Ne,{value:((Ws=C.districtId)==null?void 0:Ws.toString())||"",onValueChange:f=>Fe(parseInt(f)),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select district"})}),e.jsx(ge,{children:n.map(f=>e.jsx(ae,{value:f.id.toString(),children:f.name},f.id))})]})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"username",children:"Username *"}),e.jsx(_,{id:"username",value:F==="MLA"?b.username:C.username,onChange:f=>{F==="MLA"?A(K=>({...K,username:f.target.value})):q(K=>({...K,username:f.target.value}))},placeholder:"Enter username"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"email",children:"Email *"}),e.jsx(_,{id:"email",type:"email",value:F==="MLA"?b.email:C.email,onChange:f=>{F==="MLA"?A(K=>({...K,email:f.target.value})):q(K=>({...K,email:f.target.value}))},placeholder:"Enter email address"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"password",children:"Password *"}),e.jsx(_,{id:"password",type:"password",value:F==="MLA"?b.password:C.password,onChange:f=>{F==="MLA"?A(K=>({...K,password:f.target.value})):q(K=>({...K,password:f.target.value}))},placeholder:"Enter password"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"mobile",children:"Mobile *"}),e.jsx(_,{id:"mobile",value:F==="MLA"?b.mobile:C.mobile,onChange:f=>{F==="MLA"?A(K=>({...K,mobile:f.target.value})):q(K=>({...K,mobile:f.target.value}))},placeholder:"Enter mobile number"})]})]}),e.jsxs(ta,{children:[e.jsx(L,{variant:"outline",onClick:()=>P(!1),children:"Cancel"}),e.jsxs(L,{onClick:R,disabled:k,children:[k?e.jsx(Le,{className:"w-4 h-4 mr-2 animate-spin"}):null,"Register ",F]})]})]})]}),e.jsx(ts,{open:W,onOpenChange:T,children:e.jsxs(Ze,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(as,{children:[e.jsxs(rs,{children:["Edit ",w==null?void 0:w.type]}),e.jsxs(Zs,{children:["Update ",w==null?void 0:w.type," user details."]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(w==null?void 0:w.type)==="MLA"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"edit-mlaName",children:"MLA Name *"}),e.jsx(_,{id:"edit-mlaName",value:b.mlaName,onChange:f=>A(K=>({...K,mlaName:f.target.value})),placeholder:"Enter MLA name"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"edit-mlaParty",children:"MLA Party *"}),e.jsx(_,{id:"edit-mlaParty",value:b.mlaParty,onChange:f=>A(K=>({...K,mlaParty:f.target.value})),placeholder:"Enter MLA party"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"edit-mlaTerm",children:"MLA Term *"}),e.jsxs(Ne,{value:((ks=b.mlaTerm)==null?void 0:ks.toString())||"",onValueChange:f=>A(K=>({...K,mlaTerm:parseInt(f)})),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select MLA term"})}),e.jsx(ge,{children:p.map(f=>e.jsx(ae,{value:f.id.toString(),children:f.name},f.id))})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"edit-constituency",children:"Constituency *"}),e.jsxs(Ne,{value:((Is=b.constituencyId)==null?void 0:Is.toString())||"",onValueChange:f=>A(K=>({...K,constituencyId:parseInt(f)})),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select constituency"})}),e.jsx(ge,{children:x.map(f=>e.jsx(ae,{value:f.id.toString(),children:f.name},f.id))})]})]})]}),(w==null?void 0:w.type)==="MLC"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"edit-mlcName",children:"MLC Name *"}),e.jsx(_,{id:"edit-mlcName",value:C.mlcName,onChange:f=>q(K=>({...K,mlcName:f.target.value})),placeholder:"Enter MLC name"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"edit-mlcContactNumber",children:"MLC Contact Number *"}),e.jsx(_,{id:"edit-mlcContactNumber",value:C.mlcContactNumber,onChange:f=>q(K=>({...K,mlcContactNumber:f.target.value})),placeholder:"Enter MLC contact number"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"edit-mlcEmail",children:"MLC Email *"}),e.jsx(_,{id:"edit-mlcEmail",type:"email",value:C.mlcEmail,onChange:f=>q(K=>({...K,mlcEmail:f.target.value})),placeholder:"Enter MLC email"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"edit-mlcTerm",children:"MLC Term *"}),e.jsxs(Ne,{value:((Ys=C.mlcTerm)==null?void 0:Ys.toString())||"",onValueChange:f=>q(K=>({...K,mlcTerm:parseInt(f)})),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select MLC term"})}),e.jsx(ge,{children:p.map(f=>e.jsx(ae,{value:f.id.toString(),children:f.name},f.id))})]})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"edit-username",children:"Username *"}),e.jsx(_,{id:"edit-username",value:(w==null?void 0:w.type)==="MLA"?b.username:C.username,onChange:f=>{(w==null?void 0:w.type)==="MLA"?A(K=>({...K,username:f.target.value})):q(K=>({...K,username:f.target.value}))},placeholder:"Enter username"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"edit-email",children:"Email *"}),e.jsx(_,{id:"edit-email",type:"email",value:(w==null?void 0:w.type)==="MLA"?b.email:C.email,onChange:f=>{(w==null?void 0:w.type)==="MLA"?A(K=>({...K,email:f.target.value})):q(K=>({...K,email:f.target.value}))},placeholder:"Enter email address"})]})]}),e.jsxs(ta,{children:[e.jsx(L,{variant:"outline",onClick:()=>T(!1),children:"Cancel"}),e.jsxs(L,{onClick:xe,disabled:k,children:[k?e.jsx(Le,{className:"w-4 h-4 mr-2 animate-spin"}):null,"Update ",w==null?void 0:w.type]})]})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[e.jsx(Ae.div,{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6 shadow-sm",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Ns,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-3 sm:ml-4",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Total Users"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:r.length})]})]})}),e.jsx(Ae.div,{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6 shadow-sm",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Pt,{className:"w-5 h-5 sm:w-6 sm:h-6 text-green-600"})}),e.jsxs("div",{className:"ml-3 sm:ml-4",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Active Users"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-green-600",children:r.filter(f=>f.isActive).length})]})]})}),e.jsx(Ae.div,{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6 shadow-sm",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(Et,{className:"w-5 h-5 sm:w-6 sm:h-6 text-red-600"})}),e.jsxs("div",{className:"ml-3 sm:ml-4",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Inactive Users"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-red-600",children:r.filter(f=>!f.isActive).length})]})]})}),e.jsx(Ae.div,{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6 shadow-sm",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(xa,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-600"})}),e.jsxs("div",{className:"ml-3 sm:ml-4",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Districts"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-purple-600",children:new Set(r.map(f=>f.districtId)).size})]})]})})]}),e.jsxs(O,{children:[e.jsx(se,{children:e.jsx(ee,{className:"text-base sm:text-lg",children:"Filters"})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"type-filter",children:"Type"}),e.jsxs(Ne,{value:te,onValueChange:Q,children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"All Types"})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"all",children:"All Types"}),e.jsx(ae,{value:"MLA",children:"MLA"}),e.jsx(ae,{value:"MLC",children:"MLC"})]})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"district-filter",children:"District"}),e.jsxs(Ne,{value:G,onValueChange:l,children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"All Districts"})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"all",children:"All Districts"}),n.map(f=>e.jsx(ae,{value:f.id.toString(),children:f.name},f.id))]})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"status-filter",children:"Status"}),e.jsxs(Ne,{value:M,onValueChange:m,children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"All Status"})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"all",children:"All Status"}),e.jsx(ae,{value:"active",children:"Active"}),e.jsx(ae,{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"search",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(zs,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(_,{id:"search",placeholder:"Search users...",value:y,onChange:f=>o(f.target.value),className:"pl-10"})]})]})]})})]}),e.jsxs(O,{children:[e.jsx(se,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx(ee,{className:"text-base sm:text-lg",children:"Registered MLA/MLC Users"}),e.jsxs(L,{variant:"outline",size:"sm",className:"w-full sm:w-auto",children:[e.jsx(Xs,{className:"w-4 h-4 mr-2"}),"Export"]})]})}),e.jsx($,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ke,{children:[e.jsx(Be,{children:e.jsxs(ue,{children:[e.jsx(U,{className:"text-xs sm:text-sm",children:"Sr No"}),e.jsx(U,{className:"text-xs sm:text-sm",children:"Type"}),e.jsx(U,{className:"text-xs sm:text-sm",children:"Name"}),e.jsx(U,{className:"text-xs sm:text-sm",children:"Username"}),e.jsx(U,{className:"text-xs sm:text-sm",children:"District"}),e.jsx(U,{className:"text-xs sm:text-sm",children:"Contact"}),e.jsx(U,{className:"text-xs sm:text-sm",children:"Status"}),e.jsx(U,{className:"text-xs sm:text-sm",children:"Created"}),e.jsx(U,{className:"text-right text-xs sm:text-sm",children:"Actions"})]})}),e.jsx(We,{children:ms.map((f,K)=>e.jsxs(ue,{children:[e.jsx(h,{className:"text-xs sm:text-sm",children:K+1}),e.jsx(h,{className:"text-xs sm:text-sm",children:He(f.type)}),e.jsx(h,{className:"text-xs sm:text-sm",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:f.type==="MLA"?f.mlaName:f.mlcName}),e.jsx("div",{className:"text-gray-500",children:f.email}),f.type==="MLA"&&e.jsxs("div",{className:"text-xs text-blue-600",children:["Party: ",f.party]}),f.type==="MLC"&&e.jsxs("div",{className:"text-xs text-purple-600",children:["Category: ",f.category]})]})}),e.jsx(h,{className:"text-xs sm:text-sm",children:e.jsx("div",{className:"font-mono text-xs",children:f.username})}),e.jsx(h,{className:"text-xs sm:text-sm",children:f.districtName}),e.jsx(h,{className:"text-xs sm:text-sm",children:e.jsxs("div",{children:[e.jsx("div",{children:f.contactNumber}),f.type==="MLA"&&f.constituencyName&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Constituency: ",f.constituencyName]})]})}),e.jsx(h,{className:"text-xs sm:text-sm",children:xs(f.isActive)}),e.jsx(h,{className:"text-xs sm:text-sm text-gray-500",children:Ue(f.createdAt)}),e.jsx(h,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end space-x-1 sm:space-x-2",children:[e.jsx(L,{variant:"ghost",size:"sm",onClick:async()=>{try{if(f.type==="MLA"){const v=await Ye(f.id);v&&s({title:"MLA Details",description:`MLA: ${v.mlaName}, Party: ${v.mlaParty}, Term: ${v.mlaTerm}`,variant:"default"})}else{const v=await Te(f.id);v&&s({title:"MLC Details",description:`MLC: ${v.mlcName}, Category: ${v.mlcCategory}, Term: ${v.mlcTerm}`,variant:"default"})}}catch{s({title:"Error",description:"Failed to fetch user details",variant:"destructive"})}},className:"h-8 w-8 p-0",children:e.jsx(Re,{className:"w-3 h-3 sm:w-4 sm:h-4 text-blue-600"})}),f.isActive?e.jsxs($i,{children:[e.jsx(zi,{asChild:!0,children:e.jsx(L,{variant:"ghost",size:"sm",onClick:()=>V(f),className:"h-8 w-8 p-0",children:e.jsx(Et,{className:"w-3 h-3 sm:w-4 sm:h-4 text-orange-600"})})}),e.jsxs(Mn,{children:[e.jsxs(Pn,{children:[e.jsx(Tn,{children:"Deactivate User"}),e.jsxs(In,{children:["Are you sure you want to deactivate ",f.fullname,"? This action requires a remark and deactivation letter."]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"remark",children:"Deactivation Remark *"}),e.jsx(Ks,{id:"remark",value:Z.remark,onChange:v=>B(le=>({...le,remark:v.target.value})),placeholder:"Enter reason for deactivation"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"deactivationLetter",children:"Deactivation Letter *"}),e.jsx(_,{id:"deactivationLetter",type:"file",accept:".pdf,.png,.jpg,.jpeg",onChange:v=>B(le=>{var ce;return{...le,deactivationLetter:((ce=v.target.files)==null?void 0:ce[0])||null}})})]})]}),e.jsxs(En,{children:[e.jsx(Rn,{onClick:()=>De(),children:"Cancel"}),e.jsx(Fn,{onClick:re,disabled:!Z.remark||!Z.deactivationLetter,className:"bg-red-600 hover:bg-red-700",children:"Deactivate"})]})]})]}):e.jsx(L,{variant:"ghost",size:"sm",onClick:()=>z(f.id,f.type),className:"h-8 w-8 p-0",children:e.jsx(Pt,{className:"w-3 h-3 sm:w-4 sm:h-4 text-green-600"})}),e.jsx(L,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>{V(f),N(f.type),f.type==="MLA"?A({fullname:f.mlaName,username:f.username,email:f.email,password:"",mobile:f.contactNumber,districtId:f.districtId,mlaName:f.mlaName,mlaParty:f.party,mlaTerm:f.term,constituencyId:f.constituencyId}):q({fullname:f.mlcName,username:f.username,email:f.email,password:"",mobile:f.contactNumber,districtId:f.districtId,mlcName:f.mlcName,mlcContactNumber:f.contactNumber,mlcEmail:f.email,mlcTerm:f.term}),T(!0)},children:e.jsx(la,{className:"w-3 h-3 sm:w-4 sm:h-4 text-blue-600"})})]})})]},f.id))}),ms.length===0&&e.jsx(js,{children:e.jsx(ue,{children:e.jsx(h,{colSpan:9,className:"text-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(Ns,{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-400"}),e.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:"No users found"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"Try adjusting your filters"})]})})})})]})})})]})]})}const nr={"प्रथम हप्ता":"First Installment","पहिली मागणी":"Initial Request","दुसरी मागणी":"Second Installment"},Ds=s=>`₹${(s||0).toLocaleString()}`,Wi=({open:s,onClose:r,demand:t,work:n,demands:i=[]})=>{if(!s||!t||!n)return null;const x=i.filter(V=>V.workId===n.id),g=(n.workPortionAmount??0)+(n.taxDeductionAmount??0),p=x.reduce((V,F)=>V+(F.amount??0),0),d=x.filter(V=>V.status==="Approved").reduce((V,F)=>V+F.amount,0),P=x.filter(V=>V.id!==t.id).map(V=>({...V,disbursed:V.status==="Approved"?V.amount:0})),W=Math.max(0,g-(d+t.amount)),T=nr[t.remarks]||t.remarks,J=n.sanctionedDate||"—",X=()=>alert(`Approved ${t.id}`),w=()=>alert(`Rejected ${t.id}`);return e.jsxs("div",{className:`
        bg-white rounded-2xl shadow-lg
        w-full max-w-[90vw] md:max-w-[1200px]
        max-h-[90vh] overflow-y-auto
        relative p-6
      `,children:[e.jsx("button",{className:"absolute top-4 right-4",onClick:r,children:e.jsx(fs,{className:"w-5 h-5 text-gray-400 hover:text-red-500"})}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold",children:["Fund Demand Details – ",e.jsx("span",{className:"text-gray-600",children:n.workCode})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Financial Year: ",n.financialYear]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(O,{children:[e.jsx(se,{className:"pb-2",children:e.jsx(ee,{className:"text-base",children:"Work & MLA Overview"})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"MLA/MLC Name"}),e.jsx("div",{children:n.mlaName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"District"}),e.jsx("div",{children:n.district})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Constituency"}),e.jsx("div",{children:n.constituency})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Work Code"}),e.jsx("div",{children:n.workCode})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Work Title"}),e.jsx("div",{children:n.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Financial Year"}),e.jsx("div",{children:n.financialYear})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Work Sanctioned Date"}),e.jsx("div",{children:J})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"AA Amount"}),e.jsx("div",{children:Ds(n.adminApprovedAmount)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Gross Amount"}),e.jsx("div",{children:Ds(g)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Total Demanded"}),e.jsx("div",{children:Ds(p)})]})]})})]}),e.jsxs(O,{children:[e.jsx(se,{className:"pb-2",children:e.jsx(ee,{className:"text-base",children:"Vendor Details"})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Vendor ID"}),e.jsx("div",{children:n.vendor.id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Vendor Name"}),e.jsx("div",{children:n.vendor.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Aadhar No."}),e.jsxs("div",{children:["xxxx-xxxx-",n.vendor.aadhar.slice(-4)]})]})]})})]}),e.jsxs(O,{children:[e.jsx(se,{className:"pb-2",children:e.jsx(ee,{className:"text-base",children:"File Attachments"})}),e.jsx($,{children:e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("a",{href:"#",onClick:V=>V.preventDefault(),className:"inline-flex items-center gap-1 text-blue-700 underline",children:[e.jsx(ze,{className:"w-4 h-4"})," Work Order"]}),e.jsxs("a",{href:"#",onClick:V=>V.preventDefault(),className:"inline-flex items-center gap-1 text-blue-700 underline",children:[e.jsx(ze,{className:"w-4 h-4"})," AA Order"]}),e.jsxs("a",{href:"#",onClick:V=>V.preventDefault(),className:"inline-flex items-center gap-1 text-blue-700 underline",children:[e.jsx(ze,{className:"w-4 h-4"})," Previous Releases"]})]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(O,{children:[e.jsx(se,{className:"pb-2",children:e.jsx(ee,{className:"text-base",children:"Fund Demands in FY 2024-2025"})}),e.jsx($,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-xs border",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-1 border text-left",children:"Demand ID"}),e.jsx("th",{className:"px-2 py-1 border text-left",children:"Date"}),e.jsx("th",{className:"px-2 py-1 border text-right",children:"Demand Amount"}),e.jsx("th",{className:"px-2 py-1 border text-right",children:"Disbursed Amount"}),e.jsx("th",{className:"px-2 py-1 border text-center",children:"Status"})]})}),e.jsx("tbody",{children:P.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center text-gray-400 py-4",children:"No previous demands in this FY."})}):P.map(V=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-2 py-1 border",children:V.id}),e.jsx("td",{className:"px-2 py-1 border",children:V.date}),e.jsx("td",{className:"px-2 py-1 border text-right",children:Ds(V.amount)}),e.jsx("td",{className:"px-2 py-1 border text-right",children:Ds(V.disbursed)}),e.jsx("td",{className:"px-2 py-1 border text-center",children:e.jsx(ye,{children:V.status})})]},V.id))})]})})})]}),e.jsxs(O,{children:[e.jsx(se,{className:"pb-2",children:e.jsx(ee,{className:"text-base",children:"Current Demand Details"})}),e.jsxs($,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Demand ID"}),e.jsx("div",{children:t.id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Date"}),e.jsx("div",{children:t.date})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Demand Amount"}),e.jsx("div",{children:Ds(t.amount)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Status"}),e.jsx("div",{children:e.jsx(ye,{children:t.status})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Remark"}),e.jsx("div",{children:T})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"rounded-md bg-emerald-50 border border-emerald-200 p-3",children:[e.jsx("div",{className:"text-[11px] text-emerald-700 font-semibold",children:"Total Disbursed (Till Date)"}),e.jsx("div",{className:"text-lg font-bold text-emerald-900",children:Ds(d)})]}),e.jsxs("div",{className:"rounded-md bg-amber-50 border border-amber-200 p-3",children:[e.jsx("div",{className:"text-[11px] text-amber-700 font-semibold",children:"Balance Remaining (After Current)"}),e.jsx("div",{className:"text-lg font-bold text-amber-900",children:Ds(W)})]})]})]})]})]})]}),e.jsxs(O,{className:"mb-4",children:[e.jsx(se,{children:e.jsx(ee,{className:"text-base",children:"All Demands for this Work"})}),e.jsx($,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-xs border",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-1 border text-left",children:"Demand ID"}),e.jsx("th",{className:"px-2 py-1 border text-left",children:"Date"}),e.jsx("th",{className:"px-2 py-1 border text-right",children:"Amount"}),e.jsx("th",{className:"px-2 py-1 border text-center",children:"Status"}),e.jsx("th",{className:"px-2 py-1 border text-left",children:"Remark"})]})}),e.jsx("tbody",{children:x.length>0?x.map(V=>e.jsxs("tr",{className:V.id===t.id?"bg-primary/10 font-semibold":void 0,children:[e.jsx("td",{className:"px-2 py-1 border",children:V.id}),e.jsx("td",{className:"px-2 py-1 border",children:V.date}),e.jsx("td",{className:"px-2 py-1 border text-right",children:Ds(V.amount)}),e.jsx("td",{className:"px-2 py-1 border text-center",children:e.jsx(ye,{children:V.status})}),e.jsx("td",{className:"px-2 py-1 border",children:nr[V.remarks]||V.remarks})]},V.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center text-gray-400 py-4",children:"No demands"})})})]})})})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsxs(L,{variant:"destructive",onClick:w,children:[e.jsx(Ts,{className:"w-4 h-4 mr-1"})," Reject"]}),e.jsxs(L,{variant:"default",onClick:X,children:[e.jsx(ws,{className:"w-4 h-4 mr-1"})," Approve"]})]})]})},kt=[{id:467,workCode:"ML/2425/2572",name:"ML/2425/2572 आमदार स्थानिक विकास कार्यक्रम सन २०२४-२५ अंतर्गत बारामती येथे होणाऱ्या शिवछत्रपती राज्य स्तरीय कबड्डी स्पर्धेकरिता निधी उपलब्ध करणेबाबत",district:"Pune",constituency:"Baramati",mlaName:"Ajit Anantrao Pawar",financialYear:"2024-25",adminApprovedAmount:2999,workPortionAmount:2800,taxDeductionAmount:100,vendor:{id:"1189",name:"Shree Ganesh Constructions Pvt. Ltd.",aadhar:"123412341234"}},{id:468,workCode:"ML/2425/2151",name:"ML/2425/2151 जांबूत येथे जांबूत चोंभूत रोड ते कळमजाई मंदिर रस्ता करणे ता.शिरुर",district:"Pune",constituency:"Shirur",mlaName:"Dnyaneshwar Katke",financialYear:"2024-25",adminApprovedAmount:1400,workPortionAmount:1200,taxDeductionAmount:110,vendor:{id:"1189",name:"Maratha Nirman & Co.",aadhar:"987654321098"}},{id:469,workCode:"ML/2425/2569",name:"ML/2425/2569 आमदार स्थानिक विकास कार्यक्रम सन २०२४-२५ अंतर्गत बारामती येथे होणाऱ्या शिवछत्रपती राज्य स्तरीय कबड्डी स्पर्धेकरिता निधी उपलब्ध करणेबाबत",district:"Pune",constituency:"Baramati",mlaName:"Ajit Anantrao Pawar",financialYear:"2024-25",adminApprovedAmount:1990,workPortionAmount:1800,taxDeductionAmount:100,vendor:{id:"1189",name:"Sadguru Infrastructure Ltd.",aadhar:"456789123456"}},{id:470,workCode:"ML/2425/0325",name:"ML/2425/0325 मौजे वेहेरगाव येथे भैरवनाथ मंदिरासमोरील ग्रामपंचायतीच्या मोकळ्या जागेत सभामंडप बांधणे.ता.मावळ.जि.पुणे ग्रामपंचायत वेहेरगाव मालमत्ता क्रमांक 120 Lat18.784103 Long73.465508",district:"Pune",constituency:"Maval",mlaName:"Sunil Shankarrao Shelke",financialYear:"2024-25",adminApprovedAmount:1600,workPortionAmount:1400,taxDeductionAmount:100,vendor:{id:"1189",name:"Maharashtra Builders & Developers",aadhar:"321098765432"}}],Yi=[{id:"MLD-467-1",workId:467,amount:500,date:"2025-02-01",status:"Pending",remarks:"First Installment"},{id:"MLD-468-1",workId:468,amount:500,date:"2025-02-02",status:"Pending",remarks:"First Installment"},{id:"MLD-469-1",workId:469,amount:500,date:"2025-02-03",status:"Pending",remarks:"First Installment"},{id:"MLD-470-1",workId:470,amount:500,date:"2025-02-04",status:"Pending",remarks:"First Installment"},{id:"MLD-473-1",workId:473,amount:500,date:"2025-02-05",status:"Pending",remarks:"First Installment"},{id:"MLD-473-2",workId:473,amount:500,date:"2025-03-05",status:"Approved",remarks:"Second Installment"},{id:"MLD-474-1",workId:474,amount:500,date:"2025-02-06",status:"Pending",remarks:"First Installment"},{id:"MLD-475-1",workId:475,amount:500,date:"2025-02-07",status:"Pending",remarks:"First Installment"},{id:"MLD-475-2",workId:475,amount:500,date:"2025-03-07",status:"Approved",remarks:"Second Installment"},{id:"MLD-476-1",workId:476,amount:500,date:"2025-02-08",status:"Pending",remarks:"First Installment"},{id:"MLD-476-2",workId:476,amount:500,date:"2025-03-08",status:"Approved",remarks:"Second Installment"},{id:"MLD-477-1",workId:477,amount:500,date:"2025-02-09",status:"Pending",remarks:"First Installment"},{id:"MLD-477-2",workId:477,amount:500,date:"2025-03-09",status:"Approved",remarks:"Second Installment"}];function ba(s){return Array.from(new Set(s))}function lr(s){return`₹${(s||0).toLocaleString()}`}function Rt(...s){return s.filter(Boolean).join(" ")}function Ht({value:s,onChange:r,options:t,placeholder:n="Select…",className:i}){const[x,g]=a.useState(!1),p=a.useMemo(()=>[...t].sort((d,j)=>d.localeCompare(j,"en",{sensitivity:"base"})),[t]);return e.jsxs($t,{open:x,onOpenChange:g,children:[e.jsx(zt,{asChild:!0,children:e.jsxs(L,{variant:"outline",role:"combobox","aria-expanded":x,className:Rt("w-full justify-between h-9 text-xs",i),children:[e.jsx("span",{className:Rt(!s&&"text-muted-foreground"),children:s||n}),e.jsx(Vt,{className:"ml-2 h-4 w-4 opacity-60"})]})}),e.jsx(jt,{className:"p-0 w-[--radix-popover-trigger-width] min-w-[200px]",align:"start",children:e.jsxs(Nt,{children:[e.jsx(ft,{placeholder:"Type to search…",className:"h-9 text-xs"}),e.jsx(bt,{children:"No results found."}),e.jsx(yt,{className:"max-h-64 overflow-auto",children:p.map(d=>{const j=s===d;return e.jsxs(vt,{value:d,onSelect:P=>{r(P),g(!1)},className:"text-xs",children:[e.jsx(ws,{className:Rt("mr-2 h-4 w-4",j?"opacity-100":"opacity-0")}),e.jsx("span",{className:"truncate",children:d})]},d)})})]})})]})}function Hi(){const[s,r]=a.useState(Yi),[t,n]=a.useState("All"),[i,x]=a.useState("All"),[g,p]=a.useState("All"),[d,j]=a.useState("All"),[P,W]=a.useState(!1),[T,J]=a.useState(null),[X,w]=a.useState(new Set),V=a.useMemo(()=>X.size>0&&q().every(m=>X.has(m.id)),[X,t,i,g,d,s]),F=a.useMemo(()=>["All",...ba(kt.map(m=>m.financialYear))],[]),N=["All","MLA","MLC","HADP"],b=a.useMemo(()=>["All",...ba(kt.map(m=>m.district))],[]),A=a.useMemo(()=>["All",...ba(kt.map(m=>m.mlaName))],[]),C=m=>"MLA",q=()=>s.filter(m=>{const y=kt.find(o=>o.id===m.workId);return!(!y||t!=="All"&&y.financialYear!==t||i!=="All"&&C()!==i||g!=="All"&&y.district!==g||d!=="All"&&y.mlaName!==d)}),Z=a.useMemo(()=>q().reduce((m,y)=>m+y.amount,0),[t,i,g,d,s]);a.useMemo(()=>q().length,[t,i,g,d,s]);const B=a.useMemo(()=>q().filter(m=>m.status==="Pending").length,[t,i,g,d,s]),te=m=>{J(m),W(!0)},Q=m=>{w(y=>{const o=new Set(y);return o.has(m)?o.delete(m):o.add(m),o})},G=()=>{const m=q();w(y=>{const o=new Set(y);return m.every(he=>o.has(he.id))?m.forEach(he=>o.delete(he.id)):m.forEach(he=>o.add(he.id)),o})},l=()=>{X.size!==0&&(r(m=>m.map(y=>X.has(y.id)?{...y,status:"Approved"}:y)),w(new Set))},M=q();return e.jsxs("div",{className:"p-6 space-y-6 bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-1",children:[e.jsxs(Ae.div,{className:"rounded-md p-4 shadow-sm border-l-4 border-blue-500 bg-gradient-to-br from-blue-50 to-blue-100",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:[e.jsx("p",{className:"text-xs font-semibold text-blue-700 uppercase",children:"Total Demand Amount"}),e.jsx("p",{className:"text-[11px] text-blue-700/70 mt-1",children:"Pending At State For Approval"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-blue-900",children:lr(Z)})]}),e.jsxs(Ae.div,{className:"rounded-md p-4 shadow-sm border-l-4 border-emerald-500 bg-gradient-to-br from-emerald-50 to-emerald-100",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05},children:[e.jsx("p",{className:"text-xs font-semibold text-emerald-700 uppercase",children:"Total Number of Demands"}),e.jsx("p",{className:"text-[11px] text-emerald-700/70 mt-1",children:"Pending At State For Approval"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-emerald-900",children:M.length})]}),e.jsxs(Ae.div,{className:"rounded-md p-4 shadow-sm border-l-4 border-blue-500 bg-gradient-to-br from-blue-50 to-blue-100",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsx("p",{className:"text-xs font-semibold text-blue-700 uppercase",children:"Fund Demands Amount"}),e.jsx("p",{className:"text-[11px] text-blue-700/70 mt-1",children:g==="All"?"Pending at All districts For Approval":`District: ${g}`}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-blue-900",children:lr(1e3)})]}),e.jsxs(Ae.div,{className:"rounded-md p-4 shadow-sm border-l-4 border-emerald-500 bg-gradient-to-br from-emerald-50 to-emerald-90",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsx("p",{className:"text-xs font-semibold text-emerald-700 uppercase",children:"total No of  Demands"}),e.jsx("p",{className:"text-[11px] text-emerald-700/70 mt-1",children:g==="All"?"Pending at All districts":`District: ${g}`}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-amber-900",children:B})]})]}),e.jsxs(O,{className:"rounded-md shadow-sm",children:[e.jsx(se,{className:"pb-2",children:e.jsx(ee,{className:"text-sm",children:"Filters"})}),e.jsx($,{className:"p-3",children:e.jsxs("div",{className:"grid grid-cols-12 gap-3 items-end",children:[e.jsxs("div",{className:"col-span-12 sm:col-span-6 md:col-span-3 lg:col-span-2",children:[e.jsx("span",{className:"block text-[11px] text-gray-600 mb-1",children:"Financial Year"}),e.jsx(Ht,{value:t,onChange:n,options:F})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-6 md:col-span-3 lg:col-span-2",children:[e.jsx("span",{className:"block text-[11px] text-gray-600 mb-1",children:"Plan Type"}),e.jsx(Ht,{value:i,onChange:x,options:N})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-6 md:col-span-3 lg:col-span-3",children:[e.jsx("span",{className:"block text-[11px] text-gray-600 mb-1",children:"District"}),e.jsx(Ht,{value:g,onChange:p,options:b})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-6 md:col-span-3 lg:col-span-3",children:[e.jsx("span",{className:"block text-[11px] text-gray-600 mb-1",children:"MLA/MLC Name"}),e.jsx(Ht,{value:d,onChange:j,options:A})]})]})})]}),e.jsxs(O,{className:"rounded-md shadow-sm",children:[e.jsx(se,{className:"pb-2",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx(ee,{className:"text-base text-gray-800",children:"MLA/MLC Fund Demands"}),e.jsx("span",{className:"text-xs text-red-600 italic",children:"*All Amounts Are in Thousands"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 accent-blue-600",checked:V,onChange:G}),e.jsx("span",{children:"Select all"})]}),e.jsxs(L,{size:"sm",className:Rt("h-8",X.size===0&&"opacity-50 pointer-events-none"),onClick:l,children:["Approve Selected (",X.size,")"]})]})]})}),e.jsx($,{className:"overflow-x-auto p-0",children:e.jsxs("table",{className:"min-w-full border border-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-3 py-2 text-center w-10",children:"Sel"}),e.jsx("th",{className:"border px-3 py-2 text-left",children:"Sr No"}),e.jsx("th",{className:"border px-3 py-2 text-left",children:"District"}),e.jsx("th",{className:"border px-3 py-2 text-left",children:"Demand ID"}),e.jsx("th",{className:"border px-3 py-2 text-left",children:"MLA/MLC Account Name"}),e.jsx("th",{className:"border px-3 py-2 text-right",children:"AA Amount"}),e.jsx("th",{className:"border px-3 py-2 text-right",children:"Gross Work Order Amt"}),e.jsx("th",{className:"border px-3 py-2 text-right",children:"Demand Amount"}),e.jsx("th",{className:"border px-3 py-2 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:M.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"py-6 text-center text-gray-500",children:"No records found"})}):M.map((m,y)=>{const o=kt.find(k=>k.id===m.workId),ne=o.workPortionAmount+o.taxDeductionAmount,he=X.has(m.id);return e.jsxs("tr",{className:Rt("hover:bg-gray-50",m.status==="Approved"&&"bg-green-50/50"),children:[e.jsx("td",{className:"border px-3 py-2 text-center",children:e.jsx("input",{type:"checkbox",className:"h-4 w-4 accent-blue-600",checked:he,onChange:()=>Q(m.id)})}),e.jsx("td",{className:"border px-3 py-2",children:y+1}),e.jsx("td",{className:"border px-3 py-2",children:o.district}),e.jsx("td",{className:"border px-3 py-2",children:m.id}),e.jsx("td",{className:"border px-3 py-2",children:o.mlaName}),e.jsx("td",{className:"border px-3 py-2 text-right",children:o.adminApprovedAmount}),e.jsx("td",{className:"border px-3 py-2 text-right",children:ne}),e.jsx("td",{className:"border px-3 py-2 text-right",children:m.amount.toLocaleString()}),e.jsx("td",{className:"border px-3 py-2 text-center",children:e.jsxs(ts,{open:P&&T===m.id,onOpenChange:W,children:[e.jsx(gt,{asChild:!0,children:e.jsx(L,{size:"icon",variant:"ghost",onClick:()=>te(m.id),children:e.jsx(Re,{className:"w-5 h-5 text-blue-600"})})}),e.jsx(Ze,{className:"w-[90vw] max-w-[1200px]",children:e.jsx(Wi,{open:P&&T===m.id,onClose:()=>W(!1),demand:m,work:o,demands:s})})]})})]},m.id)})})]})})]})]})}const ya=s=>Array.from(new Set(s)),it={financialYear:"2025-2026",data:[{district:"PUNE",taluka:"Pimpri",type:"MLA",term:15,name:"Anna Dadu Bansode",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:2e4},{district:"PUNE",taluka:"Baramati",type:"MLA",term:14,name:"Ajit Anantrao Pawar",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:1e4},{district:"PUNE",taluka:"Khed Alandi",type:"MLA",term:15,name:"Babaji Ramchandra Kale",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:1e4},{district:"PUNE",taluka:"Vadgaon Sheri",type:"MLA",term:14,name:"Bapusaheb Tukaram Pathare",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Khadakwasala",type:"MLA",term:14,name:"Bhimrao Dhondiba Tapkir",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Bhosari",type:"MLA",term:15,name:"Mahesh Landge",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Hadapsar",type:"MLA",term:15,name:"Chetan Tupe",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Kothrud",type:"MLA",term:15,name:"Chandrakant Bachhu Patil",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Indapur",type:"MLA",term:15,name:"Dattatraya Vithoba Bharne",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Shirur",type:"MLA",term:14,name:"Dnyaneshwar Katke",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Ambegaon",type:"MLA",term:14,name:"Dilip Walse-Patil",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Kasba Peth",type:"MLA",term:15,name:"Hemant Narayan Rasane",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Chinchwad",type:"MLA",term:14,name:"Shankar Jagtap",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Bhor",type:"MLA",term:15,name:"Shankar Hiraman Mandekar",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Shivajinagar",type:"MLA",term:15,name:"Siddharth Shirole",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Pune Cantonment",type:"MLA",term:14,name:"Suni Dnyandev Kamble",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Maval",type:"MLA",term:15,name:"Sunil Shankarrao Shelke",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Parvati",type:"MLA",term:15,name:"Madhuri Satish Misal",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Daund",type:"MLA",term:14,name:"Rahul Subhashrao Kul",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Junnar",type:"MLA",term:14,name:"Sharad Sonavane",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Purandar",type:"MLA",term:14,name:"Vijay Shivtare",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:5e4,fundUtilized:0,balance:5e4,pendingDemands:0},{district:"PUNE",taluka:"Purandar",type:"MLC",term:14,name:"Vijay Shivtare",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",budget:"150000",fundUtilized:0,balance:7e4,pendingDemands:0}]},Ge=s=>Number(s||0),va=(...s)=>s.filter(Boolean).join(" ");function Lt({value:s,onValueChange:r,options:t,placeholder:n="Select…",className:i}){const[x,g]=a.useState(!1),p=a.useMemo(()=>{const j=[...t],P=j.includes("All"),W=j.filter(T=>T!=="All").sort((T,J)=>T.localeCompare(J,"en",{sensitivity:"base"}));return P?["All",...W]:W},[t]),d=s||n;return e.jsxs($t,{open:x,onOpenChange:g,children:[e.jsx(zt,{asChild:!0,children:e.jsxs(L,{variant:"outline",role:"combobox","aria-expanded":x,className:va("w-full justify-between",i),children:[e.jsx("span",{className:va(!s&&"text-muted-foreground"),children:d}),e.jsx(Vt,{className:"ml-2 h-4 w-4 opacity-50"})]})}),e.jsx(jt,{className:"p-0 w-[--radix-popover-trigger-width] min-w-[220px]",children:e.jsxs(Nt,{children:[e.jsx(ft,{placeholder:"Search..."}),e.jsx(bt,{children:"No results found."}),e.jsx(yt,{className:"max-h-64 overflow-auto",children:p.map(j=>{const P=s===j;return e.jsxs(vt,{value:j,onSelect:W=>{r(W),g(!1)},children:[e.jsx(ws,{className:va("mr-2 h-4 w-4",P?"opacity-100":"opacity-0")}),e.jsx("span",{children:j})]},j)})})]})})]})}const Gi=({district:s="PUNE"})=>{const[r,t]=a.useState(it.financialYear),[n,i]=a.useState("ML-MLA"),[x,g]=a.useState("All"),[p,d]=a.useState("All"),[j,P]=a.useState("All"),[W,T]=a.useState(!1),J=a.useMemo(()=>["All",it.financialYear],[]),X=["ML-MLA","ML-MLC","HADP"],w=a.useMemo(()=>it.data.filter(c=>c.type==="MLA"),[]),V=a.useMemo(()=>it.data.filter(c=>c.type==="MLC"),[]),F=a.useMemo(()=>w.filter(c=>c.district===s),[w,s]),N=a.useMemo(()=>V.filter(c=>c.district===s),[V,s]),b=a.useMemo(()=>ct.filter(c=>(c.district||"Unknown")===s),[s]),A=a.useMemo(()=>["All",...ya(F.map(c=>c.name))],[F]),C=a.useMemo(()=>["All",...ya(N.map(c=>c.name))],[N]),q=a.useMemo(()=>["All",...ya(b.map(c=>c.taluka||"Unknown"))],[b]),Z=a.useMemo(()=>F.filter(D=>r==="All"||it.financialYear===r).filter(D=>x==="All"||D.name===x).filter(D=>!W||Ge(D.pendingDemands)>0).sort((D,de)=>D.name.localeCompare(de.name,"en",{sensitivity:"base"})),[F,r,x,W]),B=a.useMemo(()=>N.filter(D=>r==="All"||it.financialYear===r).filter(D=>p==="All"||D.name===p).filter(D=>!W||Ge(D.pendingDemands)>0).sort((D,de)=>D.name.localeCompare(de.name,"en",{sensitivity:"base"})),[N,r,p,W]),te=a.useMemo(()=>{let c=b;j!=="All"&&(c=c.filter(I=>(I.taluka||"Unknown")===j));const D={};c.forEach(I=>{D[I.demandCode]||(D[I.demandCode]={budget:0,utilized:0,balance:0,pendingDemands:0,demandCode:I.demandCode}),D[I.demandCode].budget+=I.demandAmount,I.status==="Approved"?D[I.demandCode].utilized+=I.demandAmount:D[I.demandCode].balance+=I.demandAmount,I.status!=="Approved"&&(D[I.demandCode].pendingDemands+=I.demandAmount)});let de=Object.values(D);return de=de.sort((I,H)=>I.demandCode.localeCompare(H.demandCode,"en",{sensitivity:"base"})),de},[b,j]),Q=a.useMemo(()=>Z.reduce((c,D)=>(c.budget+=Ge(D.budget),c.utilized+=Ge(D.fundUtilized),c.pendingDemands+=Ge(D.pendingDemands),c.balance+=Ge(D.balance),c),{budget:0,utilized:0,pendingDemands:0,balance:0}),[Z]),G=a.useMemo(()=>B.reduce((c,D)=>(c.budget+=Ge(D.budget),c.utilized+=Ge(D.fundUtilized),c.pendingDemands+=Ge(D.pendingDemands),c.balance+=Ge(D.balance),c),{budget:0,utilized:0,pendingDemands:0,balance:0}),[B]),l=a.useMemo(()=>te.reduce((c,D)=>(c.budget+=D.budget,c.utilized+=D.utilized,c.balance+=D.balance,c.pendingDemands+=D.pendingDemands,c),{budget:0,utilized:0,pendingDemands:0,balance:0}),[te]),M=Q.budget,m=G.budget,y=l.budget,o=c=>(c/1).toFixed(1),ne=(c,D)=>D>0?`${(c/D*100).toFixed(1)}%`:"0%",he=(c,D)=>{console.log("Pending clicked:",{context:c,record:D})},k=a.useMemo(()=>n==="ML-MLA"?[{title:"Total MLA Budget",value:Q.budget,whole:Q.budget,color:"blue"},{title:"MLA :Disbursed Amount",value:Q.utilized,whole:Q.budget,color:"emerald"},{title:"MLA Balance Amount",value:Q.balance,whole:Q.budget,color:"amber"},{title:"MLA Pending Demands",value:Q.pendingDemands,whole:Q.budget,color:"violet"}]:n==="ML-MLC"?[{title:"Total MLC Budget",value:G.budget,whole:G.budget,color:"blue"},{title:"MLC Total Funds Disbursed",value:G.utilized,whole:G.budget,color:"emerald"},{title:"MLC Balance Budget Amount",value:G.balance,whole:G.budget,color:"amber"},{title:"Pending Demand Amount",value:G.pendingDemands,whole:G.budget,color:"violet"}]:[{title:"Total HADP Budget",value:l.budget,whole:l.budget,color:"blue"},{title:"Total Funds Approved",value:l.utilized,whole:l.budget,color:"emerald"},{title:"HADP Balance Budget",value:l.balance,whole:l.budget,color:"amber"},{title:"HADP Pending Demand Amount",value:l.pendingDemands,whole:l.budget,color:"violet"}],[n,Q,G,l]);return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"District Dashboard"}),e.jsxs("span",{className:"px-3 py-1 text-xs rounded-full bg-blue-50 text-blue-700 border border-blue-200",children:["District: ",e.jsx("b",{className:"ml-1",children:s})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-3 text-sm",children:[e.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[e.jsx(S,{className:"mb-1 block",children:"Financial Year"}),e.jsx(Lt,{value:r,onValueChange:t,options:J,placeholder:"Select Financial Year"})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[e.jsx(S,{className:"mb-1 block",children:"Plan Type"}),e.jsx(Lt,{value:n,onValueChange:c=>i(c),options:X,placeholder:"Select Plan Type"})]}),n==="ML-MLA"&&e.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[e.jsx(S,{className:"mb-1 block",children:"MLA Name"}),e.jsx(Lt,{value:x,onValueChange:g,options:A,placeholder:"Select MLA"})]}),n==="ML-MLC"&&e.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[e.jsx(S,{className:"mb-1 block",children:"MLC Name"}),e.jsx(Lt,{value:p,onValueChange:d,options:C,placeholder:"Select MLC"})]}),n==="HADP"&&e.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[e.jsx(S,{className:"mb-1 block",children:"Taluka"}),e.jsx(Lt,{value:j,onValueChange:P,options:q,placeholder:"Select Taluka"})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3",children:[e.jsxs(Ae.div,{className:"col-span-6 sm:col-span-3 lg:col-span-2 border-l-4 border-blue-600 bg-white p-3 rounded-md shadow-sm",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:[e.jsx("p",{className:"text-xs font-semibold text-blue-600 uppercase",children:"Overview"}),e.jsx("div",{className:"mt-1 text-xs space-y-0.5",children:[{label:"Total MLA Fund",val:M},{label:"Total MLC Fund",val:m},{label:"HADP",val:y}].map((c,D)=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:c.label}),e.jsxs("span",{children:["₹",o(c.val)]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("small",{className:"text-gray-500",children:ne(c.val,M+m+y)})})]},D))})]}),k.map((c,D)=>e.jsxs(Ae.div,{className:`col-span-6 sm:col-span-3 lg:col-span-1 border-l-4 border-${c.color}-500 bg-${c.color}-50 p-2 rounded-md shadow-sm cursor-pointer`,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.06*(D+1)},whileHover:{scale:1.02},onClick:()=>{String(c.title).toLowerCase().includes("pending")?T(de=>!de):T(!1)},children:[e.jsx("p",{className:`text-xs font-semibold text-${c.color}-700`,children:c.title}),e.jsx("p",{className:`mt-1 text-lg font-bold text-${c.color}-900`,children:String(c.title).toLowerCase().includes("pending")?c.value:`₹${o(c.value)}`}),e.jsx("div",{className:"flex justify-end",children:e.jsx("small",{className:`text-${c.color}-700 opacity-80`,children:ne(c.value,c.whole)})})]},D))]}),n==="ML-MLA"&&e.jsxs(O,{className:"rounded-md shadow-sm",children:[e.jsx(se,{children:e.jsxs(ee,{className:"text-sm",children:["MLA Details — ",s,e.jsxs("div",{className:"flex gap-2 text-right",children:[e.jsx("span",{className:"text-[10px] text-red-500",children:"*Balance = Budget Amount - Fund Distributed |"}),e.jsx("span",{className:"text-[10px] text-red-500",children:"*Amounts In Thousand"})]})]})}),e.jsx($,{className:"overflow-x-auto p-0",children:e.jsxs(Ke,{className:"min-w-full border border-gray-300",children:[e.jsx(Be,{children:e.jsxs(ue,{children:[e.jsx(U,{className:"border px-2 py-1",children:"S.No"}),e.jsx(U,{className:"border px-2 py-1",children:"MLA Name"}),e.jsx(U,{className:"border px-2 py-1",children:"Assembly Constituency"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Budgeted Amount"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Funds Disbursed"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Balance Funds"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Pending Demands"})]})}),e.jsxs(We,{children:[Z.map((c,D)=>e.jsxs(ue,{children:[e.jsx(h,{className:"border px-2 py-1 text-xs",children:D+1}),e.jsx(h,{className:"border px-2 py-1 text-xs",children:c.name}),e.jsx(h,{className:"border px-2 py-1 text-xs",children:c.taluka}),e.jsx(h,{className:"border px-2 py-1 text-right",children:o(Ge(c.budget))}),e.jsx(h,{className:"border px-2 py-1 text-right",children:o(Ge(c.fundUtilized))}),e.jsx(h,{className:"border px-2 py-1 text-right",children:o(Ge(c.balance))}),e.jsx(h,{className:"border px-2 py-1 text-right",children:e.jsx(L,{variant:"link",className:"text-blue-600 underline p-0 h-auto",onClick:()=>he("ML-MLA",c),children:o(Ge(c.pendingDemands))})})]},`${c.name}|${D}`)),Z.length===0&&e.jsx(ue,{children:e.jsx(h,{className:"border px-2 py-6 text-center text-sm text-gray-500",colSpan:7,children:"No records."})})]}),e.jsx(js,{children:e.jsxs(ue,{children:[e.jsx(h,{colSpan:3,className:"border px-2 py-1 font-semibold",children:"Total"}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:Q.budget.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:Q.utilized.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:Q.balance.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:Q.pendingDemands.toLocaleString()})]})})]})})]}),n==="ML-MLC"&&e.jsxs(O,{className:"rounded-md shadow-sm",children:[e.jsx(se,{children:e.jsxs(ee,{className:"text-sm",children:["MLC Details — ",s,e.jsxs("div",{className:"flex gap-2 text-right",children:[e.jsx("span",{className:"text-[10px] text-red-500",children:"*Balance = Budget Amount - Fund Distributed |"}),e.jsx("span",{className:"text-[10px] text-red-500",children:"*Amounts In Thousand"})]})]})}),e.jsx($,{className:"overflow-x-auto p-0",children:e.jsxs(Ke,{className:"min-w-full border border-gray-300",children:[e.jsx(Be,{children:e.jsxs(ue,{children:[e.jsx(U,{className:"border px-2 py-1",children:"Sr No"}),e.jsx(U,{className:"border px-2 py-1",children:"MLC NAME"}),e.jsx(U,{className:"border px-2 py-1",children:"Nodal District"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Budget Amount"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Total funds disbursed"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Balance Funds"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Pending Demands"})]})}),e.jsxs(We,{children:[B.map((c,D)=>e.jsxs(ue,{children:[e.jsx(h,{className:"border px-2 py-1 text-xs",children:D+1}),e.jsx(h,{className:"border px-2 py-1 text-xs",children:c.name}),e.jsx(h,{className:"border px-2 py-1 text-xs",children:c.district}),e.jsx(h,{className:"border px-2 py-1 text-right",children:o(Ge(c.budget))}),e.jsx(h,{className:"border px-2 py-1 text-right",children:o(Ge(c.fundUtilized))}),e.jsx(h,{className:"border px-2 py-1 text-right",children:o(Ge(c.balance))}),e.jsx(h,{className:"border px-2 py-1 text-right",children:e.jsx(L,{variant:"link",className:"text-blue-600 underline p-0 h-auto",onClick:()=>he("ML-MLC",c),children:o(Ge(c.pendingDemands))})})]},`${c.name}|${D}`)),B.length===0&&e.jsx(ue,{children:e.jsx(h,{className:"border px-2 py-6 text-center text-sm text-gray-500",colSpan:7,children:"No records."})})]}),e.jsx(js,{children:e.jsxs(ue,{children:[e.jsx(h,{colSpan:3,className:"border px-2 py-1 font-semibold",children:"Total"}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:G.budget.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:G.utilized.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:G.balance.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:G.pendingDemands.toLocaleString()})]})})]})})]}),n==="HADP"&&e.jsxs(O,{className:"rounded-md shadow-sm",children:[e.jsx(se,{children:e.jsxs(ee,{className:"text-sm",children:["HADP Summary — ",s," ",e.jsx("span",{className:"text-xs text-red-300 italic",children:"*Amounts In Thousands"})]})}),e.jsx($,{className:"overflow-x-auto p-0",children:e.jsxs(Ke,{className:"min-w-full border border-gray-300",children:[e.jsx(Be,{children:e.jsxs(ue,{children:[e.jsx(U,{className:"border px-2 py-1",children:"S.No"}),e.jsx(U,{className:"border px-2 py-1",children:"Taluka / Demand Code"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Budget Amount"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Disbursed Amount"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Balance Amount"}),e.jsx(U,{className:"border px-2 py-1 text-right",children:"Pending Demand Amount"})]})}),e.jsxs(We,{children:[te.map((c,D)=>e.jsxs(ue,{children:[e.jsx(h,{className:"border px-2 py-1 text-xs",children:D+1}),e.jsx(h,{className:"border px-2 py-1 text-xs",children:c.demandCode}),e.jsx(h,{className:"border px-2 py-1 text-right",children:o(c.budget)}),e.jsx(h,{className:"border px-2 py-1 text-right",children:o(c.utilized)}),e.jsx(h,{className:"border px-2 py-1 text-right",children:o(c.balance)}),e.jsx(h,{className:"border px-2 py-1 text-right",children:e.jsx(L,{variant:"link",className:"text-blue-600 underline p-0 h-auto",onClick:()=>he("HADP",c),children:o(c.pendingDemands)})})]},c.demandCode)),te.length===0&&e.jsx(ue,{children:e.jsx(h,{className:"border px-2 py-6 text-center text-sm text-gray-500",colSpan:6,children:"No records."})})]}),e.jsx(js,{children:e.jsxs(ue,{children:[e.jsx(h,{colSpan:2,className:"border px-2 py-1 font-semibold",children:"Total"}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:l.budget.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:l.utilized.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:l.balance.toLocaleString()}),e.jsx(h,{className:"border px-2 py-1 text-right font-semibold",children:l.pendingDemands.toLocaleString()})]})})]})})]})]})};function _i(){const{user:s}=Cs(),{toast:r}=os(),[t,n]=a.useState([]),[i,x]=a.useState(!1),[g,p]=a.useState({fullname:"",username:"",email:"",designation:"",password:"",mobile:"",agencyCode:""}),[d,j]=a.useState(""),[P,W]=a.useState(!1),[T,J]=a.useState(!1),X=async()=>{try{W(!0);const b="http://13.202.62.178:9090/backend-dfds",A=localStorage.getItem("token"),C=await me.get(`${b}/api/user/ia`,{headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"}});n(C.data||[])}catch(b){console.error("Error fetching IA users:",b),r({title:"Error",description:"Failed to fetch IA users",variant:"destructive"})}finally{W(!1)}};a.useEffect(()=>{X()},[]);const w=b=>{const{name:A,value:C}=b.target;p(q=>({...q,[A]:C})),j("")},V=()=>g.fullname.trim()?g.username.trim()?g.email.trim()?g.designation.trim()?g.password.trim()?g.password.length<6?(j("Password must be at least 6 characters long."),!1):g.mobile.trim()?/^\d{10}$/.test(g.mobile)?g.agencyCode.trim()?!0:(j("Agency code is required."),!1):(j("Mobile number must be 10 digits."),!1):(j("Mobile number is required."),!1):(j("Password is required."),!1):(j("Designation is required."),!1):(j("Email is required."),!1):(j("Username is required."),!1):(j("Full name is required."),!1),F=async()=>{var b,A;if(V())try{J(!0),j("");const C="http://13.202.62.178:9090/backend-dfds",q=localStorage.getItem("token"),Z={fullname:g.fullname.trim(),username:g.username.trim(),email:g.email.trim(),designation:g.designation.trim(),password:g.password,mobile:parseInt(g.mobile),agencyCode:g.agencyCode.trim(),role:"IA_ADMIN",districtId:(s==null?void 0:s.districtId)||0},B=await me.post(`${C}/api/user/ia`,Z,{headers:{Authorization:`Bearer ${q}`,"Content-Type":"application/json"}});r({title:"Success",description:"IA user created successfully",variant:"default"}),p({fullname:"",username:"",email:"",designation:"",password:"",mobile:"",agencyCode:""}),x(!1),X()}catch(C){console.error("Error creating IA user:",C);const q=((A=(b=C.response)==null?void 0:b.data)==null?void 0:A.message)||"Failed to create IA user";j(q),r({title:"Error",description:q,variant:"destructive"})}finally{J(!1)}},N=async b=>{if(confirm("Are you sure you want to delete this IA user?"))try{const A="http://13.202.62.178:9090/backend-dfds",C=localStorage.getItem("token");await me.delete(`${A}/api/user/ia/${b}`,{headers:{Authorization:`Bearer ${C}`,"Content-Type":"application/json"}}),r({title:"Success",description:"IA user deleted successfully",variant:"default"}),X()}catch(A){console.error("Error deleting IA user:",A),r({title:"Error",description:"Failed to delete IA user",variant:"destructive"})}};return P?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"w-6 h-6 animate-spin text-blue-600"}),e.jsx("span",{className:"text-lg font-medium text-gray-600",children:"Loading IA users..."})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(ee,{className:"text-2xl font-semibold",children:"Implementing Agency Master"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Create and manage IA user accounts"})]}),e.jsxs(L,{size:"sm",onClick:()=>x(!0),disabled:T,children:[e.jsx(ps,{className:"mr-1 h-4 w-4"})," Add IA User"]})]}),e.jsx(O,{className:"border border-gray-300 rounded-lg shadow-sm",children:e.jsx($,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full table-auto border-collapse border border-gray-300",children:[e.jsx(Be,{children:e.jsx(ue,{className:"bg-gray-100",children:["Sr No","Full Name","Username","Email","Designation","Mobile","Agency Code","Status","Actions"].map((b,A)=>e.jsx(U,{className:"border border-gray-200 px-4 py-2 text-left text-xs font-semibold text-gray-700",children:b},A))})}),e.jsxs(We,{children:[t.map((b,A)=>e.jsxs(ue,{className:A%2===0?"bg-white":"bg-gray-50",children:[e.jsx(h,{className:"border border-gray-200 px-4 py-2 text-sm",children:A+1}),e.jsx(h,{className:"border border-gray-200 px-4 py-2 text-sm",children:b.fullname}),e.jsx(h,{className:"border border-gray-200 px-4 py-2 text-sm",children:b.username}),e.jsx(h,{className:"border border-gray-200 px-4 py-2 text-sm",children:b.email}),e.jsx(h,{className:"border border-gray-200 px-4 py-2 text-sm",children:b.designation}),e.jsx(h,{className:"border border-gray-200 px-4 py-2 text-sm",children:b.mobile}),e.jsx(h,{className:"border border-gray-200 px-4 py-2 text-sm",children:b.agencyCode}),e.jsx(h,{className:"border border-gray-200 px-4 py-2 text-sm",children:e.jsx(ye,{className:b.status==="ACTIVE"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:b.status||"ACTIVE"})}),e.jsxs(h,{className:"border border-gray-200 px-4 py-2 text-sm space-x-2",children:[e.jsx(L,{size:"icon",variant:"ghost",children:e.jsx(Re,{className:"h-5 w-5 text-blue-600"})}),b.id&&e.jsx(L,{size:"icon",variant:"ghost",onClick:()=>N(b.id),children:e.jsx(Os,{className:"h-5 w-5 text-red-600"})})]})]},b.id||A)),t.length===0&&e.jsx(ue,{children:e.jsx(h,{colSpan:9,className:"border border-gray-200 py-6 text-center text-gray-500",children:"No IA users found."})})]})]})})})}),e.jsx(ts,{open:i,onOpenChange:x,children:e.jsxs(Ze,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(as,{children:[e.jsx(rs,{children:"Add IA User"}),e.jsx("button",{onClick:()=>x(!1),className:"absolute top-4 right-4",children:e.jsx(fs,{className:"h-5 w-5 text-gray-500 hover:text-red-600"})})]}),e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(_,{name:"fullname",value:g.fullname,onChange:w,placeholder:"Enter full name",disabled:T})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Username ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(_,{name:"username",value:g.username,onChange:w,placeholder:"Enter username",disabled:T})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(_,{name:"email",type:"email",value:g.email,onChange:w,placeholder:"Enter email address",disabled:T})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Designation ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(_,{name:"designation",value:g.designation,onChange:w,placeholder:"Enter designation",disabled:T})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Mobile Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(_,{name:"mobile",value:g.mobile,onChange:w,placeholder:"Enter 10-digit mobile number",maxLength:10,disabled:T})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Agency Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(_,{name:"agencyCode",value:g.agencyCode,onChange:w,placeholder:"Enter agency code",disabled:T})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(_,{name:"password",type:"password",value:g.password,onChange:w,placeholder:"Enter password (minimum 6 characters)",disabled:T})]}),e.jsx("div",{className:"sm:col-span-2",children:e.jsx("div",{className:"bg-blue-50 p-3 rounded-md",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(us,{className:"w-4 h-4 text-blue-600"}),e.jsxs("span",{className:"text-xs text-blue-700",children:["District ID will be automatically set to: ",e.jsx("strong",{children:(s==null?void 0:s.districtName)||"Current logged-in district"})]})]})})})]}),d&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(us,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"text-xs text-red-700",children:d})]})}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(L,{variant:"outline",onClick:()=>x(!1),disabled:T,children:"Cancel"}),e.jsx(L,{onClick:F,disabled:T,children:T?e.jsxs(e.Fragment,{children:[e.jsx(Le,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):"Create IA User"})]})]})]})})]})}const Fa=a.forwardRef(({className:s,...r},t)=>e.jsx(tn,{ref:t,className:ie("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...r,children:e.jsx(fl,{className:ie("flex items-center justify-center text-current"),children:e.jsx(ws,{className:"h-4 w-4"})})}));Fa.displayName=tn.displayName;const qi=()=>{var Pe,ns,Se,et,st;const{toast:s}=os(),[r,t]=a.useState([]),[n,i]=a.useState([]),[x,g]=a.useState([]),[p,d]=a.useState([]),[j,P]=a.useState([]),[W,T]=a.useState([]),[J,X]=a.useState([]),[w,V]=a.useState([]),[F,N]=a.useState([]),[b,A]=a.useState([]),[C,q]=a.useState({financialYearId:null,districtId:null,constituencyId:null,talukaId:null,schemeId:null,selectedMLAs:[],selectedMLCs:[],allocatedLimit:"",remarks:"",mlaSelectionMode:"direct"}),[Z,B]=a.useState(!0),[te,Q]=a.useState(!1),[G,l]=a.useState(!1),[M,m]=a.useState(!1),[y,o]=a.useState("MLA"),[ne,he]=a.useState("All"),[k,c]=a.useState("All"),[D,de]=a.useState(null),[I,H]=a.useState(!1),[oe,pe]=a.useState(!1),[E,R]=a.useState(!1),[z,re]=a.useState(!1),[xe,Ee]=a.useState(null),De=async()=>{try{const u="http://13.202.62.178:9090/backend-dfds",Y=localStorage.getItem("token"),be=await me.get(`${u}/api/dropdown/financial-years`,{headers:{Authorization:`Bearer ${Y}`,"Content-Type":"application/json"}});t(be.data||[])}catch(u){console.error("Error fetching financial years:",u),s({title:"Error",description:"Failed to fetch financial years",variant:"destructive"})}},Fe=async()=>{try{const u="http://13.202.62.178:9090/backend-dfds",Y=localStorage.getItem("token"),be=await me.get(`${u}/api/dropdown/districts`,{headers:{Authorization:`Bearer ${Y}`,"Content-Type":"application/json"}});i(be.data||[])}catch(u){console.error("Error fetching districts:",u),s({title:"Error",description:"Failed to fetch districts",variant:"destructive"})}},ms=async()=>{try{const u="http://13.202.62.178:9090/backend-dfds",Y=localStorage.getItem("token"),be=await me.get(`${u}/api/dropdown/schemes`,{headers:{Authorization:`Bearer ${Y}`,"Content-Type":"application/json"}});P(be.data||[])}catch(u){console.error("Error fetching schemes:",u),s({title:"Error",description:"Failed to fetch schemes",variant:"destructive"})}},Ye=async u=>{try{Q(!0);const Y="http://13.202.62.178:9090/backend-dfds",be=localStorage.getItem("token"),Me=await me.get(`${Y}/api/dropdown/constituencies/by-district/${u}`,{headers:{Authorization:`Bearer ${be}`,"Content-Type":"application/json"}});g(Me.data||[])}catch(Y){console.error("Error fetching constituencies:",Y),s({title:"Error",description:"Failed to fetch constituencies",variant:"destructive"}),g([])}finally{Q(!1)}},Te=async u=>{try{l(!0);const Y="http://13.202.62.178:9090/backend-dfds",be=localStorage.getItem("token"),Me=await me.get(`${Y}/api/dropdown/talukas/by-district/${u}`,{headers:{Authorization:`Bearer ${be}`,"Content-Type":"application/json"}});d(Me.data||[])}catch(Y){console.error("Error fetching talukas:",Y),s({title:"Error",description:"Failed to fetch talukas",variant:"destructive"}),d([])}finally{l(!1)}},xs=async u=>{try{const Y="http://13.202.62.178:9090/backend-dfds",be=localStorage.getItem("token"),Oe=((await me.get(`${Y}/api/admin/mlas/by-district/${u}`,{headers:{Authorization:`Bearer ${be}`,"Content-Type":"application/json"}})).data||[]).map(Xe=>({id:Xe.id,mlaName:Xe.mlaName,party:Xe.party,constituencyName:Xe.constituencyName,constituencyId:Xe.constituencyId,districtName:Xe.districtName,status:Xe.status}));T(Oe)}catch(Y){console.error("Error fetching MLAs by district:",Y),s({title:"Error",description:"Failed to fetch MLAs for selected district",variant:"destructive"}),T([])}},He=async()=>{try{const u="http://13.202.62.178:9090/backend-dfds",Y=localStorage.getItem("token"),Me=((await me.get(`${u}/api/admin/mlc`,{headers:{Authorization:`Bearer ${Y}`,"Content-Type":"application/json"}})).data||[]).map(Oe=>({id:Oe.id,mlcName:Oe.mlcName,category:Oe.category,region:Oe.region,status:Oe.status}));X(Me)}catch(u){console.error("Error fetching MLCs:",u),s({title:"Error",description:"Failed to fetch MLCs",variant:"destructive"})}},Ue=async u=>{try{const Y="http://13.202.62.178:9090/backend-dfds",be=localStorage.getItem("token");if(!be){s({title:"Error",description:"Authentication token not found",variant:"destructive"});return}const Me=u?{financialYearId:u}:{},Oe=await me.get(`${Y}/api/mla-budget/fetch`,{headers:{Authorization:`Bearer ${be}`,"Content-Type":"application/json"},params:Me});V(Oe.data||[])}catch(Y){console.error("Error fetching MLA budgets:",Y),s({title:"Error",description:"Failed to fetch MLA budgets",variant:"destructive"})}},Je=async u=>{try{const Y="http://13.202.62.178:9090/backend-dfds",be=localStorage.getItem("token");if(!be){s({title:"Error",description:"Authentication token not found",variant:"destructive"});return}const Me=u?{financialYearId:u}:{},Oe=await me.get(`${Y}/api/mlc-budget/getMLCBudgets`,{headers:{Authorization:`Bearer ${be}`,"Content-Type":"application/json"},params:Me});N(Oe.data||[])}catch(Y){console.error("Error fetching MLC budgets:",Y),s({title:"Error",description:"Failed to fetch MLC budgets",variant:"destructive"})}},$e=async()=>{try{const u="http://13.202.62.178:9090/backend-dfds",Y=localStorage.getItem("token"),be=await me.get(`${u}/api/hadp-budget/fetch`,{headers:{Authorization:`Bearer ${Y}`,"Content-Type":"application/json"}});A(be.data||[])}catch(u){console.error("Error fetching HADP budgets:",u),s({title:"Error",description:"Failed to fetch HADP budgets",variant:"destructive"})}},Ss=u=>{const Y=parseInt(u);q(be=>({...be,districtId:Y,constituencyId:null,talukaId:null,selectedMLAs:[],selectedMLCs:[]})),Y?y==="MLA"?(Ye(Y),xs(Y)):y==="HADP"&&Te(Y):(g([]),d([]),T([]),X([]))},Bs=(u,Y)=>{q(be=>({...be,selectedMLAs:Y?[...be.selectedMLAs,u]:be.selectedMLAs.filter(Me=>Me!==u)}))},Ws=(u,Y)=>{q(be=>({...be,selectedMLCs:Y?[...be.selectedMLCs,u]:be.selectedMLCs.filter(Me=>Me!==u)}))},ks=(u,Y)=>{Ee(u),Y==="MLA"?H(!0):Y==="MLC"?pe(!0):Y==="HADP"&&R(!0)},Is=async u=>{var Y,be;if(!xe||!C.allocatedLimit){s({title:"Validation Error",description:"Please enter an allocated limit",variant:"destructive"});return}try{m(!0);const Me="http://13.202.62.178:9090/backend-dfds",Oe=localStorage.getItem("token"),Xe=parseFloat(C.allocatedLimit);u==="MLA"?(await me.put(`${Me}/api/mla-budget/update/${xe.id}`,{allocatedLimit:Xe},{headers:{Authorization:`Bearer ${Oe}`,"Content-Type":"application/json"}}),await Ue(D||void 0),H(!1)):u==="MLC"?(await me.put(`${Me}/api/mlc-budget/update/${xe.id}`,{allocatedLimit:Xe},{headers:{Authorization:`Bearer ${Oe}`,"Content-Type":"application/json"}}),await Je(D||void 0),pe(!1)):u==="HADP"&&(await me.put(`${Me}/api/hadp-budget/update/${xe.id}`,{allocatedLimit:Xe},{headers:{Authorization:`Bearer ${Oe}`,"Content-Type":"application/json"}}),await $e(),R(!1)),s({title:"Success",description:`${u} budget updated successfully`,variant:"default"}),Ee(null),q(At=>({...At,allocatedLimit:""}))}catch(Me){console.error("Error updating budget:",Me);const Oe=((be=(Y=Me.response)==null?void 0:Y.data)==null?void 0:be.message)||"Failed to update budget";s({title:"Error",description:Oe,variant:"destructive"})}finally{m(!1)}},Ys=async()=>{var u,Y;if(!C.financialYearId||!C.districtId||!C.allocatedLimit||!C.schemeId||C.districtId===0||C.financialYearId===0){if(y==="MLA"&&C.mlaSelectionMode==="constituency"&&!C.constituencyId){s({title:"Validation Error",description:"Please select a constituency for MLA budget allocation",variant:"destructive"});return}s({title:"Validation Error",description:"Please fill all required fields (Financial Year, District, Scheme, Allocated Limit)",variant:"destructive"});return}if(y==="MLA"&&C.selectedMLAs.length===0){s({title:"Validation Error",description:"Please select at least one MLA",variant:"destructive"});return}if(y==="MLC"&&C.selectedMLCs.length===0){s({title:"Validation Error",description:"Please select at least one MLC",variant:"destructive"});return}if(y==="HADP"&&!C.talukaId){s({title:"Validation Error",description:"Please select a taluka for HADP allocation",variant:"destructive"});return}try{m(!0);const be="http://13.202.62.178:9090/backend-dfds",Me=localStorage.getItem("token"),Oe=parseFloat(C.allocatedLimit);if(y==="MLA"){const Xe=C.selectedMLAs.map(At=>{const oa={financialYearId:C.financialYearId,mlaId:At,constituencyId:C.constituencyId,allocatedLimit:Oe,remarks:C.remarks,schemeId:C.schemeId};return me.post(`${be}/api/mla-budget/save`,oa,{headers:{Authorization:`Bearer ${Me}`,"Content-Type":"application/json"}})});await Promise.all(Xe),await Ue(D||void 0),s({title:"Success",description:`Budget allocated to ${C.selectedMLAs.length} MLA(s) successfully`,variant:"default"})}else if(y==="MLC"){const Xe=C.selectedMLCs.map(At=>{const oa={financialYearId:C.financialYearId,mlcId:At,schemeId:C.schemeId,allocatedLimit:Oe,remarks:C.remarks};return me.post(`${be}/api/mlc-budget/saveMLCBudget`,oa,{headers:{Authorization:`Bearer ${Me}`,"Content-Type":"application/json"}})});await Promise.all(Xe),await Je(D||void 0),s({title:"Success",description:`Budget allocated to ${C.selectedMLCs.length} MLC(s) successfully`,variant:"default"})}else if(y==="HADP"){const Xe={schemeId:C.schemeId,districtId:C.districtId,talukaId:C.talukaId,financialYearId:C.financialYearId,allocatedLimit:Oe,remarks:C.remarks};await me.post(`${be}/api/hadp-budget/allocate`,Xe,{headers:{Authorization:`Bearer ${Me}`,"Content-Type":"application/json"}}),await $e(),s({title:"Success",description:"HADP budget allocated successfully",variant:"default"})}q({financialYearId:null,districtId:null,constituencyId:null,talukaId:null,schemeId:null,selectedMLAs:[],selectedMLCs:[],allocatedLimit:"",remarks:"",mlaSelectionMode:"direct"}),g([]),d([]),re(!1)}catch(be){console.error("Error allocating budget:",be);const Me=((Y=(u=be.response)==null?void 0:u.data)==null?void 0:Y.message)||"Failed to allocate budget";s({title:"Error",description:Me,variant:"destructive"})}finally{m(!1)}};a.useMemo(()=>{let u=W;return k!=="All"&&(u=u.filter(Y=>Y.districtName===k)),u},[W,k]);const f=a.useMemo(()=>{let u=J;return k!=="All"&&(u=u.filter(Y=>Y.region===k)),u},[J,k]),K=a.useMemo(()=>{let u=w;return ne!=="All"&&(u=u.filter(Y=>Y.financialYear===ne)),k!=="All"&&(u=u.filter(Y=>Y.districtName===k)),u},[w,ne,k]),v=a.useMemo(()=>{let u=F;return ne!=="All"&&(u=u.filter(Y=>Y.financialYear===ne)),k!=="All"&&(u=u.filter(Y=>Y.districtName===k)),u},[F,ne,k]),le=a.useMemo(()=>{let u=b;return ne!=="All"&&(u=u.filter(Y=>Y.financialYear===ne)),k!=="All"&&(u=u.filter(Y=>Y.districtName===k)),u},[b,ne,k]),ce=a.useMemo(()=>{const u=[...w.map(Y=>Y.financialYear),...F.map(Y=>Y.financialYear),...b.map(Y=>Y.financialYear)];return["All",...Array.from(new Set(u)).sort()]},[w,F,b]),ve=a.useMemo(()=>{const u=[...w.map(Y=>Y.districtName),...F.map(Y=>Y.districtName),...b.map(Y=>Y.districtName)];return["All",...Array.from(new Set(u)).sort()]},[w,F,b]);return a.useEffect(()=>{(async()=>{B(!0),await Promise.all([De(),Fe(),ms(),He(),$e()]),B(!1)})()},[]),Z?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"w-6 h-6 animate-spin text-blue-600"}),e.jsx("span",{className:"text-lg font-medium text-gray-600",children:"Loading budget allocation data..."})]})}):e.jsxs("div",{className:"p-6 space-y-6 bg-gray-50",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Budget Allocation"}),e.jsx("p",{className:"text-gray-600",children:"Allocate budgets to MLAs, MLCs, and HADP"})]}),e.jsxs(L,{variant:"outline",onClick:async()=>{B(!0),await Promise.all([De(),Fe(),ms(),He(),$e()]),D&&await Promise.all([Ue(D),Je(D)]),B(!1)},className:"flex items-center px-4 py-2 rounded-sm shadow",children:[e.jsx(Le,{className:"mr-2 h-4 w-4"})," Refresh All"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[e.jsx(Ae.div,{className:"border border-gray-200 rounded-sm bg-white p-4 shadow-sm",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:0},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Ns,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Allocations"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:K.length+v.length+le.length})]})]})}),e.jsx(Ae.div,{className:"border border-gray-200 rounded-sm bg-white p-4 shadow-sm",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Pt,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"MLA Allocations"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:K.length})]})]})}),e.jsx(Ae.div,{className:"border border-gray-200 rounded-sm bg-white p-4 shadow-sm",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(Et,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"MLC Allocations"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:v.length})]})]})}),e.jsx(Ae.div,{className:"border border-gray-200 rounded-sm bg-white p-4 shadow-sm",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(us,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"HADP Allocations"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:le.length})]})]})})]}),e.jsxs(O,{className:"border border-gray-200 rounded-sm shadow-sm",children:[e.jsx(se,{children:e.jsx(ee,{className:"text-lg",children:"Select Plan Type"})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(L,{variant:y==="MLA"?"default":"outline",onClick:()=>o("MLA"),className:"w-full",children:"MLA Budget Allocation"}),e.jsx(L,{variant:y==="MLC"?"default":"outline",onClick:()=>o("MLC"),className:"w-full",children:"MLC Budget Allocation"}),e.jsx(L,{variant:y==="HADP"?"default":"outline",onClick:()=>o("HADP"),className:"w-full",children:"HADP Budget Allocation"})]})})]}),e.jsxs(O,{className:"border border-gray-200 rounded-sm shadow-sm",children:[e.jsx(se,{children:e.jsx(ee,{className:"text-lg",children:"Budget Management"})}),e.jsx($,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-gray-600",children:"Add new budget allocations for the selected plan type"}),e.jsxs(L,{onClick:()=>re(!0),className:"px-6",children:[e.jsx(ps,{className:"w-4 h-4 mr-2"}),"Add Budget"]})]})})]}),e.jsxs(O,{className:"border border-gray-200 rounded-sm shadow-sm",children:[e.jsx(se,{children:e.jsx(ee,{className:"text-lg",children:"Filter Budget Data"})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{children:"Financial Year"}),e.jsxs(Ne,{value:ne,onValueChange:he,children:[e.jsx(je,{children:e.jsx(fe,{})}),e.jsx(ge,{children:ce.map(u=>e.jsx(ae,{value:u,children:u},u))})]})]}),e.jsxs("div",{children:[e.jsx(S,{children:"District"}),e.jsxs(Ne,{value:k,onValueChange:c,children:[e.jsx(je,{children:e.jsx(fe,{})}),e.jsx(ge,{children:ve.map(u=>e.jsx(ae,{value:u,children:u},u))})]})]})]})})]}),e.jsxs(O,{className:"border border-gray-200 rounded-sm shadow-sm overflow-hidden",children:[e.jsx(se,{children:e.jsx(ee,{className:"text-lg",children:"Budget Allocation History"})}),e.jsx($,{className:"p-0 overflow-x-auto",children:e.jsxs(Ke,{children:[e.jsx(Be,{children:e.jsxs(ue,{children:[e.jsx(U,{children:"Type"}),e.jsx(U,{children:"Name"}),e.jsx(U,{children:"Financial Year"}),e.jsx(U,{children:"District"}),e.jsx(U,{children:"Constituency/Taluka"}),e.jsx(U,{children:"Scheme"}),e.jsx(U,{children:"Allocated Limit"}),e.jsx(U,{children:"Remarks"}),e.jsx(U,{children:"Status"}),e.jsx(U,{children:"Created"}),e.jsx(U,{children:"Actions"})]})}),e.jsxs(We,{children:[K.map(u=>e.jsxs(ue,{children:[e.jsx(h,{children:e.jsx(ye,{className:"bg-green-100 text-green-800",children:"MLA"})}),e.jsx(h,{className:"font-medium",children:u.mlaName}),e.jsx(h,{children:u.financialYear}),e.jsx(h,{children:u.districtName}),e.jsx(h,{children:u.constituencyName}),e.jsx(h,{children:u.schemeName}),e.jsxs(h,{children:["₹",u.allocatedLimit.toLocaleString()]}),e.jsx(h,{children:u.remarks||"-"}),e.jsx(h,{children:e.jsx(ye,{className:u.status==="ACTIVE"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:u.status})}),e.jsx(h,{children:new Date(u.createdAt).toLocaleDateString()}),e.jsx(h,{children:e.jsx(L,{variant:"outline",size:"sm",onClick:()=>ks(u,"MLA"),className:"h-8 w-8 p-0",children:e.jsx(Vs,{className:"h-4 w-4"})})})]},`mla-${u.id}`)),v.map(u=>e.jsxs(ue,{children:[e.jsx(h,{children:e.jsx(ye,{className:"bg-purple-100 text-purple-800",children:"MLC"})}),e.jsx(h,{className:"font-medium",children:u.mlcName}),e.jsx(h,{children:u.financialYear}),e.jsx(h,{children:u.districtName}),e.jsx(h,{children:"-"}),e.jsx(h,{children:u.schemeName}),e.jsxs(h,{children:["₹",u.allocatedLimit.toLocaleString()]}),e.jsx(h,{children:u.remarks||"-"}),e.jsx(h,{children:e.jsx(ye,{className:u.status==="ACTIVE"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:u.status})}),e.jsx(h,{children:new Date(u.createdAt).toLocaleDateString()}),e.jsx(h,{children:e.jsx(L,{variant:"outline",size:"sm",onClick:()=>ks(u,"MLC"),className:"h-8 w-8 p-0",children:e.jsx(Vs,{className:"h-4 w-4"})})})]},`mlc-${u.id}`)),le.map(u=>e.jsxs(ue,{children:[e.jsx(h,{children:e.jsx(ye,{className:"bg-orange-100 text-orange-800",children:"HADP"})}),e.jsx(h,{className:"font-medium",children:u.talukaName}),e.jsx(h,{children:u.financialYear}),e.jsx(h,{children:u.districtName}),e.jsx(h,{children:u.talukaName}),e.jsx(h,{children:u.schemeName}),e.jsxs(h,{children:["₹",u.allocatedLimit.toLocaleString()]}),e.jsx(h,{children:u.remarks||"-"}),e.jsx(h,{children:e.jsx(ye,{className:u.status==="ACTIVE"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:u.status})}),e.jsx(h,{children:new Date(u.createdAt).toLocaleDateString()}),e.jsx(h,{children:e.jsx(L,{variant:"outline",size:"sm",onClick:()=>ks(u,"HADP"),className:"h-8 w-8 p-0",children:e.jsx(Vs,{className:"h-4 w-4"})})})]},`hadp-${u.id}`)),K.length===0&&v.length===0&&le.length===0&&e.jsx(ue,{children:e.jsx(h,{colSpan:11,className:"text-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(Ns,{className:"w-8 h-8 text-gray-400"}),e.jsx("p",{className:"text-gray-500",children:"No budget allocations found"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Try adjusting your filters"})]})})})]})]})})]}),e.jsx(ts,{open:I,onOpenChange:H,children:e.jsxs(Ze,{children:[e.jsx(as,{children:e.jsx(rs,{children:"Edit MLA Budget"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{children:"MLA Name"}),e.jsx(_,{value:(xe==null?void 0:xe.mlaName)||"",disabled:!0})]}),e.jsxs("div",{children:[e.jsx(S,{children:"Financial Year"}),e.jsx(_,{value:(xe==null?void 0:xe.financialYear)||"",disabled:!0})]}),e.jsxs("div",{children:[e.jsx(S,{children:"District"}),e.jsx(_,{value:(xe==null?void 0:xe.districtName)||"",disabled:!0})]}),e.jsxs("div",{children:[e.jsx(S,{children:"Constituency"}),e.jsx(_,{value:(xe==null?void 0:xe.constituencyName)||"",disabled:!0})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"allocatedLimit",children:"Allocated Limit (₹) *"}),e.jsx(_,{id:"allocatedLimit",type:"number",value:C.allocatedLimit,onChange:u=>q(Y=>({...Y,allocatedLimit:u.target.value})),placeholder:"Enter new allocated limit"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(L,{variant:"outline",onClick:()=>H(!1),children:"Cancel"}),e.jsxs(L,{onClick:()=>Is("MLA"),disabled:M,children:[M?e.jsx(Le,{className:"w-4 h-4 mr-2 animate-spin"}):null,"Update Budget"]})]})]})]})}),e.jsx(ts,{open:oe,onOpenChange:pe,children:e.jsxs(Ze,{children:[e.jsx(as,{children:e.jsx(rs,{children:"Edit MLC Budget"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{children:"MLC Name"}),e.jsx(_,{value:(xe==null?void 0:xe.mlcName)||"",disabled:!0})]}),e.jsxs("div",{children:[e.jsx(S,{children:"Financial Year"}),e.jsx(_,{value:(xe==null?void 0:xe.financialYear)||"",disabled:!0})]}),e.jsxs("div",{children:[e.jsx(S,{children:"District"}),e.jsx(_,{value:(xe==null?void 0:xe.districtName)||"",disabled:!0})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"allocatedLimit",children:"Allocated Limit (₹) *"}),e.jsx(_,{id:"allocatedLimit",type:"number",value:C.allocatedLimit,onChange:u=>q(Y=>({...Y,allocatedLimit:u.target.value})),placeholder:"Enter new allocated limit"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(L,{variant:"outline",onClick:()=>pe(!1),children:"Cancel"}),e.jsxs(L,{onClick:()=>Is("MLC"),disabled:M,children:[M?e.jsx(Le,{className:"w-4 h-4 mr-2 animate-spin"}):null,"Update Budget"]})]})]})]})}),e.jsx(ts,{open:E,onOpenChange:R,children:e.jsxs(Ze,{children:[e.jsx(as,{children:e.jsx(rs,{children:"Edit HADP Budget"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{children:"Taluka Name"}),e.jsx(_,{value:(xe==null?void 0:xe.talukaName)||"",disabled:!0})]}),e.jsxs("div",{children:[e.jsx(S,{children:"Financial Year"}),e.jsx(_,{value:(xe==null?void 0:xe.financialYear)||"",disabled:!0})]}),e.jsxs("div",{children:[e.jsx(S,{children:"District"}),e.jsx(_,{value:(xe==null?void 0:xe.districtName)||"",disabled:!0})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"allocatedLimit",children:"Allocated Limit (₹) *"}),e.jsx(_,{id:"allocatedLimit",type:"number",value:C.allocatedLimit,onChange:u=>q(Y=>({...Y,allocatedLimit:u.target.value})),placeholder:"Enter new allocated limit"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(L,{variant:"outline",onClick:()=>R(!1),children:"Cancel"}),e.jsxs(L,{onClick:()=>Is("HADP"),disabled:M,children:[M?e.jsx(Le,{className:"w-4 h-4 mr-2 animate-spin"}):null,"Update Budget"]})]})]})]})}),e.jsx(ts,{open:z,onOpenChange:re,children:e.jsxs(Ze,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(as,{children:e.jsxs(rs,{children:["Add Budget Allocation - ",y]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"financialYear",children:"Financial Year *"}),e.jsxs(Ne,{value:((Pe=C.financialYearId)==null?void 0:Pe.toString())||"",onValueChange:u=>q(Y=>({...Y,financialYearId:parseInt(u)})),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select financial year"})}),e.jsx(ge,{children:r&&r.length>0?r.map(u=>u&&u.id?e.jsx(ae,{value:u.id.toString(),children:u.name},u.id):null).filter(Boolean):e.jsx(ae,{value:"no-data",disabled:!0,children:"No financial years available"})})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"district",children:"District *"}),e.jsxs(Ne,{value:((ns=C.districtId)==null?void 0:ns.toString())||"",onValueChange:Ss,children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select district"})}),e.jsx(ge,{children:n&&n.length>0?n.map(u=>u&&u.id?e.jsx(ae,{value:u.id.toString(),children:u.name},u.id):null).filter(Boolean):e.jsx(ae,{value:"no-data",disabled:!0,children:"No districts available"})})]})]}),y==="MLA"&&e.jsxs("div",{children:[e.jsx(S,{htmlFor:"mlaSelectionMode",children:"MLA Selection Mode *"}),e.jsxs(Ne,{value:C.mlaSelectionMode,onValueChange:u=>q(Y=>({...Y,mlaSelectionMode:u,constituencyId:u==="direct"?null:Y.constituencyId,selectedMLAs:[]})),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select MLA selection mode"})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"direct",children:"Direct MLA Selection"}),e.jsx(ae,{value:"constituency",children:"Select by Constituency"})]})]})]}),y==="MLA"&&C.mlaSelectionMode==="constituency"&&e.jsxs("div",{children:[e.jsx(S,{htmlFor:"constituency",children:"Constituency *"}),e.jsxs(Ne,{value:((Se=C.constituencyId)==null?void 0:Se.toString())||"",onValueChange:u=>q(Y=>({...Y,constituencyId:parseInt(u),selectedMLAs:[]})),disabled:!C.districtId||te,children:[e.jsx(je,{children:e.jsx(fe,{placeholder:te?"Loading...":"Select constituency"})}),e.jsx(ge,{children:x&&x.length>0?x.map(u=>u&&u.id?e.jsx(ae,{value:u.id.toString(),children:u.name},u.id):null).filter(Boolean):e.jsx(ae,{value:"no-data",disabled:!0,children:"No constituencies available"})})]})]}),y==="HADP"&&e.jsxs("div",{children:[e.jsx(S,{htmlFor:"taluka",children:"Taluka *"}),e.jsxs(Ne,{value:((et=C.talukaId)==null?void 0:et.toString())||"",onValueChange:u=>q(Y=>({...Y,talukaId:parseInt(u)})),disabled:!C.districtId||G,children:[e.jsx(je,{children:e.jsx(fe,{placeholder:G?"Loading...":"Select taluka"})}),e.jsx(ge,{children:p&&p.length>0?p.map(u=>u&&u.id?e.jsx(ae,{value:u.id.toString(),children:u.name},u.id):null).filter(Boolean):e.jsx(ae,{value:"no-data",disabled:!0,children:"No talukas available"})})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"scheme",children:"Scheme *"}),e.jsxs(Ne,{value:((st=C.schemeId)==null?void 0:st.toString())||"",onValueChange:u=>q(Y=>({...Y,schemeId:parseInt(u)})),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select scheme"})}),e.jsx(ge,{children:j&&j.length>0?j.map((u,Y)=>{var be;return typeof u=="string"?e.jsx(ae,{value:Y.toString(),children:u},Y):u&&(u.id||u.name||u.schemeName)?e.jsx(ae,{value:((be=u.id)==null?void 0:be.toString())||Y.toString(),children:u.schemeName||u.name},u.id||Y):null}).filter(Boolean):e.jsx(ae,{value:"no-data",disabled:!0,children:"No schemes available"})})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"allocatedLimit",children:"Allocated Limit (₹) *"}),e.jsx(_,{id:"allocatedLimit",type:"number",value:C.allocatedLimit,onChange:u=>q(Y=>({...Y,allocatedLimit:u.target.value})),placeholder:"Enter allocated limit"})]})]}),y!=="HADP"&&e.jsxs("div",{children:[e.jsxs(S,{className:"text-base font-medium",children:["Select ",y==="MLA"?"MLAs":"MLCs"," *"]}),e.jsx("div",{className:"mt-2 max-h-60 overflow-y-auto border border-gray-200 rounded-md p-4",children:y==="MLA"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:W.filter(u=>C.mlaSelectionMode==="constituency"&&C.constituencyId?u.constituencyId===C.constituencyId:!0).map(u=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fa,{id:`mla-${u.id}`,checked:C.selectedMLAs.includes(u.id),onCheckedChange:Y=>Bs(u.id,Y)}),e.jsxs(S,{htmlFor:`mla-${u.id}`,className:"text-sm cursor-pointer",children:[e.jsx("div",{className:"font-medium",children:u.mlaName}),e.jsxs("div",{className:"text-xs text-gray-500",children:[u.constituencyName," • ",u.party]})]})]},u.id))}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:f.map(u=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fa,{id:`mlc-${u.id}`,checked:C.selectedMLCs.includes(u.id),onCheckedChange:Y=>Ws(u.id,Y)}),e.jsxs(S,{htmlFor:`mlc-${u.id}`,className:"text-sm cursor-pointer",children:[e.jsx("div",{className:"font-medium",children:u.mlcName}),e.jsxs("div",{className:"text-xs text-gray-500",children:[u.category," • ",u.region]})]})]},u.id))})})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"remarks",children:"Remarks"}),e.jsx(_,{id:"remarks",value:C.remarks,onChange:u=>q(Y=>({...Y,remarks:u.target.value})),placeholder:"Enter remarks (optional)"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(L,{variant:"outline",onClick:()=>re(!1),children:"Cancel"}),e.jsx(L,{onClick:Ys,disabled:M,className:"px-6",children:M?e.jsxs(e.Fragment,{children:[e.jsx(Le,{className:"w-4 h-4 mr-2 animate-spin"}),"Allocating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ps,{className:"w-4 h-4 mr-2"}),"Allocate Budget"]})})]})]})]})})]})},Ki=[{value:"DISTRICT_ADMIN",label:"District Admin"},{value:"DISTRICT_COLLECTOR",label:"District Collector"},{value:"DISTRICT_DPO",label:"District DPO"},{value:"DISTRICT_ADPO",label:"District ADPO"},{value:"DISTRICT_CHECKER",label:"District Checker"},{value:"DISTRICT_MAKER",label:"District Maker"}];function Ji(){var he,k;const{toast:s}=os(),{user:r}=Cs(),t=Tr(),[n,i]=a.useState([]),[x,g]=a.useState([]),[p,d]=a.useState([]),[j,P]=a.useState(!0),[W,T]=a.useState(!1),[J,X]=a.useState(!1),[w,V]=a.useState("All"),[F,N]=a.useState(!1),[b,A]=a.useState({fullname:"",username:"",email:"",designation:"",password:"",mobile:"",agencyCode:"",role:"DISTRICT_ADMIN",divisionId:null,districtId:null}),C=async()=>{try{const c="http://13.202.62.178:9090/backend-dfds",D=localStorage.getItem("token"),I=((await me.get(`${c}/api/dropdown/divisions`,{headers:{Authorization:`Bearer ${D}`,"Content-Type":"application/json"}})).data||[]).map(H=>({id:H.id,divisionName:H.divisionName||H.name,districts:H.districts||[]}));g(I)}catch(c){console.error("Error fetching divisions:",c),s({title:"Error",description:"Failed to fetch divisions",variant:"destructive"})}},q=async()=>{try{P(!0);const c="http://13.202.62.178:9090/backend-dfds",D=localStorage.getItem("token"),I=((await me.get(`${c}/api/user/district-staff-list`,{headers:{Authorization:`Bearer ${D}`,"Content-Type":"application/json"}})).data||[]).map(H=>({id:H.id,fullname:H.fullname,username:H.username,email:H.email,designation:H.designation,mobile:H.mobile,agencyCode:H.agencyCode,role:H.role,districtId:H.districtId,districtName:H.districtName,isActive:H.isActive!==!1,createdAt:H.createdAt||new Date().toISOString()}));i(I)}catch(c){console.error("Error fetching district users:",c),s({title:"Error",description:"Failed to fetch district users",variant:"destructive"})}finally{P(!1)}},Z=async c=>{const D=parseInt(c);A(de=>({...de,divisionId:D,districtId:null})),await B(D)},B=async c=>{try{T(!0);const D="http://13.202.62.178:9090/backend-dfds",de=localStorage.getItem("token"),H=((await me.get(`${D}/api/dropdown/districts?divisionId=${c}`,{headers:{Authorization:`Bearer ${de}`,"Content-Type":"application/json"}})).data||[]).map(oe=>({id:oe.id,districtName:oe.districtName||oe.name,divisionId:oe.divisionId}));d(H)}catch(D){console.error("Error fetching districts for division:",D),s({title:"Error",description:"Failed to fetch districts for selected division",variant:"destructive"}),d([])}finally{T(!1)}},te=c=>{A(D=>({...D,districtId:parseInt(c)}))},Q=async()=>{var c,D;try{X(!0);const de="http://13.202.62.178:9090/backend-dfds",I=localStorage.getItem("token"),H={fullname:b.fullname.trim(),username:b.username.trim(),email:b.email.trim(),designation:b.designation.trim(),password:b.password,mobile:parseInt(b.mobile),agencyCode:b.agencyCode.trim(),role:b.role,districtId:b.districtId||0};(await me.post(`${de}/api/user/district-staff`,H,{headers:{Authorization:`Bearer ${I}`,"Content-Type":"application/json"}})).data.success&&(N(!1),G(),await q(),s({title:"Success",description:"District user created successfully",variant:"default"}),setTimeout(()=>{t("/")},1500))}catch(de){console.error("Error creating district user:",de);const I=((D=(c=de.response)==null?void 0:c.data)==null?void 0:D.message)||"Failed to create district user";s({title:"Error",description:I,variant:"destructive"})}finally{X(!1)}},G=()=>{A({fullname:"",username:"",email:"",designation:"",password:"",mobile:"",agencyCode:"",role:"DISTRICT_ADMIN",divisionId:null,districtId:null}),d([])},l=(c,D)=>A(de=>({...de,[c]:D})),M=a.useMemo(()=>["All",...new Set(n.map(c=>c.role))],[n]),m=a.useMemo(()=>n.filter(c=>w==="All"?!0:c.role===w),[n,w]),y=m.length,o=m.filter(c=>c.isActive).length,ne=y-o;return a.useEffect(()=>{(async()=>{await Promise.all([C(),q()])})()},[]),j?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"w-6 h-6 animate-spin text-blue-600"}),e.jsx("span",{className:"text-lg font-medium text-gray-600",children:"Loading district users..."})]})}):e.jsxs("div",{className:"p-6 space-y-6 bg-gray-50",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"District User Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage district users and personnel"})]}),e.jsxs("div",{className:"flex gap-3 items-end",children:[e.jsxs("div",{className:"w-48",children:[e.jsx(S,{children:"Filter by Role"}),e.jsxs(Ne,{value:w,onValueChange:V,children:[e.jsx(je,{className:"h-10 bg-white text-sm rounded-sm border border-gray-300",children:e.jsx(fe,{placeholder:"All Roles"})}),e.jsx(ge,{children:M.map(c=>e.jsx(ae,{value:c,children:c},c))})]})]}),e.jsxs(L,{variant:"outline",onClick:async()=>{await Promise.all([C(),q()]),d([])},className:"flex items-center px-4 py-2 rounded-sm shadow",children:[e.jsx(Le,{className:"mr-2 h-4 w-4"})," Refresh All"]}),e.jsxs(ts,{open:F,onOpenChange:N,children:[e.jsx(gt,{asChild:!0,children:e.jsxs(L,{className:"flex items-center px-4 py-2 rounded-sm shadow",children:[e.jsx(ps,{className:"mr-2 h-4 w-4"})," Add User"]})}),e.jsxs(Ze,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(as,{children:e.jsx(rs,{children:"Add New District User"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"fullname",children:"Full Name *"}),e.jsx(_,{id:"fullname",value:b.fullname,onChange:c=>l("fullname",c.target.value),placeholder:"Enter full name"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"username",children:"Username *"}),e.jsx(_,{id:"username",value:b.username,onChange:c=>l("username",c.target.value),placeholder:"Enter username"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"email",children:"Email *"}),e.jsx(_,{id:"email",type:"email",value:b.email,onChange:c=>l("email",c.target.value),placeholder:"Enter email address"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"designation",children:"Designation *"}),e.jsx(_,{id:"designation",value:b.designation,onChange:c=>l("designation",c.target.value),placeholder:"Enter designation"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"password",children:"Password *"}),e.jsx(_,{id:"password",type:"password",value:b.password,onChange:c=>l("password",c.target.value),placeholder:"Enter password"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"mobile",children:"Mobile *"}),e.jsx(_,{id:"mobile",value:b.mobile,onChange:c=>l("mobile",c.target.value),placeholder:"Enter mobile number"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"agencyCode",children:"Agency Code *"}),e.jsx(_,{id:"agencyCode",value:b.agencyCode,onChange:c=>l("agencyCode",c.target.value),placeholder:"Enter agency code"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"division",children:"Division *"}),e.jsxs(Ne,{value:((he=b.divisionId)==null?void 0:he.toString())||"",onValueChange:Z,children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select division"})}),e.jsx(ge,{children:x.map(c=>e.jsx(ae,{value:c.id.toString(),children:c.divisionName},c.id))})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"district",children:"District *"}),e.jsxs(Ne,{value:((k=b.districtId)==null?void 0:k.toString())||"",onValueChange:te,disabled:!b.divisionId||W,children:[e.jsx(je,{children:e.jsx(fe,{placeholder:b.divisionId?W?"Loading districts...":"Select district":"Select division first"})}),e.jsx(ge,{children:W?e.jsxs("div",{className:"flex items-center justify-center py-2",children:[e.jsx(Le,{className:"w-4 h-4 animate-spin mr-2"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Loading districts..."})]}):p.length===0?e.jsx("div",{className:"py-2 px-3 text-sm text-gray-500",children:"No districts found for selected division"}):p.map(c=>e.jsx(ae,{value:c.id.toString(),children:c.districtName},c.id))})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"role",children:"Role *"}),e.jsxs(Ne,{value:b.role,onValueChange:c=>l("role",c),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select role"})}),e.jsx(ge,{children:Ki.map(c=>e.jsx(ae,{value:c.value,children:c.label},c.value))})]})]})]}),e.jsx("div",{className:"bg-blue-50 p-3 rounded-md",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(us,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-xs text-blue-700",children:"Select a division to load its districts. Districts will be fetched automatically based on your selection."})]})}),e.jsxs(ta,{children:[e.jsx(L,{variant:"outline",onClick:()=>N(!1),children:"Cancel"}),e.jsxs(L,{onClick:Q,disabled:J,children:[J?e.jsx(Le,{className:"w-4 h-4 mr-2 animate-spin"}):null,"Create User"]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(Ae.div,{className:"border border-gray-200 rounded-sm bg-white p-4 shadow-sm",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:0},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Ns,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:y})]})]})}),e.jsx(Ae.div,{className:"border border-gray-200 rounded-sm bg-white p-4 shadow-sm",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Pt,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:o})]})]})}),e.jsx(Ae.div,{className:"border border-gray-200 rounded-sm bg-white p-4 shadow-sm",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(Et,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Inactive"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:ne})]})]})})]}),e.jsxs(O,{className:"border border-gray-200 rounded-sm shadow-sm overflow-hidden",children:[e.jsx(se,{children:e.jsx(ee,{className:"text-sm font-semibold",children:"District Users Directory"})}),e.jsx($,{className:"p-0 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border-collapse border border-gray-300",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:["S.No","Name","Username","Email","Designation","District","Mobile","Role","Status","Actions"].map(c=>e.jsx("th",{className:"border border-gray-200 px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:c},c))})}),e.jsxs("tbody",{children:[m.map((c,D)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:D+1}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:c.fullname}),e.jsx("div",{className:"text-xs text-gray-500",children:c.agencyCode})]})}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:e.jsx("div",{className:"font-mono text-xs",children:c.username})}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:c.email}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:c.designation}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:e.jsx("div",{className:"text-sm",children:c.districtName||"N/A"})}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:c.mobile}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:e.jsx(ye,{className:"bg-blue-100 text-blue-800 text-xs",children:c.role})}),e.jsx("td",{className:"border open:bg-gray-200 px-3 py-2 text-sm",children:e.jsx(ye,{className:c.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:c.isActive?"Active":"Inactive"})}),e.jsxs("td",{className:"border border-gray-200 px-3 py-2 text-center space-x-2",children:[e.jsx(L,{variant:"ghost",size:"icon",children:e.jsx(la,{className:"w-4 h-4 text-blue-600"})}),e.jsx(L,{variant:"ghost",size:"icon",children:e.jsx(Os,{className:"w-4 h-4 text-red-600"})})]})]},c.id)),m.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"border border-gray-200 py-4 text-center text-gray-400 text-sm",children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(Ns,{className:"w-6 h-6 text-gray-400"}),e.jsx("p",{children:"No users found"}),e.jsx("p",{className:"text-xs",children:"Try adjusting your filters"})]})})})]})]})})]})]})}const ir={"प्रथम हप्ता":"First Installment","पहिली मागणी":"Initial Request","दुसरी मागणी":"Second Installment"},Xi=({open:s,onClose:r,demand:t,work:n,demands:i=[]})=>{if(!s||!t||!n)return null;const x=i.filter(J=>J.workId===n.id),g=(n.workPortionAmount??0)+(n.taxDeductionAmount??0),p=x.reduce((J,X)=>J+(X.amount??0),0),d=g-p,j=ir[t.remarks]||t.remarks,P=()=>alert(`Approved ${t.id}`),W=()=>alert(`Rejected ${t.id}`),T=()=>alert(`Sent Back ${t.id}`);return e.jsxs("div",{className:`
        bg-white rounded-2xl shadow-lg
        w-full max-w-[90vw] md:max-w-[1100px]
        max-h-[90vh] overflow-y-auto
        relative p-6
      `,children:[e.jsx("button",{className:"absolute top-4 right-4",onClick:r,children:e.jsx(fs,{className:"w-5 h-5 text-gray-400 hover:text-red-500"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs(O,{children:[e.jsx(se,{children:e.jsx(ee,{className:"text-lg",children:"Work & MLA Overview"})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"MLA/MLC Name"}),e.jsx("div",{children:n.mlaName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"District"}),e.jsx("div",{children:n.district})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Constituency"}),e.jsx("div",{children:n.constituency})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Work Code"}),e.jsx("div",{children:n.workCode})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Work Title"}),e.jsx("div",{children:n.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Financial Year"}),e.jsx("div",{children:n.financialYear})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"AA Amount"}),e.jsxs("div",{children:["₹",n.adminApprovedAmount.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Gross Amt"}),e.jsxs("div",{children:["₹",g.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Total Demanded"}),e.jsxs("div",{children:["₹",p.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Balance Amount"}),e.jsxs("div",{className:"font-bold",children:["₹",d.toLocaleString()]})]})]})}),e.jsxs(O,{children:[e.jsx(se,{children:e.jsx(ee,{className:"text-base",children:"File Attachments"})}),e.jsx($,{children:e.jsxs("div",{className:"flex space-x-6 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ze,{className:"w-4 h-4"})," Work Order"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ze,{className:"w-4 h-4"})," AA Order"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ze,{className:"w-4 h-4"})," Previous Releases"]})]})})]})]}),e.jsxs(O,{children:[e.jsxs("div",{children:[e.jsx(se,{children:e.jsx(ee,{className:"text-base",children:"Vendor Details"})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Vendor ID"}),e.jsx("div",{children:n.vendor.id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Vendor Name"}),e.jsx("div",{children:n.vendor.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Aadhar No."}),e.jsxs("div",{children:["xxxx-xxxx-",n.vendor.aadhar.slice(-4)]})]})]})})]}),e.jsxs(O,{children:[e.jsx(se,{children:e.jsx(ee,{className:"text-lg",children:"Current Demand Details"})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Demand ID"}),e.jsx("div",{children:t.id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Date"}),e.jsx("div",{children:t.date})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Demand Amount"}),e.jsxs("div",{children:["₹",t.amount.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Status"}),e.jsx("div",{children:e.jsx(ye,{children:t.status})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Remark"}),e.jsx("div",{children:j})]})]})})]})]})]}),e.jsxs(O,{className:"mb-4",children:[e.jsx(se,{children:e.jsx(ee,{className:"text-base",children:"All Demands for this Work"})}),e.jsx($,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-xs border",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-1 border",children:"Demand ID"}),e.jsx("th",{className:"px-2 py-1 border",children:"Date"}),e.jsx("th",{className:"px-2 py-1 border",children:"Amount"}),e.jsx("th",{className:"px-2 py-1 border",children:"Status"}),e.jsx("th",{className:"px-2 py-1 border",children:"Remark"})]})}),e.jsx("tbody",{children:x.length>0?x.map(J=>e.jsxs("tr",{className:J.id===t.id?"bg-primary/10 font-semibold":void 0,children:[e.jsx("td",{className:"px-2 py-1 border",children:J.id}),e.jsx("td",{className:"px-2 py-1 border",children:J.date}),e.jsxs("td",{className:"px-2 py-1 border",children:["₹",J.amount.toLocaleString()]}),e.jsx("td",{className:"px-2 py-1 border",children:e.jsx(ye,{children:J.status})}),e.jsx("td",{className:"px-2 py-1 border",children:ir[J.remarks]||J.remarks})]},J.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center text-gray-400 py-4",children:"No demands"})})})]})})})]}),e.jsxs("div",{className:"flex justify-end gap-4 mt-4",children:[e.jsxs(L,{variant:"destructive",onClick:W,children:[e.jsx(Ts,{className:"w-4 h-4 mr-1"})," Reject"]}),e.jsxs(L,{variant:"outline",onClick:T,children:[e.jsx(bl,{className:"w-4 h-4 mr-1"})," Send Back"]}),e.jsxs(L,{variant:"default",onClick:P,children:[e.jsx(ws,{className:"w-4 h-4 mr-1"})," Approve"]})]})]})},Gt=[{id:467,workCode:"ML/2425/2572",name:"ML/2425/2572 आमदार स्थानिक विकास कार्यक्रम सन २०२४-२५ अंतर्गत बारामती येथे होणाऱ्या शिवछत्रपती राज्य स्तरीय कबड्डी स्पर्धेकरिता निधी उपलब्ध करणेबाबत",district:"Pune",constituency:"Baramati",mlaName:"Ajit Anantrao Pawar",financialYear:"2024-25",adminApprovedAmount:2999,workPortionAmount:2800,taxDeductionAmount:100,vendor:{id:"1189",name:"Shree Ganesh Constructions Pvt. Ltd.",aadhar:"123412341234"}},{id:468,workCode:"ML/2425/2151",name:"ML/2425/2151 जांबूत येथे जांबूत चोंभूत रोड ते कळमजाई मंदिर रस्ता करणे ता.शिरुर",district:"Pune",constituency:"Shirur",mlaName:"Dnyaneshwar Katke",financialYear:"2024-25",adminApprovedAmount:1400,workPortionAmount:1200,taxDeductionAmount:110,vendor:{id:"1189",name:"Maratha Nirman & Co.",aadhar:"987654321098"}},{id:469,workCode:"ML/2425/2569",name:"ML/2425/2569 आमदार स्थानिक विकास कार्यक्रम सन २०२४-२५ अंतर्गत बारामती येथे होणाऱ्या शिवछत्रपती राज्य स्तरीय कबड्डी स्पर्धेकरिता निधी उपलब्ध करणेबाबत",district:"Pune",constituency:"Baramati",mlaName:"Ajit Anantrao Pawar",financialYear:"2024-25",adminApprovedAmount:1990,workPortionAmount:1800,taxDeductionAmount:100,vendor:{id:"1189",name:"Sadguru Infrastructure Ltd.",aadhar:"456789123456"}},{id:470,workCode:"ML/2425/0325",name:"ML/2425/0325 मौजे वेहेरगाव येथे भैरवनाथ मंदिरासमोरील ग्रामपंचायतीच्या मोकळ्या जागेत सभामंडप बांधणे.ता.मावळ.जि.पुणे",district:"Pune",constituency:"Maval",mlaName:"Sunil Shankarrao Shelke",financialYear:"2024-25",adminApprovedAmount:1600,workPortionAmount:1400,taxDeductionAmount:100,vendor:{id:"1189",name:"Maharashtra Builders & Developers",aadhar:"321098765432"}}],Zi=[{id:"MLD-467-1",workId:467,amount:500,date:"2025-02-01",status:"Pending",remarks:"First Installment"},{id:"MLD-468-1",workId:468,amount:500,date:"2025-02-02",status:"Pending",remarks:"First Installment"},{id:"MLD-469-1",workId:469,amount:500,date:"2025-02-03",status:"Pending",remarks:"First Installment"},{id:"MLD-470-1",workId:470,amount:500,date:"2025-02-04",status:"Pending",remarks:"First Installment"},{id:"MLD-477-1",workId:467,amount:400,date:"2025-03-01",status:"Approved",remarks:"Second Installment"}];function dr(s){return Array.from(new Set(s))}function Qe(s){return`₹${(s||0).toLocaleString()}`}function Ms(...s){return s.filter(Boolean).join(" ")}function es({title:s,amount:r,caption:t,tone:n}){const x={blue:{border:"border-blue-500",from:"from-blue-50",to:"to-blue-100",title:"text-blue-700",value:"text-blue-900",caption:"text-blue-700/70"},emerald:{border:"border-emerald-500",from:"from-emerald-50",to:"to-emerald-100",title:"text-emerald-700",value:"text-emerald-900",caption:"text-emerald-700/70"},rose:{border:"border-rose-500",from:"from-rose-50",to:"to-rose-100",title:"text-rose-700",value:"text-rose-900",caption:"text-rose-700/70"},amber:{border:"border-amber-500",from:"from-amber-50",to:"to-amber-100",title:"text-amber-700",value:"text-amber-900",caption:"text-amber-700/70"},indigo:{border:"border-indigo-500",from:"from-indigo-50",to:"to-indigo-100",title:"text-indigo-700",value:"text-indigo-900",caption:"text-indigo-700/70"},green:{border:"border-green-500",from:"from-green-50",to:"to-green-100",title:"text-green-700",value:"text-green-900",caption:"text-green-700/70"}}[n];return e.jsxs(Ae.div,{className:Ms("rounded-md p-3 shadow-sm border-l-4 text-[11px] bg-gradient-to-br",x.border,x.from,x.to),initial:{opacity:0,y:8},animate:{opacity:1,y:0},children:[e.jsx("p",{className:Ms("font-semibold uppercase leading-none",x.title),children:s}),e.jsx("p",{className:Ms("mt-1 text-xl font-bold",x.value),children:r}),t&&e.jsx("p",{className:Ms("mt-0.5",x.caption),children:t})]})}function Aa({value:s,onChange:r,options:t,placeholder:n="Select…",className:i}){const[x,g]=a.useState(!1),p=a.useMemo(()=>[...t].sort((d,j)=>d.localeCompare(j,"en",{sensitivity:"base"})),[t]);return e.jsxs($t,{open:x,onOpenChange:g,children:[e.jsx(zt,{asChild:!0,children:e.jsxs(L,{variant:"outline",role:"combobox","aria-expanded":x,className:Ms("w-full justify-between h-8 text-[11px] px-2",i),children:[e.jsx("span",{className:Ms(!s&&"text-muted-foreground"),children:s||n}),e.jsx(Vt,{className:"ml-2 h-3.5 w-3.5 opacity-60"})]})}),e.jsx(jt,{className:"p-0 w-[--radix-popover-trigger-width] min-w-[180px]",align:"start",children:e.jsxs(Nt,{children:[e.jsx(ft,{placeholder:"Type to search…",className:"h-8 text-[11px]"}),e.jsx(bt,{children:"No results found."}),e.jsx(yt,{className:"max-h-64 overflow-auto",children:p.map(d=>{const j=s===d;return e.jsxs(vt,{value:d,onSelect:P=>{r(P),g(!1)},className:"text-[11px]",children:[e.jsx(ws,{className:Ms("mr-2 h-3.5 w-3.5",j?"opacity-100":"opacity-0")}),e.jsx("span",{className:"truncate",children:d})]},d)})})]})})]})}function Qi({district:s="Pune"}){const[r,t]=a.useState(Zi),[n,i]=a.useState("All"),[x,g]=a.useState("All"),[p,d]=a.useState("All"),[j,P]=a.useState(!1),[W,T]=a.useState(null),[J,X]=a.useState(new Set),w=a.useMemo(()=>["All",...dr(Gt.map(R=>R.financialYear))],[]),V=["All","MLA","MLC","HADP"],F=a.useMemo(()=>["All",...dr(Gt.filter(R=>R.district===s).map(R=>R.mlaName))],[s]),N=R=>"MLA",b=a.useMemo(()=>r.filter(R=>{const z=Gt.find(re=>re.id===R.workId);return!(!z||z.district!==s||n!=="All"&&z.financialYear!==n||x!=="All"&&N()!==x||p!=="All"&&z.mlaName!==p)}),[r,n,x,p,s]),A=R=>R.reduce((z,re)=>z+re.amount,0),C=R=>R.status==="Approved",q=R=>R.status==="Pending",Z=R=>R.status==="Rejected",B=A(b),te=b.filter(C).length,Q=A(b.filter(C)),G=b.filter(Z).length,l=A(b.filter(Z)),M=b.filter(q).length,m=A(b.filter(q)),y=b.length,o=A(b),ne=te,he=Q,k=G,c=l,D=M,de=m,I=a.useMemo(()=>b.length>0&&b.every(R=>J.has(R.id)),[b,J]),H=R=>X(z=>{const re=new Set(z);return re.has(R)?re.delete(R):re.add(R),re}),oe=()=>X(R=>{const z=new Set(R),re=b.every(xe=>z.has(xe.id));return b.forEach(xe=>re?z.delete(xe.id):z.add(xe.id)),z}),pe=()=>{J.size!==0&&(t(R=>R.map(z=>J.has(z.id)?{...z,status:"Approved"}:z)),X(new Set))},E=R=>{T(R),P(!0)};return e.jsxs("div",{className:"p-5 space-y-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-base font-semibold",children:"District Fund Demands"}),e.jsxs("span",{className:"px-2.5 py-1 text-[11px] rounded-full bg-indigo-50 text-indigo-700 border border-indigo-200",children:["District: ",e.jsx("b",{className:"ml-1",children:s})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-[11px] font-medium text-gray-600",children:"Submitted to State Admin"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2",children:[e.jsx(es,{title:"Total Fund Demands Forwarded",tone:"blue",amount:Qe(B),caption:`Count: ${b.length}`}),e.jsx(es,{title:"Total Demands Approved by State",tone:"emerald",amount:Qe(Q),caption:`Approved: ${te}`}),e.jsx(es,{title:"Rejected by State",tone:"rose",amount:Qe(l),caption:`Rejected: ${G}`}),e.jsx(es,{title:"Pending at State for Approval",tone:"amber",amount:Qe(m),caption:`Pending: ${M}`})]}),e.jsx("div",{className:"text-[11px] font-medium text-gray-600 mt-2",children:"Received from IA"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2",children:[e.jsx(es,{title:"Demands Received",tone:"indigo",amount:Qe(o),caption:`Count: ${y}`}),e.jsx(es,{title:"Approved Demands",tone:"green",amount:Qe(he),caption:`Approved: ${ne}`}),e.jsx(es,{title:"Rejected Demands",tone:"rose",amount:Qe(c),caption:`Rejected: ${k}`}),e.jsx(es,{title:"Pending for Approval",tone:"amber",amount:Qe(de),caption:`Pending: ${D}`})]})]}),e.jsxs(O,{className:"rounded-md shadow-sm",children:[e.jsx(se,{className:"py-2",children:e.jsx(ee,{className:"text-xs",children:"Filters"})}),e.jsx($,{className:"p-3",children:e.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end text-[11px]",children:[e.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[e.jsx("span",{className:"block text-[10px] text-gray-600 mb-1",children:"Financial Year"}),e.jsx(Aa,{value:n,onChange:i,options:w})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[e.jsx("span",{className:"block text-[10px] text-gray-600 mb-1",children:"Plan Type"}),e.jsx(Aa,{value:x,onChange:g,options:V})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[e.jsx("span",{className:"block text-[10px] text-gray-600 mb-1",children:"MLA/MLC Name"}),e.jsx(Aa,{value:p,onChange:d,options:F})]})]})})]}),e.jsxs(O,{className:"rounded-md shadow-sm",children:[e.jsx(se,{className:"py-2",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx(ee,{className:"text-sm text-gray-800",children:"MLA/MLC Fund Demands"}),e.jsx("span",{className:"text-[10px] text-red-600 italic",children:"*All Amounts Are in Thousands"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-1.5 text-[11px]",children:[e.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 accent-indigo-600",checked:I,onChange:oe}),e.jsx("span",{children:"Select all"})]}),e.jsxs(L,{size:"sm",className:Ms("h-8 text-xs",J.size===0&&"opacity-50 pointer-events-none"),onClick:pe,children:["Approve Selected (",J.size,")"]})]})]})}),e.jsx($,{className:"overflow-x-auto p-0",children:e.jsxs("table",{className:"min-w-full border border-gray-200 text-[12px]",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 uppercase text-[10px] sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-2 py-2 text-center w-10",children:"Sel"}),e.jsx("th",{className:"border px-2 py-2 text-left",children:"Sr No"}),e.jsx("th",{className:"border px-2 py-2 text-left",children:"District"}),e.jsx("th",{className:"border px-2 py-2 text-left",children:"Demand ID"}),e.jsx("th",{className:"border px-2 py-2 text-left",children:"MLA/MLC Account Name"}),e.jsx("th",{className:"border px-2 py-2 text-right",children:"AA Amount"}),e.jsx("th",{className:"border px-2 py-2 text-right",children:"Gross Work Order Amt"}),e.jsx("th",{className:"border px-2 py-2 text-right",children:"Demand Amount"}),e.jsx("th",{className:"border px-2 py-2 text-center",children:"Status"}),e.jsx("th",{className:"border px-2 py-2 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:b.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"py-6 text-center text-gray-500 text-xs",children:"No records found"})}):b.map((R,z)=>{const re=Gt.find(Fe=>Fe.id===R.workId),xe=re.workPortionAmount+re.taxDeductionAmount,Ee=J.has(R.id),De=Fe=>Fe==="Approved"?e.jsx("span",{className:"px-1.5 py-0.5 rounded-full text-[10px] bg-emerald-50 text-emerald-700 border border-emerald-200",children:"Approved"}):Fe==="Rejected"?e.jsx("span",{className:"px-1.5 py-0.5 rounded-full text-[10px] bg-rose-50 text-rose-700 border border-rose-200",children:"Rejected"}):e.jsx("span",{className:"px-1.5 py-0.5 rounded-full text-[10px] bg-amber-50 text-amber-700 border border-amber-200",children:"Pending"});return e.jsxs("tr",{className:Ms("hover:bg-gray-50",R.status==="Approved"&&"bg-emerald-50/40"),children:[e.jsx("td",{className:"border px-2 py-2 text-center",children:e.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 accent-indigo-600",checked:Ee,onChange:()=>H(R.id)})}),e.jsx("td",{className:"border px-2 py-2",children:z+1}),e.jsx("td",{className:"border px-2 py-2",children:re.district}),e.jsx("td",{className:"border px-2 py-2",children:R.id}),e.jsx("td",{className:"border px-2 py-2",children:re.mlaName}),e.jsx("td",{className:"border px-2 py-2 text-right",children:re.adminApprovedAmount}),e.jsx("td",{className:"border px-2 py-2 text-right",children:xe}),e.jsx("td",{className:"border px-2 py-2 text-right",children:R.amount.toLocaleString()}),e.jsx("td",{className:"border px-2 py-2 text-center",children:De(R.status)}),e.jsx("td",{className:"border px-2 py-2 text-center",children:e.jsxs(ts,{open:j&&W===R.id,onOpenChange:P,children:[e.jsx(gt,{asChild:!0,children:e.jsx(L,{size:"icon",variant:"ghost",onClick:()=>E(R.id),children:e.jsx(Re,{className:"w-4 h-4 text-indigo-600"})})}),e.jsx(Ze,{className:"w-[90vw] max-w-[1100px]",children:e.jsx(Xi,{open:j&&W===R.id,onClose:()=>P(!1),demand:R,work:re,demands:r})})]})})]},R.id)})})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-[11px] font-medium text-gray-600",children:"Submitted to State Admin"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2",children:[e.jsx(es,{title:"Total Fund Demands Forwarded",tone:"blue",amount:Qe(B),caption:`Count: ${b.length}`}),e.jsx(es,{title:"Total Demands Approved by State",tone:"emerald",amount:Qe(Q),caption:`Approved: ${te}`}),e.jsx(es,{title:"Rejected by State",tone:"rose",amount:Qe(l),caption:`Rejected: ${G}`}),e.jsx(es,{title:"Pending at State for Approval",tone:"amber",amount:Qe(m),caption:`Pending: ${M}`})]}),e.jsx("div",{className:"text-[11px] font-medium text-gray-600 mt-2",children:"Received from IA"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2",children:[e.jsx(es,{title:"Demands Received",tone:"indigo",amount:Qe(o),caption:`Count: ${y}`}),e.jsx(es,{title:"Approved Demands",tone:"green",amount:Qe(he),caption:`Approved: ${ne}`}),e.jsx(es,{title:"Rejected Demands",tone:"rose",amount:Qe(c),caption:`Rejected: ${k}`}),e.jsx(es,{title:"Pending for Approval",tone:"amber",amount:Qe(de),caption:`Pending: ${D}`})]})]})]})}const Qs=yl,Us=a.forwardRef(({className:s,...r},t)=>e.jsx(an,{ref:t,className:ie("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r}));Us.displayName=an.displayName;const Ve=a.forwardRef(({className:s,...r},t)=>e.jsx(rn,{ref:t,className:ie("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r}));Ve.displayName=rn.displayName;const Ie=a.forwardRef(({className:s,...r},t)=>e.jsx(nn,{ref:t,className:ie("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r}));Ie.displayName=nn.displayName;const cr=[{id:1,name:"GST (18%)",percentage:18},{id:2,name:"TDS (2%)",percentage:2},{id:3,name:"Cess (1%)",percentage:1}],ed=s=>!isNaN(s)&&isFinite(s),sd=({open:s,onClose:r,work:t,demands:n,addDemand:i})=>{const[x,g]=a.useState(""),[p,d]=a.useState(""),[j,P]=a.useState([]),[W,T]=a.useState(!1),[J,X]=a.useState(""),[w,V]=a.useState(""),[F,N]=a.useState("");a.useEffect(()=>{N("DM-"+Date.now().toString().slice(-6))},[s,t]);const b=a.useMemo(()=>(n||[]).filter(y=>t&&y.workId===t.id),[n,t]),A=(t==null?void 0:t.vendorDetails)||{name:"",aadhar:""};A.totalFundReceived=b.filter(y=>y.status==="Approved").reduce((y,o)=>y+(o.netPayable??o.amount??0),0),A.totalTaxDeducted=b.filter(y=>y.status==="Approved").reduce((y,o)=>y+(Array.isArray(o.taxes)?o.taxes.reduce((ne,he)=>ne+(he.amount??0),0):0),0);const C=((t==null?void 0:t.workPortionAmount)??0)+((t==null?void 0:t.taxDeductionAmount)??0),q=b.reduce((y,o)=>y+(o.amount??0),0),Z=C-q,B=Number(x)||0,te=cr.filter(y=>j.includes(y.id)),Q=te.map(y=>({...y,amount:Math.round(B*(y.percentage/100))})),G=Q.reduce((y,o)=>y+(o.amount??0),0),l=B-G;a.useEffect(()=>{if(X(""),V(""),!!x){if(!ed(x)||B<=0){X("Please enter a valid positive amount.");return}if(B>Z){X(`Demand amount exceeds balance limit (₹${(Z??0).toLocaleString()}).`);return}B===Z&&V("Note: You are demanding the exact remaining balance amount."),B>.9*Z&&B<Z&&V("Warning: You are demanding more than 90% of the available balance.")}},[x,Z,B]);const M=y=>{P(o=>o.includes(y)?o.filter(ne=>ne!==y):[...o,y])},m=y=>{if(y.preventDefault(),!(J||!B||B<=0)){if(!p.trim()){X("Enter purpose/remarks.");return}i({id:F,workId:t.id,workName:t.name,vendor:A.name,amount:B,netPayable:l,taxes:Q,scheme:t.scheme,status:"Pending",date:new Date().toISOString().split("T")[0],remarks:p}),g(""),d(""),P([]),V(""),r()}};return!s||!t?null:e.jsx("div",{className:"fixed inset-0 bg-black/30 z-50 flex items-center justify-center p-2",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full md:w-[80vw] max-w-none p-3 relative max-h-[90vh] overflow-y-auto",children:[e.jsx("button",{className:"absolute top-3 right-3",onClick:r,children:e.jsx(fs,{className:"w-5 h-5 text-gray-400 hover:text-red-500"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Raise Fund Demand"}),e.jsxs(O,{className:"mb-2",children:[e.jsxs(se,{className:"p-2 pb-0",children:[e.jsx(ee,{className:"text-lg flex items-center gap-2",children:t.scheme}),e.jsx("div",{className:"text-xs text-gray-400",children:"Scheme Name"})]}),e.jsx($,{className:"p-2 pt-1",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Work Name"}),e.jsx("div",{children:t.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Sanctioned Date"}),e.jsx("div",{children:t.sanctionedDate})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Financial Year"}),e.jsx("div",{children:t.financialYear})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Admin Approved Amount"}),e.jsxs("div",{children:["₹",(t.adminApprovedAmount??0).toLocaleString()]})]}),t.aaLetter&&e.jsx("a",{href:t.aaLetter,target:"_blank",rel:"noopener noreferrer",title:"View AA Letter",children:e.jsx(Re,{className:"inline-block w-5 h-5 text-primary ml-1 cursor-pointer"})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Work Portion Amount"}),e.jsxs("div",{children:["₹",(t.workPortionAmount??0).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Gross Total"}),e.jsxs("div",{children:["₹",(C??0).toLocaleString()]})]}),t.sanctionedLetter&&e.jsx("a",{href:t.sanctionedLetter,target:"_blank",rel:"noopener noreferrer",title:"View Sanctioned Letter",children:e.jsx(Re,{className:"inline-block w-5 h-5 text-primary ml-1 cursor-pointer"})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Total Demanded"}),e.jsxs("div",{children:["₹",(q??0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Balance Amount"}),e.jsxs("div",{className:"font-bold text-primary",children:["₹",(Z??0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"IA / PWD"}),e.jsx("div",{children:t.ia||"PWD"})]})]})})]}),e.jsxs(O,{className:"mb-2",children:[e.jsx(se,{className:"p-2 pb-0",children:e.jsx(ee,{className:"text-base",children:"Vendor Details"})}),e.jsx($,{className:"p-2 pt-1",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Vendor Name"}),e.jsx("div",{children:A.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Aadhar No."}),e.jsx("div",{children:A.aadhar})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Total Fund Received"}),e.jsxs("div",{children:["₹",(A.totalFundReceived??0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Total Tax Deducted"}),e.jsxs("div",{children:["₹",(A.totalTaxDeducted??0).toLocaleString()]})]})]})})]}),e.jsxs(O,{className:"mb-2",children:[e.jsx(se,{className:"p-2 pb-0",children:e.jsx(ee,{className:"text-base",children:"Raise New Fund Demand"})}),e.jsx($,{className:"p-2 pt-1",children:e.jsxs("form",{onSubmit:m,className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold text-gray-700",children:"Demand ID"}),e.jsx(_,{value:F,readOnly:!0,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold text-gray-700",children:"Work Portion Amount"}),e.jsx(_,{type:"number",min:1,max:Z,value:x,onChange:y=>g(y.target.value.replace(/^0+/,"")),placeholder:"Enter amount",required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block mb-1 font-semibold text-gray-700",children:"Select Taxes"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",className:"w-full border rounded-lg px-3 py-2 flex items-center justify-between bg-gray-50",onClick:()=>T(y=>!y),children:[te.length>0?te.map(y=>y.name).join(", "):"Select taxes to apply",e.jsx(na,{className:"w-4 h-4"})]}),W&&e.jsx("div",{className:"absolute z-10 bg-white border rounded shadow w-full mt-1 max-h-40 overflow-y-auto",children:cr.map(y=>e.jsxs("label",{className:"flex items-center px-3 py-1 cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",checked:j.includes(y.id),onChange:()=>M(y.id),className:"mr-2"}),y.name]},y.id))})]}),Q.length>0&&e.jsx("ul",{className:"text-xs mt-1 text-gray-600",children:Q.map(y=>e.jsxs("li",{children:[y.name,": ₹",(y.amount??0).toLocaleString()]},y.id))})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block mb-1 font-semibold text-gray-700",children:"Purpose / Remarks"}),e.jsx(_,{type:"text",value:p,onChange:y=>d(y.target.value),placeholder:"Enter purpose/remarks",required:!0})]}),e.jsxs("div",{className:"md:col-span-2 grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Total Tax"}),e.jsxs("div",{children:["₹",(G??0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Net Payable to Vendor"}),e.jsxs("div",{className:"font-bold text-primary",children:["₹",(l>0?l:0).toLocaleString()]})]})]}),w&&e.jsxs("div",{className:"col-span-2 flex items-center text-yellow-700 bg-yellow-50 rounded p-2 gap-2",children:[e.jsx(Qt,{className:"w-5 h-5 text-yellow-700"}),w]}),J&&e.jsxs("div",{className:"col-span-2 flex items-center text-red-700 bg-red-50 rounded p-2 gap-2",children:[e.jsx(Qt,{className:"w-5 h-5 text-red-700"}),J]}),e.jsx("div",{className:"col-span-2 flex justify-end",children:e.jsxs(L,{type:"submit",className:"flex items-center gap-2",disabled:!!J||!B||B<=0,children:[e.jsx(ps,{className:"h-4 w-4"}),"Raise Demand"]})})]})})]}),e.jsxs(O,{children:[e.jsx(se,{className:"p-2 pb-0",children:e.jsx(ee,{className:"text-base",children:"All Demands for this Work"})}),e.jsx($,{className:"p-2 pt-1",children:b.length===0?e.jsx("div",{className:"text-sm text-gray-500",children:"No demands yet."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm border",children:[e.jsx("thead",{children:e.jsx("tr",{children:["Demand ID","Amount","Net Payable","Date","Remarks","Taxes","Status"].map(y=>e.jsx("th",{className:"px-1 py-0.5 border",children:y},y))})}),e.jsx("tbody",{children:b.map(y=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-1 py-0.5 border",children:y.id}),e.jsxs("td",{className:"px-1 py-0.5 border",children:["₹",(y.amount??0).toLocaleString()]}),e.jsxs("td",{className:"px-1 py-0.5 border",children:["₹",(y.netPayable??y.amount??0).toLocaleString()]}),e.jsx("td",{className:"px-1 py-0.5 border",children:y.date}),e.jsx("td",{className:"px-1 py-0.5 border",children:y.remarks}),e.jsx("td",{className:"px-1 py-0.5 border",children:y.taxes&&y.taxes.length>0?y.taxes.map((o,ne)=>e.jsxs("div",{children:[o.name,": ₹",(o.amount??0).toLocaleString()]},ne)):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx("td",{className:"px-1 py-0.5 border",children:e.jsx(ye,{children:y.status})})]},y.id))})]})})})]})]})})},td=({open:s,onClose:r,demand:t,work:n,vendor:i,demands:x=[]})=>{if(!s||!t||!n)return null;const g=x.filter(P=>P.workId===n.id),p=(n.adminApprovedAmount??0)+(n.taxDeductionAmount??0),d=g.reduce((P,W)=>P+(W.amount??0),0),j=p-d;return e.jsx("div",{className:"fixed inset-0 bg-black/30 z-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl p-6 relative max-h-[90vh] overflow-y-auto",children:[e.jsx("button",{className:"absolute top-4 right-4",onClick:r,children:e.jsx(fs,{className:"w-5 h-5 text-gray-400 hover:text-red-500"})}),e.jsxs(O,{className:"mb-4",children:[e.jsx(se,{children:e.jsx(ee,{className:"text-lg",children:"Work & Scheme Overview"})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 text-sm mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Scheme Name"}),e.jsx("div",{children:n.scheme})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Work Name"}),e.jsx("div",{children:n.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Sanctioned Date"}),e.jsx("div",{children:n.sanctionedDate})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Financial Year"}),e.jsx("div",{children:n.financialYear})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Work Portion Amount"}),e.jsxs("div",{children:["₹",(n.workPortionAmount??0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Gross Total"}),e.jsxs("div",{children:["₹",(p??0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Total Demanded"}),e.jsxs("div",{children:["₹",(d??0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Balance Amount"}),e.jsxs("div",{className:"font-bold text-primary",children:["₹",(j??0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"IA / PWD"}),e.jsx("div",{children:n.ia||"PWD"})]})]})})]}),e.jsxs(O,{className:"mb-4",children:[e.jsx(se,{children:e.jsx(ee,{className:"text-base",children:"Vendor Details"})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Vendor Name"}),e.jsx("div",{children:i.name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Aadhar No."}),e.jsx("div",{children:i!=null&&i.aadhar?`XXXX-XXXX-${i.aadhar.slice(-4)}`:"N/A"})]})]})})]}),e.jsxs(O,{children:[e.jsx(se,{children:e.jsx(ee,{className:"text-lg",children:"Current Demand Details"})}),e.jsxs($,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Demand ID"}),e.jsx("div",{children:t.id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Date"}),e.jsx("div",{children:t.date})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Amount"}),e.jsxs("div",{children:["₹",(t.amount??0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Net Payable"}),e.jsxs("div",{children:["₹",(t.netPayable??t.amount??0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Status"}),e.jsx("div",{children:e.jsx(ye,{children:t.status})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Remarks"}),e.jsx("div",{children:t.remarks})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Taxes Applied:"}),e.jsx("ul",{className:"text-xs ml-3 mt-1",children:t.taxes&&t.taxes.length>0?t.taxes.map((P,W)=>e.jsxs("li",{children:[P.name,": ₹",(P.amount??0).toLocaleString()]},W)):e.jsx("li",{className:"text-gray-500",children:"No taxes applied"})})]})]})]}),e.jsxs(O,{className:"mt-6",children:[e.jsx(se,{children:e.jsx(ee,{className:"text-base",children:"All Demands for this Work"})}),e.jsx($,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-xs border",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-1 border",children:"Demand ID"}),e.jsx("th",{className:"px-2 py-1 border",children:"Date"}),e.jsx("th",{className:"px-2 py-1 border",children:"Amount"}),e.jsx("th",{className:"px-2 py-1 border",children:"Net Payable"}),e.jsx("th",{className:"px-2 py-1 border",children:"Status"}),e.jsx("th",{className:"px-2 py-1 border",children:"Remarks"}),e.jsx("th",{className:"px-2 py-1 border",children:"Taxes"})]})}),e.jsxs("tbody",{children:[g.map(P=>e.jsxs("tr",{className:P.id===t.id?"bg-primary/10 border font-semibold":"border",children:[e.jsx("td",{className:"px-2 py-1 border",children:P.id}),e.jsx("td",{className:"px-2 py-1 border",children:P.date}),e.jsxs("td",{className:"px-2 py-1 border",children:["₹",(P.amount??0).toLocaleString()]}),e.jsxs("td",{className:"px-2 py-1 border",children:["₹",(P.netPayable??P.amount??0).toLocaleString()]}),e.jsx("td",{className:"px-2 py-1 border",children:e.jsx(ye,{children:P.status})}),e.jsx("td",{className:"px-2 py-1 border",children:P.remarks}),e.jsx("td",{className:"px-2 py-1 border",children:P.taxes&&P.taxes.length>0?P.taxes.map((W,T)=>e.jsxs("div",{children:[W.name,": ₹",(W.amount??0).toLocaleString()]},T)):e.jsx("span",{className:"text-gray-400",children:"-"})})]},P.id)),g.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center text-gray-400 py-4",children:"No Demands"})})]})]})})})]})]})})},ad=[{id:468,workCode:"ML/2425/2151",name:"ML/2425/2151 जांबूत येथे जांबूत चोंभूत रोड ते कळमजाई मंदिर रस्ता करणे ता.शिरुर",district:"Pune",constituency:"Shirur",mlaName:"Dnyaneshwar Katke",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",iaName:"928 Executive Engineer, Public Works North Division, Pune",financialYear:"2024-25",demandAmount:1400,adminApprovedAmount:1400,workPortionAmount:1200,taxDeductionAmount:110,vendor:{id:"1189",name:"Maratha Nirman & Co.",aadhar:"987654321098"}},{id:469,workCode:"ML/2425/2569",name:"ML/2425/2569 आमदार स्थानिक विकास कार्यक्रम सन २०२४-२५ अंतर्गत बारामती येथे होणाऱ्या शिवछत्रपती राज्य स्तरीय कबड्डी स्पर्धेकरिता निधी उपलब्ध करणेबाबत",district:"Pune",constituency:"Baramati",mlaName:"Ajit Anantrao Pawar",schemeName:"45150012 53 MLA/MLC LOCAL DEVELOPMENT PROGRAMME",iaName:"1189 District Sports Officer, Pune",financialYear:"2024-25",demandAmount:1990,adminApprovedAmount:1990,workPortionAmount:1800,taxDeductionAmount:100,vendor:{id:"1189",name:"Sadguru Infrastructure Ltd.",aadhar:"456789123456"}}],rd=[{id:"MLD-468-1",workId:468,amount:500,netPayable:480,status:"Pending",remarks:"First Installment",date:"2024-07-01"},{id:"MLD-468-2",workId:468,amount:400,netPayable:380,status:"Approved",remarks:"Second Installment",date:"2024-08-01"},{id:"MLD-469-1",workId:469,amount:1e3,netPayable:950,status:"Pending",remarks:"First Installment",date:"2024-07-05"},{id:"MLD-469-2",workId:469,amount:500,netPayable:480,status:"Approved",remarks:"Second Installment",date:"2024-08-10"}],nd={Approved:"✔️",Pending:"⏳",Rejected:"❌"},or=s=>e.jsx(ye,{variant:s==="Approved"?"default":s==="Pending"?"secondary":s==="Rejected"?"destructive":"secondary",children:s}),ld=()=>{const[s,r]=a.useState("overview"),[t]=a.useState(ad),[n,i]=a.useState(rd),[x,g]=a.useState("all"),[p,d]=a.useState("all"),[j,P]=a.useState("all"),[W,T]=a.useState("all"),[J,X]=a.useState(!1),[w,V]=a.useState(!1),[F,N]=a.useState(null),[b,A]=a.useState(null),C=l=>i([...n,l]),q=a.useMemo(()=>["all",...Array.from(new Set(t.map(l=>l.financialYear)))],[t]),Z=a.useMemo(()=>x==="all"?["all",...Array.from(new Set(t.map(l=>l.scheme)))]:["all",...Array.from(new Set(t.filter(l=>l.financialYear===x).map(l=>l.scheme)))],[t,x]),B=a.useMemo(()=>p==="all"?["all",...Array.from(new Set(t.filter(l=>x==="all"||l.financialYear===x).map(l=>l.name)))]:["all",...Array.from(new Set(t.filter(l=>l.scheme===p).map(l=>l.name)))],[t,x,p]),te=t.filter(l=>(x==="all"||l.financialYear===x)&&(p==="all"||l.scheme===p)&&(j==="all"||l.name===j)),Q=n.filter(l=>{const M=t.find(m=>m.id===l.workId);return(x==="all"||(M==null?void 0:M.financialYear)===x)&&(p==="all"||(M==null?void 0:M.scheme)===p)&&(j==="all"||(M==null?void 0:M.name)===j)&&(W==="all"||l.status===W)}),G={totalWorks:te.length,totalVendors:[...new Set(te.map(l=>l.vendor))].length,totalLimit:te.reduce((l,M)=>l+(M.limit??0),0),pendingDemands:Q.filter(l=>l.status==="Pending").length,approvedDemands:Q.filter(l=>l.status==="Approved").length,totalDemandAmount:Q.reduce((l,M)=>l+(M.amount??0),0),totalDemandApproved:Q.filter(l=>l.status==="Approved").reduce((l,M)=>l+(M.amount??0),0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(sd,{open:J,onClose:()=>X(!1),work:F,demands:n,addDemand:C}),e.jsx(td,{open:w,onClose:()=>V(!1),demand:b,work:F,vendor:F==null?void 0:F.vendor,demands:n}),e.jsxs("div",{className:"flex flex-wrap items-end gap-3 pb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-600",children:"Financial Year"}),e.jsx("select",{value:x,onChange:l=>{g(l.target.value),d("all"),P("all")},className:"block px-3 py-1.5 mt-1 border rounded-md w-40",children:q.map(l=>e.jsx("option",{value:l,children:l==="all"?"All":l},l))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-600",children:"Scheme"}),e.jsx("select",{value:p,onChange:l=>{d(l.target.value),P("all")},className:"block px-3 py-1.5 mt-1 border rounded-md w-40",children:Z.map((l,M)=>e.jsx("option",{value:l,children:l==="all"?"All":l},`scheme-${l}-${M}`))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-600",children:"Work"}),e.jsx("select",{value:j,onChange:l=>P(l.target.value),className:"block px-3 py-1.5 mt-1 border rounded-md w-48",children:B.map(l=>e.jsx("option",{value:l,children:l==="all"?"All":l},l))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-600",children:"Status"}),e.jsxs("select",{value:W,onChange:l=>T(l.target.value),className:"block px-3 py-1.5 mt-1 border rounded-md w-32",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Approved",children:"Approved"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6",children:[{label:"Total Works",value:G.totalWorks,desc:"Works under selected filters"},{label:"Total Demand Amount",value:`₹${(G.totalDemandAmount??0).toLocaleString()}`,desc:"Sum of all demands"},{label:"Approved Demand Amount",value:`₹${(G.totalDemandApproved??0).toLocaleString()}`,desc:"Sum of approved demands"},{label:" No of Pending Demands",value:G.pendingDemands,desc:"Awaiting approval"}].map((l,M)=>e.jsxs(O,{className:"h-full flex flex-col justify-between rounded-2xl shadow border border-gray-200 bg-white transition hover:shadow-lg",children:[e.jsx(se,{className:"pb-0 flex flex-row items-center justify-between",children:e.jsx(ee,{className:"text-sm font-semibold tracking-wide text-gray-700",children:l.label})}),e.jsxs($,{className:"flex-1 flex flex-col justify-center py-3",children:[e.jsx("div",{className:"text-2xl font-extrabold text-primary mb-1",children:l.value}),e.jsx("div",{className:"text-xs text-muted-foreground",children:l.desc})]})]},M))}),e.jsxs(Qs,{value:s,onValueChange:r,className:"space-y-6",children:[e.jsxs(Us,{children:[e.jsx(Ve,{value:"overview",children:"Sanctioned Works"}),e.jsx(Ve,{value:"pending",children:"Pending Demands"}),e.jsx(Ve,{value:"approved",children:"Approved Demands"})]}),e.jsx(Ie,{value:"overview",children:e.jsx("div",{className:"overflow-x-auto rounded-2xl shadow border border-gray-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"MLA/MLC Account Name"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"IA Name"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Work Title"}),e.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Gross Work Order Amount"}),e.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Funds disbursed so far"}),e.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Demand Amount"}),e.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700",children:"Actions"})]})}),e.jsxs("tbody",{children:[te.map((l,M)=>{const m=n.filter(ne=>ne.workId===l.id),y=m.reduce((ne,he)=>ne+(he.amount??0),0),o=(l.workPortionAmount??0)+(l.taxDeductionAmount??0);return e.jsxs("tr",{className:`${M%2===0?"bg-white":"bg-gray-50"} hover:bg-primary/5 transition border-b last:border-0`,children:[e.jsx("td",{className:"px-4 py-2",children:l.mlaName}),e.jsx("td",{className:"px-4 py-2",children:l.iaName}),e.jsx("td",{className:"px-4 py-2 font-medium text-gray-900",children:l.name}),e.jsxs("td",{className:"px-4 py-2 text-right",children:["₹",(o??0).toLocaleString()]}),e.jsxs("td",{className:"px-4 py-2 text-right",children:["₹",(y??0).toLocaleString()]}),e.jsxs("td",{className:"px-4 py-2 text-right",children:["₹",(l.demandAmount??0).toLocaleString()]}),e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-semibold ${l.status==="Approved"?"bg-green-100 text-green-700":l.status==="Pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,"aria-label":l.status,children:nd[l.status]||"❔"})}),e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>{N(l),X(!0)},className:"w-full",children:[e.jsx(vl,{className:"w-4 h-4 mr-1"})," Demand"]}),e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>{const ne=m.slice(-1)[0];A(ne||null),N(l),V(!0)},className:"w-full",children:[e.jsx(Re,{className:"w-4 h-4 mr-1"})," View"]})]})})]},l.id)}),te.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"text-center text-gray-400 py-6",children:"No works match the selected filters"})})]})]})})}),e.jsx(Ie,{value:"pending",children:e.jsxs(O,{children:[e.jsx(se,{children:e.jsx(ee,{children:"Pending Demands"})}),e.jsx($,{children:e.jsx("div",{className:"overflow-x-auto rounded-2xl shadow border border-gray-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Demand ID"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Work Name"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700",children:"View"})]})}),e.jsxs("tbody",{children:[Q.filter(l=>l.status==="Pending").map((l,M)=>{var y;const m=t.find(o=>o.id===l.workId);return e.jsxs("tr",{className:`${M%2===0?"bg-white":"bg-gray-50"} hover:bg-primary/5 transition border-b last:border-0`,children:[e.jsx("td",{className:"px-4 py-2 font-medium text-gray-900",children:l.id}),e.jsx("td",{className:"px-4 py-2",children:(m==null?void 0:m.name)||"N/A"}),e.jsx("td",{className:"px-4 py-2",children:((y=m==null?void 0:m.vendor)==null?void 0:y.name)||"N/A"}),e.jsxs("td",{className:"px-4 py-2 text-right",children:["₹",(l.amount??0).toLocaleString()]}),e.jsx("td",{className:"px-4 py-2 text-center",children:or(l.status)}),e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>{A(l),N(m),V(!0)},children:[e.jsx(Re,{className:"w-4 h-4 mr-1"})," View"]})})]},l.id)}),Q.filter(l=>l.status==="Pending").length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center text-gray-400 py-6",children:"No pending demands"})})]})]})})})]})}),e.jsx(Ie,{value:"approved",children:e.jsxs(O,{children:[e.jsx(se,{children:e.jsx(ee,{children:"Approved Demands"})}),e.jsx($,{children:e.jsx("div",{className:"overflow-x-auto rounded-2xl shadow border border-gray-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Demand ID"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Work Name"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700",children:"View"})]})}),e.jsxs("tbody",{children:[Q.filter(l=>l.status==="Approved").map((l,M)=>{var y;const m=t.find(o=>o.id===l.workId);return e.jsxs("tr",{className:`${M%2===0?"bg-white":"bg-gray-50"} hover:bg-primary/5 transition border-b last:border-0`,children:[e.jsx("td",{className:"px-4 py-2 font-medium text-gray-900",children:l.id}),e.jsx("td",{className:"px-4 py-2",children:(m==null?void 0:m.name)||"N/A"}),e.jsx("td",{className:"px-4 py-2",children:((y=m==null?void 0:m.vendor)==null?void 0:y.name)||"N/A"}),e.jsxs("td",{className:"px-4 py-2 text-right",children:["₹",(l.amount??0).toLocaleString()]}),e.jsx("td",{className:"px-4 py-2 text-center",children:or(l.status)}),e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>{A(l),N(m),V(!0)},children:[e.jsx(Re,{className:"w-4 h-4 mr-1"})," View"]})})]},l.id)}),Q.filter(l=>l.status==="Approved").length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center text-gray-400 py-6",children:"No approved demands"})})]})]})})})]})})]})]})},id=({vendor:s,onBack:r,formatCurrency:t})=>{const n=i=>{switch(i){case"Active":return"bg-green-100 text-green-800";case"Inactive":return"bg-gray-100 text-gray-800";case"Blocked":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"w-full max-w-6xl mx-auto space-y-6 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(L,{variant:"outline",onClick:r,children:[e.jsx(Al,{className:"h-4 w-4 mr-2"}),"Back to List"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:s.name||"N/A"}),e.jsx("p",{className:"text-gray-600",children:"Vendor Details"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(O,{children:[e.jsx(se,{children:e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(wl,{className:"h-5 w-5"}),"Company Information"]})}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Company Name"}),e.jsx("p",{className:"text-sm mt-1",children:s.name||"N/A"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Type"}),e.jsx("p",{className:"text-sm mt-1",children:s.type||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Category"}),e.jsx("p",{className:"text-sm mt-1",children:s.category||"-"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsx("div",{className:"mt-1",children:e.jsx(ye,{className:n(s.status),children:s.status||"N/A"})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Performance Rating"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("span",{className:"text-sm font-medium",children:s.performanceRating!=null?s.performanceRating:"-"}),e.jsx(Cl,{className:"h-4 w-4 text-yellow-500 ml-1"})]})]})]})]}),e.jsxs(O,{children:[e.jsx(se,{children:e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(Sl,{className:"h-5 w-5"}),"Contact Information"]})}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Contact Person"}),e.jsx("p",{className:"text-sm mt-1",children:s.contactPerson||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Phone"}),e.jsx("p",{className:"text-sm mt-1 flex items-center gap-2",children:s.phone||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Email"}),e.jsx("p",{className:"text-sm mt-1 flex items-center gap-2",children:s.email||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Address"}),e.jsxs("p",{className:"text-sm mt-1 flex items-start gap-2",children:[e.jsx(ia,{className:"h-3 w-3 mt-1"}),e.jsxs("span",{children:[s.address||"-",e.jsx("br",{}),s.city||"-",", ",s.state||"-"," - ",s.pincode||"-"]})]})]})]})]})]}),e.jsxs(O,{children:[e.jsx(se,{children:e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(mt,{className:"h-5 w-5"}),"Legal Information"]})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"GST Number"}),e.jsx("p",{className:"text-sm mt-1 font-mono",children:s.gstNumber||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"PAN Number"}),e.jsx("p",{className:"text-sm mt-1 font-mono",children:s.panNumber||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Registration Date"}),e.jsxs("p",{className:"text-sm mt-1 flex items-center gap-2",children:[e.jsx(mt,{className:"h-3 w-3"}),s.registrationDate?new Date(s.registrationDate).toLocaleDateString("en-IN"):"-"]})]})]})})]}),e.jsxs(O,{children:[e.jsx(se,{children:e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(Zt,{className:"h-5 w-5"}),"Bank Details"]})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Account Number"}),e.jsx("p",{className:"text-sm mt-1 font-mono",children:s.bankAccountNumber||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"IFSC Code"}),e.jsx("p",{className:"text-sm mt-1 font-mono",children:s.bankIfsc||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Bank Name"}),e.jsx("p",{className:"text-sm mt-1",children:s.bankName||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Branch"}),e.jsx("p",{className:"text-sm mt-1",children:s.bankBranch||"-"})]})]})})]}),e.jsx("div",{className:"text-sm text-gray-600",children:e.jsxs("p",{children:["Last updated on ",s.lastUpdated?new Date(s.lastUpdated).toLocaleDateString("en-IN"):"-",s.updatedBy&&e.jsxs(e.Fragment,{children:[" by ",s.updatedBy]})]})})]})},dd=()=>{const{toast:s}=os(),[r,t]=a.useState([]),[n,i]=a.useState(""),[x,g]=a.useState(null),[p,d]=a.useState(!1),[j,P]=a.useState(!1);a.useRef(null),a.useEffect(()=>{W()},[]);const W=async()=>{P(!0);try{const b=await me.get("http://13.202.62.178:9090/backend-dfds/api/vendors");t(b.data||[])}catch{s({title:"Failed to Load",description:"Could not fetch vendor data.",variant:"destructive"})}P(!1)},T=N=>N?new Intl.NumberFormat("en-IN").format(Number(N)):"0",J=r.filter(N=>(N.name||"").toLowerCase().includes(n.toLowerCase())||(N.aadhaarNumber||"").includes(n)||(N.gstNumber||"").toLowerCase().includes(n.toLowerCase())||(N.contactPerson||"").toLowerCase().includes(n.toLowerCase())),X=N=>{switch(N){case"Verified":return"bg-green-100 text-green-800";case"Pending":return"bg-yellow-100 text-yellow-800";case"Rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},w=N=>{g(N),d(!0)},V=N=>{s({title:"Edit Vendor",description:`Edit functionality for ${N.name||"Vendor"} will be implemented.`})},F=(N,b)=>{s({title:"Delete Vendor?",description:e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2",children:["Are you sure you want to delete ",e.jsx("span",{className:"font-semibold",children:b||"Vendor"}),"?"]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(L,{size:"sm",className:"bg-red-600 hover:bg-red-700 text-white",onClick:async A=>{try{await me.delete(`http://13.202.62.178:9090/backend-dfds/api/vendors/delete/${N}`),s({title:"Vendor Deleted",description:"Vendor has been removed from the system.",variant:"destructive"}),t(q=>q.filter(Z=>Z.id!==N))}catch{s({title:"Delete Failed",description:"Could not delete vendor.",variant:"destructive"})}},children:"Yes, Delete"}),e.jsx(L,{size:"sm",variant:"outline",style:{borderColor:"#bbb",color:"#1a1a1a",background:"#fff"},onClick:()=>{},children:"Cancel"})]})]}),variant:"destructive",duration:999999})};return j?e.jsxs("div",{className:"flex justify-center items-center h-72",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-primary"}),e.jsx("span",{className:"ml-3",children:"Loading vendors..."})]}):p&&x?e.jsx(id,{vendor:x,onBack:()=>d(!1),formatCurrency:T}):e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Vendor List"}),e.jsx(Ce,{children:"Manage registered vendors eligible for payments"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(zs,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(_,{placeholder:"Search by name, Aadhaar, GST number...",value:n,onChange:N=>i(N.target.value),className:"pl-9"})]}),e.jsxs(L,{variant:"outline",children:[e.jsx(ln,{className:"h-4 w-4 mr-2"}),"Filter"]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(Ke,{children:[e.jsx(Be,{children:e.jsxs(ue,{children:[e.jsx(U,{children:"Vendor Details"}),e.jsx(U,{children:"Aadhaar Number"}),e.jsx(U,{children:"GST Number"}),e.jsx(U,{children:"Verification Status"}),e.jsx(U,{children:"Payment Eligible"}),e.jsx(U,{className:"text-right",children:"Actions"})]})}),e.jsxs(We,{children:[J.length===0&&e.jsx(ue,{children:e.jsxs(h,{colSpan:6,className:"text-center py-8 text-gray-500",children:[e.jsx(xt,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),"No vendors found matching your search criteria."]})}),J.map(N=>e.jsxs(ue,{children:[e.jsx(h,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:N.name}),e.jsx("div",{className:"text-sm text-gray-500",children:N.contactPerson}),e.jsx("div",{className:"text-sm text-gray-500",children:N.phone})]})}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-sm",children:N.aadhaarNumber}),N.aadhaarVerified?e.jsx(qe,{className:"h-4 w-4 text-green-600"}):e.jsx(Ts,{className:"h-4 w-4 text-red-600"})]})}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-sm",children:N.gstNumber}),N.gstVerified?e.jsx(qe,{className:"h-4 w-4 text-green-600"}):e.jsx(Ts,{className:"h-4 w-4 text-red-600"})]})}),e.jsx(h,{children:e.jsx(ye,{className:X(N.verificationStatus),children:N.verificationStatus||"Pending"})}),e.jsx(h,{children:e.jsx(ye,{variant:N.paymentEligible?"default":"secondary",className:N.paymentEligible?"bg-green-100 text-green-800":"",children:N.paymentEligible?"Eligible":"Not Eligible"})}),e.jsx(h,{className:"text-right",children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(L,{variant:"ghost",size:"sm",onClick:()=>w(N),className:"hover:bg-blue-50 hover:text-blue-600",children:e.jsx(Re,{className:"h-4 w-4"})}),e.jsx(L,{variant:"ghost",size:"sm",onClick:()=>V(N),className:"hover:bg-blue-50 hover:text-blue-600",children:e.jsx(Vs,{className:"h-4 w-4"})}),e.jsx(L,{variant:"ghost",size:"sm",onClick:()=>F(N.id,N.name),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(Os,{className:"h-4 w-4"})})]})})]},N.id))]})]})})]})]})},cd=({onCancel:s,onSubmit:r})=>{const{toast:t}=os(),{user:n}=Cs(),[i,x]=a.useState({aadhaarNumber:"",gstNumber:"",panNumber:"",vendorName:"",firmName:"",address:"",bankAccountNumber:"",ifscCode:"",bankName:"",contactNumber:"",email:""}),g=(d,j)=>{x(P=>({...P,[d]:j}))},p=async d=>{if(d.preventDefault(),!i.vendorName||!i.firmName||!i.bankAccountNumber||!i.ifscCode){t({title:"Missing Information",description:"Please fill in all required fields.",variant:"destructive"});return}if(i.panNumber&&!/^[A-Z]{5}[0-9]{4}[A-Z]$/.test(i.panNumber)){t({title:"Invalid PAN Number",description:"Enter a valid 10-character PAN number (e.g., ABCDE1234F).",variant:"destructive"});return}const P=new Date().toISOString().slice(0,10),W={name:i.vendorName,firmName:i.firmName,aadhaarNumber:i.aadhaarNumber,gstNumber:i.gstNumber,panNumber:i.panNumber,contactPerson:"",phone:i.contactNumber,email:i.email,address:i.address,city:"",state:"",pincode:"",registrationDate:P,verificationStatus:"NOT_VERIFIED",aadhaarVerified:!1,gstVerified:!1,type:"",category:"",status:"ACTIVE",performanceRating:0,creditLimit:0,paymentTerms:"",bankAccountNumber:i.bankAccountNumber,bankIfsc:i.ifscCode,bankName:i.bankName,bankBranch:"",documentUrls:[],paymentEligible:!0,lastUpdated:P,updatedBy:(n==null?void 0:n.username)||"",documentFiles:[]};try{await me.post("http://13.202.62.178:9090/backend-dfds/api/vendors/register",W,{headers:{Authorization:`Bearer ${(n==null?void 0:n.token)||""}`,"Content-Type":"application/json"}}),t({title:"Vendor Added",description:"Vendor has been successfully registered."}),r()}catch{t({title:"Registration Failed",description:"Could not register vendor. Please try again.",variant:"destructive"})}};return e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(xt,{className:"h-6 w-6 text-primary"}),"Add New Vendor"]}),e.jsx(Ce,{children:"Register a new vendor with Aadhaar, GST, and PAN details."})]}),e.jsx($,{children:e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-gray-50",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(xt,{className:"h-5 w-5"}),"Identity & Business Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"aadhaarNumber",children:"Aadhaar Number"}),e.jsx(_,{id:"aadhaarNumber",value:i.aadhaarNumber,onChange:d=>g("aadhaarNumber",d.target.value.replace(/\D/g,"").slice(0,12)),placeholder:"Enter 12-digit Aadhaar number",maxLength:12})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"gstNumber",children:"GST Number"}),e.jsx(_,{id:"gstNumber",value:i.gstNumber,onChange:d=>g("gstNumber",d.target.value.toUpperCase().slice(0,15)),placeholder:"Enter 15-character GST number",maxLength:15})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"panNumber",children:"PAN Number"}),e.jsx(_,{id:"panNumber",value:i.panNumber,onChange:d=>g("panNumber",d.target.value.toUpperCase().replace(/[^A-Z0-9]/g,"").slice(0,10)),placeholder:"Enter 10-character PAN",maxLength:10})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"vendorName",children:"Vendor Name *"}),e.jsx(_,{id:"vendorName",value:i.vendorName,onChange:d=>g("vendorName",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"firmName",children:"Firm Name *"}),e.jsx(_,{id:"firmName",value:i.firmName,onChange:d=>g("firmName",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"contactNumber",children:"Contact Number"}),e.jsx(_,{id:"contactNumber",value:i.contactNumber,onChange:d=>g("contactNumber",d.target.value),placeholder:""})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"email",children:"Email Address"}),e.jsx(_,{id:"email",type:"email",value:i.email,onChange:d=>g("email",d.target.value),placeholder:"Enter email address"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Bank Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"bankAccountNumber",children:"Bank Account Number *"}),e.jsx(_,{id:"bankAccountNumber",value:i.bankAccountNumber,onChange:d=>g("bankAccountNumber",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"ifscCode",children:"IFSC Code *"}),e.jsx(_,{id:"ifscCode",value:i.ifscCode,onChange:d=>g("ifscCode",d.target.value.toUpperCase()),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(S,{htmlFor:"bankName",children:"Bank Name *"}),e.jsx(_,{id:"bankName",value:i.bankName,onChange:d=>g("bankName",d.target.value),required:!0})]})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4 border-t",children:[e.jsxs(L,{type:"submit",className:"bg-[#193A9A] hover:bg-[#142f7c] text-white",children:[e.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Submit"]}),e.jsxs(L,{type:"button",variant:"outline",onClick:s,children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]})})]})},od=()=>{const{toast:s}=os(),[r,t]=a.useState({type:"",item:null}),[n,i]=a.useState(""),[x,g]=a.useState(""),[p,d]=a.useState([{id:"1",name:"Construction",description:"Construction and Infrastructure",isActive:!0},{id:"2",name:"IT Services",description:"Information Technology Services",isActive:!0},{id:"3",name:"Supplies",description:"Office and General Supplies",isActive:!0},{id:"4",name:"Consulting",description:"Professional Consulting Services",isActive:!0},{id:"5",name:"Maintenance",description:"Maintenance and Repair Services",isActive:!0},{id:"6",name:"Transport",description:"Transportation Services",isActive:!0},{id:"7",name:"Catering",description:"Catering and Food Services",isActive:!0},{id:"8",name:"Security",description:"Security Services",isActive:!0},{id:"9",name:"Cleaning",description:"Cleaning and Housekeeping",isActive:!0},{id:"10",name:"Equipment Rental",description:"Equipment Rental Services",isActive:!0}]),[j,P]=a.useState([{id:"1",name:"15 days",description:"Payment due within 15 days",isActive:!0},{id:"2",name:"30 days",description:"Payment due within 30 days",isActive:!0},{id:"3",name:"45 days",description:"Payment due within 45 days",isActive:!0},{id:"4",name:"60 days",description:"Payment due within 60 days",isActive:!0},{id:"5",name:"90 days",description:"Payment due within 90 days",isActive:!0}]),[W,T]=a.useState([{id:"1",name:"Individual",description:"Individual Vendor/Proprietor",isActive:!0},{id:"2",name:"Company",description:"Private Limited Company",isActive:!0},{id:"3",name:"Partnership",description:"Partnership Firm",isActive:!0},{id:"4",name:"LLP",description:"Limited Liability Partnership",isActive:!0}]),J=(b,A,C)=>{if(!n.trim())return;const q={id:Date.now().toString(),name:n.trim(),description:x.trim()||void 0,isActive:!0};C([...A,q]),i(""),g(""),s({title:"Item Added",description:`${n} has been added to ${b}.`})},X=(b,A)=>{t({type:b,item:A}),i(A.name),g(A.description||"")},w=(b,A,C)=>{if(!r.item||!n.trim())return;const q=A.map(Z=>Z.id===r.item.id?{...Z,name:n.trim(),description:x.trim()||void 0}:Z);C(q),t({type:"",item:null}),i(""),g(""),s({title:"Item Updated",description:`${n} has been updated.`})},V=(b,A,C,q)=>{const Z=C.find(B=>B.id===A);Z&&window.confirm(`Are you sure you want to delete "${Z.name}"?`)&&(q(C.filter(B=>B.id!==A)),s({title:"Item Deleted",description:`${Z.name} has been removed.`,variant:"destructive"}))},F=(b,A,C)=>{const q=A.map(Z=>Z.id===b?{...Z,isActive:!Z.isActive}:Z);C(q)},N=(b,A,C,q)=>e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:b}),e.jsxs(Ce,{children:["Manage ",b.toLowerCase()," used in vendor management"]})]}),e.jsxs($,{className:"space-y-4",children:[e.jsx("div",{className:"border rounded-lg p-4 bg-gray-50",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:`${A}-name`,children:"Name"}),e.jsx(_,{id:`${A}-name`,value:n,onChange:Z=>i(Z.target.value),placeholder:"Enter name"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:`${A}-description`,children:"Description"}),e.jsx(_,{id:`${A}-description`,value:x,onChange:Z=>g(Z.target.value),placeholder:"Enter description (optional)"})]}),e.jsx("div",{className:"flex items-end",children:r.type===A&&r.item?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(L,{onClick:()=>w(A,C,q),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Save"]}),e.jsx(L,{variant:"outline",onClick:()=>{t({type:"",item:null}),i(""),g("")},children:e.jsx(fs,{className:"h-4 w-4"})})]}):e.jsxs(L,{onClick:()=>J(A,C,q),className:"bg-[#193A9A] hover:bg-[#142f7c] text-white",children:[e.jsx(ps,{className:"h-4 w-4 mr-2"}),"Add"]})})]})}),e.jsx("div",{className:"space-y-2",children:C.map(Z=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-medium",children:Z.name}),e.jsx(ye,{variant:Z.isActive?"default":"secondary",children:Z.isActive?"Active":"Inactive"})]}),Z.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:Z.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{variant:"ghost",size:"sm",onClick:()=>F(Z.id,C,q),className:Z.isActive?"text-yellow-600 hover:text-yellow-700":"text-green-600 hover:text-green-700",children:Z.isActive?"Deactivate":"Activate"}),e.jsx(L,{variant:"ghost",size:"sm",onClick:()=>X(A,Z),className:"text-blue-600 hover:text-blue-700",children:e.jsx(Vs,{className:"h-4 w-4"})}),e.jsx(L,{variant:"ghost",size:"sm",onClick:()=>V(A,Z.id,C,q),className:"text-red-600 hover:text-red-700",children:e.jsx(Os,{className:"h-4 w-4"})})]})]},Z.id))})]})]});return e.jsx("div",{className:"space-y-6",children:e.jsxs(Qs,{defaultValue:"categories",className:"w-full",children:[e.jsxs(Us,{className:"grid w-full grid-cols-3",children:[e.jsx(Ve,{value:"categories",children:"Categories"}),e.jsx(Ve,{value:"payment",children:"Payment Terms"}),e.jsx(Ve,{value:"types",children:"Vendor Types"})]}),e.jsx(Ie,{value:"categories",className:"space-y-4",children:N("Vendor Categories","categories",p,d)}),e.jsx(Ie,{value:"payment",className:"space-y-4",children:N("Payment Terms","payment",j,P)}),e.jsx(Ie,{value:"types",className:"space-y-4",children:N("Vendor Types","types",W,T)})]})})},md=()=>{const{toast:s}=os(),[r,t]=a.useState(""),[n,i]=a.useState(""),[x,g]=a.useState(!1),[p,d]=a.useState(null),j=async()=>{if(!r||r.length!==12){s({title:"Invalid Aadhaar Number",description:"Please enter a valid 12-digit Aadhaar number.",variant:"destructive"});return}g(!0),setTimeout(()=>{d({aadhaarValid:!0,gstValid:!1,vendorName:"Rajesh Kumar Sharma",address:"123, MG Road, Mumbai, Maharashtra - 400001",message:"Aadhaar verification successful"}),g(!1),s({title:"Aadhaar Verified",description:"Vendor identity verified successfully."})},2e3)},P=async()=>{if(!n||n.length!==15){s({title:"Invalid GST Number",description:"Please enter a valid 15-character GST number.",variant:"destructive"});return}g(!0),setTimeout(()=>{const T={aadhaarValid:(p==null?void 0:p.aadhaarValid)||!1,gstValid:!0,vendorName:(p==null?void 0:p.vendorName)||"OM Nikas",address:"Tech Solutions Pvt Ltd, 123, MG Road, Pune, Maharashtra - 400001",bankDetails:{accountNumber:"89234492472",ifsc:"ICIC0001234",bankName:"ICICI Bank"},message:"GST verification successful"};d(T),g(!1),s({title:"GST Verified",description:"Vendor GST details verified successfully."})},2e3)},W=()=>{p!=null&&p.aadhaarValid&&(p!=null&&p.gstValid)?(s({title:"Vendor Verification Complete",description:"Vendor has been successfully verified and can now receive payments."}),t(""),i(""),d(null)):s({title:"Incomplete Verification",description:"Please complete both Aadhaar and GST verification.",variant:"destructive"})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(xt,{className:"h-6 w-6 text-primary"}),"Vendor Verification"]}),e.jsx(Ce,{children:"Verify vendor identity using Aadhaar and GST APIs before processing payments"})]}),e.jsxs($,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"aadhaar",children:"Aadhaar Number *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{id:"aadhaar",value:r,onChange:T=>t(T.target.value.replace(/\D/g,"").slice(0,12)),placeholder:"Enter 12-digit Aadhaar number",maxLength:12}),e.jsxs(L,{onClick:j,disabled:x||r.length!==12,className:"whitespace-nowrap",children:[e.jsx(Es,{className:"h-4 w-4 mr-2"}),x?"Verifying...":"Verify"]})]})]}),p&&e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[p.aadhaarValid?e.jsx(qe,{className:"h-5 w-5 text-green-600"}):e.jsx(Ts,{className:"h-5 w-5 text-red-600"}),e.jsx("span",{className:"font-medium",children:"Aadhaar Status"}),e.jsx(ye,{variant:p.aadhaarValid?"default":"destructive",children:p.aadhaarValid?"Verified":"Failed"})]}),p.aadhaarValid&&e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",p.vendorName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",p.address]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"gst",children:"GST Number *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{id:"gst",value:n,onChange:T=>i(T.target.value.toUpperCase().slice(0,15)),placeholder:"Enter 15-character GST number",maxLength:15}),e.jsxs(L,{onClick:P,disabled:x||n.length!==15,className:"whitespace-nowrap",children:[e.jsx(Zt,{className:"h-4 w-4 mr-2"}),x?"Verifying...":"Verify"]})]})]}),p&&e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[p.gstValid?e.jsx(qe,{className:"h-5 w-5 text-green-600"}):e.jsx(Ts,{className:"h-5 w-5 text-red-600"}),e.jsx("span",{className:"font-medium",children:"GST Status"}),e.jsx(ye,{variant:p.gstValid?"default":"destructive",children:p.gstValid?"Verified":"Failed"})]}),p.gstValid&&p.bankDetails&&e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Business Name:"})," ",p.vendorName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Bank:"})," ",p.bankDetails.bankName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Account:"})," ",p.bankDetails.accountNumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"IFSC:"})," ",p.bankDetails.ifsc]})]})]})]})]}),p&&e.jsx("div",{className:"pt-4 border-t",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Verification Status:"}),p.aadhaarValid&&p.gstValid?e.jsxs(ye,{className:"bg-green-100 text-green-800",children:[e.jsx(qe,{className:"h-4 w-4 mr-1"}),"Complete"]}):e.jsxs(ye,{variant:"secondary",children:[e.jsx(Qt,{className:"h-4 w-4 mr-1"}),"Incomplete"]})]})}),e.jsxs(L,{onClick:W,disabled:!p.aadhaarValid||!p.gstValid,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"Complete Verification"]})]})})]})]}),e.jsxs(O,{children:[e.jsx(se,{children:e.jsx(ee,{children:"Verification Instructions"})}),e.jsx($,{children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mt-2"}),e.jsx("p",{children:"Enter the vendor's 12-digit Aadhaar number for identity verification"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mt-2"}),e.jsx("p",{children:"Enter the vendor's 15-character GST number for business verification"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mt-2"}),e.jsx("p",{children:"Both verifications must be successful before the vendor can receive payments"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mt-2"}),e.jsx("p",{children:"Bank details will be automatically fetched from GST portal upon successful verification"})]})]})})]})]})},xd=()=>{const[s,r]=a.useState(!1),[t,n]=a.useState("list"),i=()=>{r(!0),n("form")},x=()=>{r(!1),n("list")},g=()=>{r(!1),n("list")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(Ns,{className:"h-8 w-8 text-primary"}),"Vendor Management"]}),e.jsx("p",{className:"text-gray-600",children:"Manage vendor information, verification, and relationships"})]}),e.jsxs(L,{onClick:i,children:[e.jsx(ps,{className:"h-4 w-4 mr-2"}),"Add New Vendor"]})]}),e.jsxs(Qs,{value:t,onValueChange:n,children:[e.jsxs(Us,{children:[e.jsx(Ve,{value:"list",children:"Vendor List"}),e.jsx(Ve,{value:"form",children:"Add Vendor"})]}),e.jsx(Ie,{value:"list",children:e.jsx(dd,{})}),e.jsx(Ie,{value:"form",children:e.jsx(cd,{onCancel:x,onSubmit:g})}),e.jsx(Ie,{value:"verification",children:e.jsx(md,{})}),e.jsx(Ie,{value:"master",children:e.jsx(od,{})})]})]})},hd=()=>{const s=kl();return a.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",s.pathname)},[s.pathname]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),e.jsx("a",{href:"/login",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},ud={light:"",dark:".dark"},On=a.createContext(null);function Vn(){const s=a.useContext(On);if(!s)throw new Error("useChart must be used within a <ChartContainer />");return s}const $s=a.forwardRef(({id:s,className:r,children:t,config:n,...i},x)=>{const g=a.useId(),p=`chart-${s||g.replace(/:/g,"")}`;return e.jsx(On.Provider,{value:{config:n},children:e.jsxs("div",{"data-chart":p,ref:x,className:ie("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",r),...i,children:[e.jsx(pd,{id:p,config:n}),e.jsx(Ma,{children:t})]})})});$s.displayName="Chart";const pd=({id:s,config:r})=>{const t=Object.entries(r).filter(([n,i])=>i.theme||i.color);return t.length?e.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(ud).map(([n,i])=>`
${i} [data-chart=${s}] {
${t.map(([x,g])=>{var d;const p=((d=g.theme)==null?void 0:d[n])||g.color;return p?`  --color-${x}: ${p};`:null}).join(`
`)}
}
`).join(`
`)}}):null},Js=Pa,pt=a.forwardRef(({active:s,payload:r,className:t,indicator:n="dot",hideLabel:i=!1,hideIndicator:x=!1,label:g,labelFormatter:p,labelClassName:d,formatter:j,color:P,nameKey:W,labelKey:T},J)=>{const{config:X}=Vn(),w=a.useMemo(()=>{var C;if(i||!(r!=null&&r.length))return null;const[F]=r,N=`${T||F.dataKey||F.name||"value"}`,b=Ra(X,F,N),A=!T&&typeof g=="string"?((C=X[g])==null?void 0:C.label)||g:b==null?void 0:b.label;return p?e.jsx("div",{className:ie("font-medium",d),children:p(A,r)}):A?e.jsx("div",{className:ie("font-medium",d),children:A}):null},[g,p,r,i,d,X,T]);if(!s||!(r!=null&&r.length))return null;const V=r.length===1&&n!=="dot";return e.jsxs("div",{ref:J,className:ie("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",t),children:[V?null:w,e.jsx("div",{className:"grid gap-1.5",children:r.map((F,N)=>{const b=`${W||F.name||F.dataKey||"value"}`,A=Ra(X,F,b),C=P||F.payload.fill||F.color;return e.jsx("div",{className:ie("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",n==="dot"&&"items-center"),children:j&&(F==null?void 0:F.value)!==void 0&&F.name?j(F.value,F.name,F,N,F.payload):e.jsxs(e.Fragment,{children:[A!=null&&A.icon?e.jsx(A.icon,{}):!x&&e.jsx("div",{className:ie("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":n==="dot","w-1":n==="line","w-0 border-[1.5px] border-dashed bg-transparent":n==="dashed","my-0.5":V&&n==="dashed"}),style:{"--color-bg":C,"--color-border":C}}),e.jsxs("div",{className:ie("flex flex-1 justify-between leading-none",V?"items-end":"items-center"),children:[e.jsxs("div",{className:"grid gap-1.5",children:[V?w:null,e.jsx("span",{className:"text-muted-foreground",children:(A==null?void 0:A.label)||F.name})]}),F.value&&e.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:F.value.toLocaleString()})]})]})},F.dataKey)})})]})});pt.displayName="ChartTooltip";const jd=a.forwardRef(({className:s,hideIcon:r=!1,payload:t,verticalAlign:n="bottom",nameKey:i},x)=>{const{config:g}=Vn();return t!=null&&t.length?e.jsx("div",{ref:x,className:ie("flex items-center justify-center gap-4",n==="top"?"pb-3":"pt-3",s),children:t.map(p=>{const d=`${i||p.dataKey||"value"}`,j=Ra(g,p,d);return e.jsxs("div",{className:ie("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[j!=null&&j.icon&&!r?e.jsx(j.icon,{}):e.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:p.color}}),j==null?void 0:j.label]},p.value)})}):null});jd.displayName="ChartLegend";function Ra(s,r,t){if(typeof r!="object"||r===null)return;const n="payload"in r&&typeof r.payload=="object"&&r.payload!==null?r.payload:void 0;let i=t;return t in r&&typeof r[t]=="string"?i=r[t]:n&&t in n&&typeof n[t]=="string"&&(i=n[t]),i in s?s[i]:s[t]}const gd=({filters:s})=>{const r=[{month:"Jan",allocated:4.2,utilized:3.8,pending:.4},{month:"Feb",allocated:3.8,utilized:3.5,pending:.3},{month:"Mar",allocated:5.1,utilized:4.2,pending:.9},{month:"Apr",allocated:4.5,utilized:4.1,pending:.4},{month:"May",allocated:6.2,utilized:5.8,pending:.4},{month:"Jun",allocated:5.8,utilized:5.2,pending:.6}],t=[{name:"PWD",value:35,amount:15.75},{name:"Health",value:25,amount:11.25},{name:"Education",value:20,amount:9},{name:"Rural Dev",value:12,amount:5.4},{name:"Urban Dev",value:8,amount:3.6}],n=[{month:"Jan",utilization:78},{month:"Feb",utilization:82},{month:"Mar",utilization:75},{month:"Apr",utilization:88},{month:"May",utilization:85},{month:"Jun",utilization:92}],i=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"],x={allocated:{label:"Allocated",color:"#2563eb"},utilized:{label:"Utilized",color:"#16a34a"},pending:{label:"Pending",color:"#dc2626"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Monthly Fund Allocation & Utilization"}),e.jsx(Ce,{children:"Comparison of allocated vs utilized funds (₹ Crores)"})]}),e.jsx($,{children:e.jsx($s,{config:x,className:"h-80",children:e.jsxs($a,{data:r,children:[e.jsx(Ot,{strokeDasharray:"3 3"}),e.jsx(ht,{dataKey:"month"}),e.jsx(ut,{}),e.jsx(Js,{content:e.jsx(pt,{})}),e.jsx(qs,{dataKey:"allocated",fill:"var(--color-allocated)"}),e.jsx(qs,{dataKey:"utilized",fill:"var(--color-utilized)"}),e.jsx(qs,{dataKey:"pending",fill:"var(--color-pending)"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Department-wise Fund Allocation"}),e.jsx(Ce,{children:"Distribution of funds across departments"})]}),e.jsx($,{children:e.jsx($s,{config:x,className:"h-80",children:e.jsxs(za,{children:[e.jsx(Ua,{data:t,cx:"50%",cy:"50%",labelLine:!1,label:({name:g,percent:p})=>`${g} ${(p*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:t.map((g,p)=>e.jsx(Ba,{fill:i[p%i.length]},`cell-${p}`))}),e.jsx(Js,{})]})})})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Fund Utilization Trend"}),e.jsx(Ce,{children:"Monthly utilization percentage"})]}),e.jsx($,{children:e.jsx($s,{config:x,className:"h-80",children:e.jsxs(un,{data:n,children:[e.jsx(Ot,{strokeDasharray:"3 3"}),e.jsx(ht,{dataKey:"month"}),e.jsx(ut,{}),e.jsx(Js,{content:e.jsx(pt,{})}),e.jsx(Ea,{type:"monotone",dataKey:"utilization",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.6})]})})})]})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Financial Summary"}),e.jsx(Ce,{children:"Detailed breakdown of financial metrics"})]}),e.jsx($,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Metric"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-right",children:"Current Month"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-right",children:"Previous Month"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-right",children:"Change"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2 font-medium",children:"Total Allocation"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right",children:"₹5.8 Cr"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right",children:"₹6.2 Cr"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right text-red-600",children:"-6.5%"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2 font-medium",children:"Fund Utilization"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right",children:"₹5.2 Cr"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right",children:"₹5.8 Cr"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right text-red-600",children:"-10.3%"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2 font-medium",children:"Pending Amount"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right",children:"₹0.6 Cr"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right",children:"₹0.4 Cr"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right text-green-600",children:"+50.0%"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2 font-medium",children:"Utilization Rate"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right",children:"89.7%"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right",children:"93.5%"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right text-red-600",children:"-3.8%"})]})]})]})})})]})]})},Nd=({filters:s})=>{const r=[{dept:"PWD",projects:45,completed:38,budget:15.75,utilized:14.2},{dept:"Health",projects:32,completed:28,budget:11.25,utilized:10.8},{dept:"Education",projects:28,completed:22,budget:9,utilized:8.1},{dept:"Rural Dev",projects:18,completed:15,budget:5.4,utilized:4.9},{dept:"Urban Dev",projects:12,completed:9,budget:3.6,utilized:3.2}],t=[{month:"Jan",PWD:85,Health:78,Education:82},{month:"Feb",PWD:88,Health:82,Education:79},{month:"Mar",PWD:82,Health:85,Education:88},{month:"Apr",PWD:91,Health:87,Education:85},{month:"May",PWD:89,Health:89,Education:92},{month:"Jun",PWD:93,Health:91,Education:89}],n={projects:{label:"Total Projects",color:"#2563eb"},completed:{label:"Completed",color:"#16a34a"},budget:{label:"Budget (₹ Cr)",color:"#dc2626"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(O,{children:[e.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(ee,{className:"text-sm font-medium",children:"Total Departments"}),e.jsx(Va,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs($,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"24"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active departments"})]})]}),e.jsxs(O,{children:[e.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(ee,{className:"text-sm font-medium",children:"Total Staff"}),e.jsx(Ns,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs($,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"1,247"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all departments"})]})]}),e.jsxs(O,{children:[e.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(ee,{className:"text-sm font-medium",children:"Active Projects"}),e.jsx(ze,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs($,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"135"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"In progress"})]})]}),e.jsxs(O,{children:[e.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(ee,{className:"text-sm font-medium",children:"Avg Performance"}),e.jsx(Rs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs($,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"87.2%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Project completion rate"})]})]})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Department Performance Comparison"}),e.jsx(Ce,{children:"Projects and budget utilization by department"})]}),e.jsx($,{children:e.jsx($s,{config:n,className:"h-80",children:e.jsxs($a,{data:r,children:[e.jsx(Ot,{strokeDasharray:"3 3"}),e.jsx(ht,{dataKey:"dept"}),e.jsx(ut,{}),e.jsx(Js,{content:e.jsx(pt,{})}),e.jsx(qs,{dataKey:"projects",fill:"var(--color-projects)"}),e.jsx(qs,{dataKey:"completed",fill:"var(--color-completed)"})]})})})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Department Performance Trend"}),e.jsx(Ce,{children:"Monthly performance trend for top departments"})]}),e.jsx($,{children:e.jsx($s,{config:n,className:"h-80",children:e.jsxs(_l,{data:t,children:[e.jsx(Ot,{strokeDasharray:"3 3"}),e.jsx(ht,{dataKey:"month"}),e.jsx(ut,{}),e.jsx(Js,{content:e.jsx(pt,{})}),e.jsx(ua,{type:"monotone",dataKey:"PWD",stroke:"#8884d8",strokeWidth:2}),e.jsx(ua,{type:"monotone",dataKey:"Health",stroke:"#82ca9d",strokeWidth:2}),e.jsx(ua,{type:"monotone",dataKey:"Education",stroke:"#ffc658",strokeWidth:2})]})})})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Department Performance Details"}),e.jsx(Ce,{children:"Comprehensive department-wise breakdown"})]}),e.jsx($,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Department"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Total Projects"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Completed"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Budget (₹ Cr)"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Utilized (₹ Cr)"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Success Rate"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Status"})]})}),e.jsx("tbody",{children:r.map(i=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2 font-medium",children:i.dept}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:i.projects}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:i.completed}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2 text-center",children:["₹",i.budget]}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2 text-center",children:["₹",i.utilized]}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2 text-center",children:[(i.completed/i.projects*100).toFixed(1),"%"]}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:e.jsx(ye,{variant:i.completed/i.projects>.8?"default":"secondary",children:i.completed/i.projects>.8?"Excellent":"Good"})})]},i.dept))})]})})})]})]})},Oa=a.forwardRef(({className:s,value:r,...t},n)=>e.jsx(dn,{ref:n,className:ie("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...t,children:e.jsx(Ll,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}})}));Oa.displayName=dn.displayName;const fd=({filters:s})=>{const r=[{name:"Completed",value:45,count:45},{name:"In Progress",value:35,count:35},{name:"Pending",value:15,count:15},{name:"Cancelled",value:5,count:5}],t=[{month:"Jan",completed:8,started:12,cancelled:1},{month:"Feb",completed:12,started:10,cancelled:0},{month:"Mar",completed:15,started:18,cancelled:2},{month:"Apr",completed:10,started:8,cancelled:1},{month:"May",completed:18,started:15,cancelled:0},{month:"Jun",completed:14,started:12,cancelled:1}],n=[{category:"Infrastructure",count:32,budget:18.5,progress:78},{category:"Healthcare",count:28,budget:12.3,progress:85},{category:"Education",count:24,budget:9.8,progress:82},{category:"Agriculture",count:18,budget:7.2,progress:75},{category:"Technology",count:15,budget:5.4,progress:88}],i=[{id:"MH-2024-001",name:"Rural Road Development Phase 2",department:"PWD",budget:2.5,progress:85,status:"In Progress",startDate:"2024-01-15",expectedCompletion:"2024-08-30"},{id:"MH-2024-002",name:"Primary Health Center Upgrade",department:"Health",budget:1.8,progress:95,status:"Nearly Complete",startDate:"2024-02-01",expectedCompletion:"2024-07-15"},{id:"MH-2024-003",name:"Digital Classroom Initiative",department:"Education",budget:3.2,progress:60,status:"In Progress",startDate:"2024-03-10",expectedCompletion:"2024-12-20"}],x=["#0088FE","#00C49F","#FFBB28","#FF8042"],g={completed:{label:"Completed",color:"#16a34a"},started:{label:"Started",color:"#2563eb"},cancelled:{label:"Cancelled",color:"#dc2626"}},p=d=>{switch(d){case"Completed":return"default";case"In Progress":return"secondary";case"Nearly Complete":return"outline";default:return"destructive"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(O,{children:[e.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(ee,{className:"text-sm font-medium",children:"Total Works"}),e.jsx(mt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs($,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"128"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All time Works"})]})]}),e.jsxs(O,{children:[e.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(ee,{className:"text-sm font-medium",children:"In Progress"}),e.jsx(ys,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs($,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"45"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active Works"})]})]}),e.jsxs(O,{children:[e.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(ee,{className:"text-sm font-medium",children:"Completed"}),e.jsx(qe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs($,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"67"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Successfully completed"})]})]}),e.jsxs(O,{children:[e.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(ee,{className:"text-sm font-medium",children:"At Risk"}),e.jsx(Qt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs($,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"8"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Behind schedule"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Project Status Distribution"}),e.jsx(Ce,{children:"Current status of all projects"})]}),e.jsx($,{children:e.jsx($s,{config:g,className:"h-80",children:e.jsxs(za,{children:[e.jsx(Ua,{data:r,cx:"50%",cy:"50%",labelLine:!1,label:({name:d,percent:j})=>`${d} ${(j*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:r.map((d,j)=>e.jsx(Ba,{fill:x[j%x.length]},`cell-${j}`))}),e.jsx(Js,{})]})})})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Monthly Project Activity"}),e.jsx(Ce,{children:"Project starts and completions by month"})]}),e.jsx($,{children:e.jsx($s,{config:g,className:"h-80",children:e.jsxs(un,{data:t,children:[e.jsx(Ot,{strokeDasharray:"3 3"}),e.jsx(ht,{dataKey:"month"}),e.jsx(ut,{}),e.jsx(Js,{content:e.jsx(pt,{})}),e.jsx(Ea,{type:"monotone",dataKey:"completed",stackId:"1",stroke:"var(--color-completed)",fill:"var(--color-completed)"}),e.jsx(Ea,{type:"monotone",dataKey:"started",stackId:"1",stroke:"var(--color-started)",fill:"var(--color-started)"})]})})})]})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Projects by Category"}),e.jsx(Ce,{children:"Project distribution and progress by category"})]}),e.jsx($,{children:e.jsx("div",{className:"space-y-4",children:n.map(d=>e.jsx("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium",children:d.category}),e.jsxs("span",{className:"text-sm text-gray-600",children:[d.count," projects"]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Budget: ₹",d.budget," Cr"]}),e.jsxs("span",{className:"text-sm font-medium",children:[d.progress,"%"]})]}),e.jsx(Oa,{value:d.progress,className:"h-2"})]})},d.category))})})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Recent Projects"}),e.jsx(Ce,{children:"Latest project updates and status"})]}),e.jsx($,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Project ID"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Department"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Budget"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Progress"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Status"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Expected Completion"})]})}),e.jsx("tbody",{children:i.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2 font-mono text-sm",children:d.id}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:e.jsx("div",{className:"font-medium",children:d.name})}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:d.department}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2 text-center",children:["₹",d.budget," Cr"]}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oa,{value:d.progress,className:"flex-1 h-2"}),e.jsxs("span",{className:"text-sm",children:[d.progress,"%"]})]})}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:e.jsx(ye,{variant:p(d.status),children:d.status})}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center text-sm",children:new Date(d.expectedCompletion).toLocaleDateString("en-IN")})]},d.id))})]})})})]})]})},bd=({filters:s,onFiltersChange:r})=>{const t=(i,x)=>{r({...s,[i]:x})},n=()=>{r({dateRange:"last30days",department:"all",district:"all",status:"all"})};return e.jsxs(O,{children:[e.jsx(se,{children:e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(ln,{className:"h-5 w-5"}),"Report Filters"]})}),e.jsx($,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Date Range"}),e.jsxs(Ne,{value:s.dateRange,onValueChange:i=>t("dateRange",i),children:[e.jsxs(je,{children:[e.jsx(mt,{className:"h-4 w-4 mr-2"}),e.jsx(fe,{})]}),e.jsxs(ge,{children:[e.jsx(ae,{value:"last7days",children:"Last 7 Days"}),e.jsx(ae,{value:"last30days",children:"Last 30 Days"}),e.jsx(ae,{value:"last3months",children:"Last 3 Months"}),e.jsx(ae,{value:"last6months",children:"Last 6 Months"}),e.jsx(ae,{value:"lastyear",children:"Last Year"}),e.jsx(ae,{value:"custom",children:"Custom Range"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Department"}),e.jsxs(Ne,{value:s.department,onValueChange:i=>t("department",i),children:[e.jsx(je,{children:e.jsx(fe,{})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"all",children:"All Departments"}),e.jsx(ae,{value:"PWD",children:"Public Works Department"}),e.jsx(ae,{value:"HEALTH",children:"Health Department"}),e.jsx(ae,{value:"EDUCATION",children:"Education Department"}),e.jsx(ae,{value:"RURAL",children:"Rural Development"}),e.jsx(ae,{value:"URBAN",children:"Urban Development"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"District"}),e.jsxs(Ne,{value:s.district,onValueChange:i=>t("district",i),children:[e.jsx(je,{children:e.jsx(fe,{})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"all",children:"All Districts"}),e.jsx(ae,{value:"mumbai",children:"Mumbai"}),e.jsx(ae,{value:"pune",children:"Pune"}),e.jsx(ae,{value:"nagpur",children:"Nagpur"}),e.jsx(ae,{value:"nashik",children:"Nashik"}),e.jsx(ae,{value:"aurangabad",children:"Aurangabad"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Status"}),e.jsxs(Ne,{value:s.status,onValueChange:i=>t("status",i),children:[e.jsx(je,{children:e.jsx(fe,{})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"all",children:"All Status"}),e.jsx(ae,{value:"active",children:"Active"}),e.jsx(ae,{value:"completed",children:"Completed"}),e.jsx(ae,{value:"pending",children:"Pending"}),e.jsx(ae,{value:"cancelled",children:"Cancelled"})]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(L,{variant:"outline",onClick:n,className:"w-full",children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Reset"]})})]})})]})},wa=()=>{const[s,r]=a.useState({dateRange:"last30days",department:"all",district:"all",status:"all"}),t=i=>{console.log(`Exporting report as ${i}`)},n=[{title:"Total Fund Allocation",value:"₹45.2 Cr",change:"+12.3%",icon:Rs,color:"text-green-600"},{title:"Active works",value:"128",change:"+5.2%",icon:ze,color:"text-blue-600"},{title:"Departments",value:"24",change:"0%",icon:dt,color:"text-purple-600"},{title:"Fund Utilization",value:"78.5%",change:"+3.1%",icon:La,color:"text-orange-600"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Reports & Analytics"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive financial and operational insights"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(L,{variant:"outline",onClick:()=>t("pdf"),children:[e.jsx(Xs,{className:"h-4 w-4 mr-2"}),"Export PDF"]}),e.jsxs(L,{variant:"outline",onClick:()=>t("excel"),children:[e.jsx(Xs,{className:"h-4 w-4 mr-2"}),"Export Excel"]})]})]}),e.jsx(bd,{filters:s,onFiltersChange:r}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:n.map(i=>e.jsxs(O,{children:[e.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(ee,{className:"text-sm font-medium text-gray-600",children:i.title}),e.jsx(i.icon,{className:`h-4 w-4 ${i.color}`})]}),e.jsxs($,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i.value}),e.jsxs("p",{className:`text-xs ${i.color} mt-1`,children:[i.change," from last period"]})]})]},i.title))}),e.jsxs(Qs,{defaultValue:"financial",className:"space-y-6",children:[e.jsxs(Us,{className:"grid w-full grid-cols-3",children:[e.jsx(Ve,{value:"financial",children:"Financial Reports"}),e.jsx(Ve,{value:"department",children:"Department Reports"}),e.jsx(Ve,{value:"project",children:"work Reports"})]}),e.jsx(Ie,{value:"financial",children:e.jsx(gd,{filters:s})}),e.jsx(Ie,{value:"department",children:e.jsx(Nd,{filters:s})}),e.jsx(Ie,{value:"project",children:e.jsx(fd,{filters:s})})]})]})},yd=()=>{const[s,r]=a.useState([{id:1,name:"Mumbai",code:"MUM",description:"Mumbai District"},{id:2,name:"Pune",code:"PUN",description:"Pune District"},{id:3,name:"Nashik",code:"NAS",description:"Nashik District"}]),[t,n]=a.useState([{id:1,name:"Rural Development Scheme",code:"RDS",description:"Scheme for rural area development"},{id:2,name:"Urban Infrastructure",code:"UIS",description:"Urban infrastructure improvement"},{id:3,name:"Education Enhancement",code:"EES",description:"Education system enhancement"}]),[i,x]=a.useState([{id:1,name:"Infrastructure",code:"INF",description:"Infrastructure projects"},{id:2,name:"Social Welfare",code:"SWF",description:"Social welfare programs"},{id:3,name:"Healthcare",code:"HCR",description:"Healthcare initiatives"}]),[g,p]=a.useState({name:"",code:"",description:""}),[d,j]=a.useState({name:"",code:"",description:""}),[P,W]=a.useState({name:"",code:"",description:""}),T=()=>{g.name&&g.code&&(r([...s,{id:Date.now(),...g}]),p({name:"",code:"",description:""}))},J=()=>{d.name&&d.code&&(n([...t,{id:Date.now(),...d}]),j({name:"",code:"",description:""}))},X=()=>{P.name&&P.code&&(x([...i,{id:Date.now(),...P}]),W({name:"",code:"",description:""}))},w=N=>{r(s.filter(b=>b.id!==N))},V=N=>{n(t.filter(b=>b.id!==N))},F=N=>{x(i.filter(b=>b.id!==N))};return e.jsx("div",{className:"space-y-6",children:e.jsxs(Qs,{defaultValue:"districts",className:"space-y-6",children:[e.jsxs(Us,{className:"grid w-full grid-cols-3",children:[e.jsxs(Ve,{value:"districts",className:"flex items-center gap-2",children:[e.jsx(ia,{className:"h-4 w-4"}),"Districts"]}),e.jsxs(Ve,{value:"schemes",className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-4 w-4"}),"Schemes"]}),e.jsxs(Ve,{value:"categories",className:"flex items-center gap-2",children:[e.jsx(Va,{className:"h-4 w-4"}),"Categories"]})]}),e.jsx(Ie,{value:"districts",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Add New District"}),e.jsx(Ce,{children:"Create a new district entry"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"district-name",children:"District Name"}),e.jsx(_,{id:"district-name",value:g.name,onChange:N=>p({...g,name:N.target.value}),placeholder:"Enter district name"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"district-code",children:"District Code"}),e.jsx(_,{id:"district-code",value:g.code,onChange:N=>p({...g,code:N.target.value}),placeholder:"Enter district code"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"district-description",children:"Description"}),e.jsx(Ks,{id:"district-description",value:g.description,onChange:N=>p({...g,description:N.target.value}),placeholder:"Enter description"})]}),e.jsxs(L,{onClick:T,className:"w-full",children:[e.jsx(ps,{className:"h-4 w-4 mr-2"}),"Add District"]})]})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Existing Districts"}),e.jsx(Ce,{children:"Manage existing districts"})]}),e.jsx($,{children:e.jsx("div",{className:"space-y-3",children:s.map(N=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:N.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Code: ",N.code]}),e.jsx("p",{className:"text-sm text-gray-500",children:N.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{variant:"outline",size:"sm",children:e.jsx(Vs,{className:"h-4 w-4"})}),e.jsx(L,{variant:"outline",size:"sm",onClick:()=>w(N.id),children:e.jsx(Os,{className:"h-4 w-4"})})]})]},N.id))})})]})]})}),e.jsx(Ie,{value:"schemes",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Add New Scheme"}),e.jsx(Ce,{children:"Create a new scheme entry"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"scheme-name",children:"Scheme Name"}),e.jsx(_,{id:"scheme-name",value:d.name,onChange:N=>j({...d,name:N.target.value}),placeholder:"Enter scheme name"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"scheme-code",children:"Scheme Code"}),e.jsx(_,{id:"scheme-code",value:d.code,onChange:N=>j({...d,code:N.target.value}),placeholder:"Enter scheme code"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"scheme-description",children:"Description"}),e.jsx(Ks,{id:"scheme-description",value:d.description,onChange:N=>j({...d,description:N.target.value}),placeholder:"Enter description"})]}),e.jsxs(L,{onClick:J,className:"w-full",children:[e.jsx(ps,{className:"h-4 w-4 mr-2"}),"Add Scheme"]})]})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Existing Schemes"}),e.jsx(Ce,{children:"Manage existing schemes"})]}),e.jsx($,{children:e.jsx("div",{className:"space-y-3",children:t.map(N=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:N.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Code: ",N.code]}),e.jsx("p",{className:"text-sm text-gray-500",children:N.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{variant:"outline",size:"sm",children:e.jsx(Vs,{className:"h-4 w-4"})}),e.jsx(L,{variant:"outline",size:"sm",onClick:()=>V(N.id),children:e.jsx(Os,{className:"h-4 w-4"})})]})]},N.id))})})]})]})}),e.jsx(Ie,{value:"categories",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Add New Category"}),e.jsx(Ce,{children:"Create a new project category"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"category-name",children:"Category Name"}),e.jsx(_,{id:"category-name",value:P.name,onChange:N=>W({...P,name:N.target.value}),placeholder:"Enter category name"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"category-code",children:"Category Code"}),e.jsx(_,{id:"category-code",value:P.code,onChange:N=>W({...P,code:N.target.value}),placeholder:"Enter category code"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"category-description",children:"Description"}),e.jsx(Ks,{id:"category-description",value:P.description,onChange:N=>W({...P,description:N.target.value}),placeholder:"Enter description"})]}),e.jsxs(L,{onClick:X,className:"w-full",children:[e.jsx(ps,{className:"h-4 w-4 mr-2"}),"Add Category"]})]})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsx(ee,{children:"Existing Categories"}),e.jsx(Ce,{children:"Manage existing categories"})]}),e.jsx($,{children:e.jsx("div",{className:"space-y-3",children:i.map(N=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:N.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Code: ",N.code]}),e.jsx("p",{className:"text-sm text-gray-500",children:N.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{variant:"outline",size:"sm",children:e.jsx(Vs,{className:"h-4 w-4"})}),e.jsx(L,{variant:"outline",size:"sm",onClick:()=>F(N.id),children:e.jsx(Os,{className:"h-4 w-4"})})]})]},N.id))})})]})]})})]})})},ss=a.forwardRef(({className:s,...r},t)=>e.jsx(cn,{className:ie("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...r,ref:t,children:e.jsx(Dl,{className:ie("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));ss.displayName=cn.displayName;const vd=()=>{const{user:s}=Cs(),[r,t]=a.useState({name:(s==null?void 0:s.name)||"",email:(s==null?void 0:s.email)||"",mobile:(s==null?void 0:s.mobile)||"",district:(s==null?void 0:s.district)||"",department:(s==null?void 0:s.department)||"",designation:(s==null?void 0:s.designation)||""}),[n,i]=a.useState({emailNotifications:!0,smsNotifications:!1,reportAlerts:!0,systemMaintenance:!0,language:"english",theme:"light"}),x=()=>{console.log("Updating profile:",r)},g=()=>{console.log("Updating preferences:",n)};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(Es,{className:"h-5 w-5"}),"Profile Information"]}),e.jsx(Ce,{children:"Update your personal information"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"name",children:"Full Name"}),e.jsx(_,{id:"name",value:r.name,onChange:p=>t({...r,name:p.target.value}),placeholder:"Enter your full name"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"email",children:"Email Address"}),e.jsx(_,{id:"email",type:"email",value:r.email,onChange:p=>t({...r,email:p.target.value}),placeholder:"Enter your email"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"mobile",children:"Mobile Number"}),e.jsx(_,{id:"mobile",value:r.mobile,onChange:p=>t({...r,mobile:p.target.value}),placeholder:"Enter your mobile number"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"designation",children:"Designation"}),e.jsx(_,{id:"designation",value:r.designation,onChange:p=>t({...r,designation:p.target.value}),placeholder:"Enter your designation"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"district",children:"District"}),e.jsxs(Ne,{value:r.district,onValueChange:p=>t({...r,district:p}),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select district"})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"mumbai",children:"Mumbai"}),e.jsx(ae,{value:"pune",children:"Pune"}),e.jsx(ae,{value:"nashik",children:"Nashik"}),e.jsx(ae,{value:"nagpur",children:"Nagpur"})]})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"department",children:"Department"}),e.jsx(_,{id:"department",value:r.department,onChange:p=>t({...r,department:p.target.value}),placeholder:"Enter your department"})]}),e.jsxs(L,{onClick:x,className:"w-full",children:[e.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Update Profile"]})]})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(Ml,{className:"h-5 w-5"}),"Notification Preferences"]}),e.jsx(Ce,{children:"Manage your notification settings"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"email-notifications",children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Receive notifications via email"})]}),e.jsx(ss,{id:"email-notifications",checked:n.emailNotifications,onCheckedChange:p=>i({...n,emailNotifications:p})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"sms-notifications",children:"SMS Notifications"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Receive notifications via SMS"})]}),e.jsx(ss,{id:"sms-notifications",checked:n.smsNotifications,onCheckedChange:p=>i({...n,smsNotifications:p})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"report-alerts",children:"Report Alerts"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Get alerts for new reports"})]}),e.jsx(ss,{id:"report-alerts",checked:n.reportAlerts,onCheckedChange:p=>i({...n,reportAlerts:p})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"system-maintenance",children:"System Maintenance"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Notifications about system updates"})]}),e.jsx(ss,{id:"system-maintenance",checked:n.systemMaintenance,onCheckedChange:p=>i({...n,systemMaintenance:p})})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"language",children:"Language"}),e.jsxs(Ne,{value:n.language,onValueChange:p=>i({...n,language:p}),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select language"})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"english",children:"English"}),e.jsx(ae,{value:"marathi",children:"Marathi"}),e.jsx(ae,{value:"hindi",children:"Hindi"})]})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"theme",children:"Theme"}),e.jsxs(Ne,{value:n.theme,onValueChange:p=>i({...n,theme:p}),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select theme"})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"light",children:"Light"}),e.jsx(ae,{value:"dark",children:"Dark"}),e.jsx(ae,{value:"system",children:"System"})]})]})]}),e.jsxs(L,{onClick:g,className:"w-full",children:[e.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Update Preferences"]})]})]})]})})},Ad=()=>{const[s,r]=a.useState({applicationName:"",version:"1.0.0",maintenanceMode:!1,backupEnabled:!0,autoBackupHours:"24",sessionTimeout:"30",maxFileSize:"10",allowedFileTypes:"pdf,doc,docx,xls,xlsx,jpg,png"}),[t,n]=a.useState({smtpServer:"smtp.gmail.com",smtpPort:"587",smtpUsername:"",smtpPassword:"",fromEmail:"noreply@maharashtra.gov.in",fromName:""}),i=()=>{console.log("Updating system configuration:",s)},x=()=>{console.log("Updating email configuration:",t)},g=()=>{console.log("Starting manual backup...")},p=()=>{console.log("Clearing system cache...")};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(Pl,{className:"h-5 w-5"}),"System Configuration"]}),e.jsx(Ce,{children:"General system settings and configuration"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"app-name",children:"Application Name"}),e.jsx(_,{id:"app-name",value:s.applicationName,onChange:d=>r({...s,applicationName:d.target.value}),placeholder:"Enter application name"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"version",children:"Version"}),e.jsx(_,{id:"version",value:s.version,onChange:d=>r({...s,version:d.target.value}),placeholder:"Enter version"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"maintenance-mode",children:"Maintenance Mode"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Enable to restrict system access"})]}),e.jsx(ss,{id:"maintenance-mode",checked:s.maintenanceMode,onCheckedChange:d=>r({...s,maintenanceMode:d})})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"session-timeout",children:"Session Timeout (minutes)"}),e.jsx(_,{id:"session-timeout",type:"number",value:s.sessionTimeout,onChange:d=>r({...s,sessionTimeout:d.target.value}),placeholder:"Enter session timeout"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"max-file-size",children:"Max File Size (MB)"}),e.jsx(_,{id:"max-file-size",type:"number",value:s.maxFileSize,onChange:d=>r({...s,maxFileSize:d.target.value}),placeholder:"Enter max file size"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"allowed-file-types",children:"Allowed File Types"}),e.jsx(_,{id:"allowed-file-types",value:s.allowedFileTypes,onChange:d=>r({...s,allowedFileTypes:d.target.value}),placeholder:"Enter allowed file types (comma separated)"})]}),e.jsxs(L,{onClick:i,className:"w-full",children:[e.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Update System Settings"]})]})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(El,{className:"h-5 w-5"}),"Email Configuration"]}),e.jsx(Ce,{children:"Configure email server settings"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"smtp-server",children:"SMTP Server"}),e.jsx(_,{id:"smtp-server",value:t.smtpServer,onChange:d=>n({...t,smtpServer:d.target.value}),placeholder:"Enter SMTP server"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"smtp-port",children:"SMTP Port"}),e.jsx(_,{id:"smtp-port",value:t.smtpPort,onChange:d=>n({...t,smtpPort:d.target.value}),placeholder:"Enter SMTP port"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"smtp-username",children:"SMTP Username"}),e.jsx(_,{id:"smtp-username",value:t.smtpUsername,onChange:d=>n({...t,smtpUsername:d.target.value}),placeholder:"Enter SMTP username"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"smtp-password",children:"SMTP Password"}),e.jsx(_,{id:"smtp-password",type:"password",value:t.smtpPassword,onChange:d=>n({...t,smtpPassword:d.target.value}),placeholder:"Enter SMTP password"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"from-email",children:"From Email"}),e.jsx(_,{id:"from-email",type:"email",value:t.fromEmail,onChange:d=>n({...t,fromEmail:d.target.value}),placeholder:"Enter from email"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"from-name",children:"From Name"}),e.jsx(_,{id:"from-name",value:t.fromName,onChange:d=>n({...t,fromName:d.target.value}),placeholder:"Enter from name"})]}),e.jsxs(L,{onClick:x,className:"w-full",children:[e.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Update Email Settings"]})]})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(Da,{className:"h-5 w-5"}),"Backup & Maintenance"]}),e.jsx(Ce,{children:"Manage system backups and maintenance"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"backup-enabled",children:"Auto Backup"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Enable automatic backups"})]}),e.jsx(ss,{id:"backup-enabled",checked:s.backupEnabled,onCheckedChange:d=>r({...s,backupEnabled:d})})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"backup-hours",children:"Backup Frequency (hours)"}),e.jsxs(Ne,{value:s.autoBackupHours,onValueChange:d=>r({...s,autoBackupHours:d}),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select backup frequency"})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"6",children:"Every 6 hours"}),e.jsx(ae,{value:"12",children:"Every 12 hours"}),e.jsx(ae,{value:"24",children:"Daily"}),e.jsx(ae,{value:"168",children:"Weekly"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(L,{onClick:g,className:"w-full",variant:"outline",children:[e.jsx(Da,{className:"h-4 w-4 mr-2"}),"Backup Now"]}),e.jsxs(L,{onClick:p,className:"w-full",variant:"outline",children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Clear Cache"]})]})]})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(ys,{className:"h-5 w-5"}),"System Information"]}),e.jsx(Ce,{children:"View system status and information"})]}),e.jsx($,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{children:"Server Status"}),e.jsx("p",{className:"text-sm font-medium text-green-600",children:"Online"})]}),e.jsxs("div",{children:[e.jsx(S,{children:"Database Status"}),e.jsx("p",{className:"text-sm font-medium text-green-600",children:"Connected"})]}),e.jsxs("div",{children:[e.jsx(S,{children:"Last Backup"}),e.jsx("p",{className:"text-sm text-gray-600",children:"2024-01-15 02:00 AM"})]}),e.jsxs("div",{children:[e.jsx(S,{children:"Uptime"}),e.jsx("p",{className:"text-sm text-gray-600",children:"15 days, 3 hours"})]}),e.jsxs("div",{children:[e.jsx(S,{children:"Total Users"}),e.jsx("p",{className:"text-sm text-gray-600",children:"1,247"})]}),e.jsxs("div",{children:[e.jsx(S,{children:"Active Sessions"}),e.jsx("p",{className:"text-sm text-gray-600",children:"156"})]})]})})]})]})})},wd=()=>{const[s,r]=a.useState({passwordMinLength:"8",requireUppercase:!0,requireNumbers:!0,requireSpecialChars:!0,passwordExpiry:"90",maxLoginAttempts:"5",lockoutDuration:"30",twoFactorAuth:!1,sessionSecurity:!0,ipWhitelisting:!1}),[t,n]=a.useState({enableAuditLog:!0,logLevel:"info",retentionDays:"365",logFailedLogins:!0,logDataChanges:!0,logSystemAccess:!0}),[i,x]=a.useState({currentPassword:"",newPassword:"",confirmPassword:""}),g=()=>{console.log("Updating security configuration:",s)},p=()=>{console.log("Updating audit configuration:",t)},d=()=>{if(i.newPassword!==i.confirmPassword){alert("New passwords do not match");return}console.log("Changing password..."),x({currentPassword:"",newPassword:"",confirmPassword:""})};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(Ga,{className:"h-5 w-5"}),"Password Policy"]}),e.jsx(Ce,{children:"Configure password requirements and security"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"password-min-length",children:"Minimum Password Length"}),e.jsx(_,{id:"password-min-length",type:"number",value:s.passwordMinLength,onChange:j=>r({...s,passwordMinLength:j.target.value}),placeholder:"Enter minimum length"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"require-uppercase",children:"Require Uppercase"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Require at least one uppercase letter"})]}),e.jsx(ss,{id:"require-uppercase",checked:s.requireUppercase,onCheckedChange:j=>r({...s,requireUppercase:j})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"require-numbers",children:"Require Numbers"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Require at least one number"})]}),e.jsx(ss,{id:"require-numbers",checked:s.requireNumbers,onCheckedChange:j=>r({...s,requireNumbers:j})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"require-special",children:"Require Special Characters"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Require at least one special character"})]}),e.jsx(ss,{id:"require-special",checked:s.requireSpecialChars,onCheckedChange:j=>r({...s,requireSpecialChars:j})})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"password-expiry",children:"Password Expiry (days)"}),e.jsx(_,{id:"password-expiry",type:"number",value:s.passwordExpiry,onChange:j=>r({...s,passwordExpiry:j.target.value}),placeholder:"Enter expiry days"})]}),e.jsxs(L,{onClick:g,className:"w-full",children:[e.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Update Password Policy"]})]})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(xt,{className:"h-5 w-5"}),"Login Security"]}),e.jsx(Ce,{children:"Configure login security settings"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"max-login-attempts",children:"Max Login Attempts"}),e.jsx(_,{id:"max-login-attempts",type:"number",value:s.maxLoginAttempts,onChange:j=>r({...s,maxLoginAttempts:j.target.value}),placeholder:"Enter max attempts"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"lockout-duration",children:"Lockout Duration (minutes)"}),e.jsx(_,{id:"lockout-duration",type:"number",value:s.lockoutDuration,onChange:j=>r({...s,lockoutDuration:j.target.value}),placeholder:"Enter lockout duration"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"two-factor-auth",children:"Two-Factor Authentication"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Enable 2FA for all users"})]}),e.jsx(ss,{id:"two-factor-auth",checked:s.twoFactorAuth,onCheckedChange:j=>r({...s,twoFactorAuth:j})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"session-security",children:"Enhanced Session Security"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Enable advanced session protection"})]}),e.jsx(ss,{id:"session-security",checked:s.sessionSecurity,onCheckedChange:j=>r({...s,sessionSecurity:j})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"ip-whitelisting",children:"IP Whitelisting"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Restrict access to specific IP addresses"})]}),e.jsx(ss,{id:"ip-whitelisting",checked:s.ipWhitelisting,onCheckedChange:j=>r({...s,ipWhitelisting:j})})]}),e.jsxs(L,{onClick:g,className:"w-full",children:[e.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Update Login Security"]})]})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(yr,{className:"h-5 w-5"}),"Change Password"]}),e.jsx(Ce,{children:"Update your account password"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"current-password",children:"Current Password"}),e.jsx(_,{id:"current-password",type:"password",value:i.currentPassword,onChange:j=>x({...i,currentPassword:j.target.value}),placeholder:"Enter current password"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"new-password",children:"New Password"}),e.jsx(_,{id:"new-password",type:"password",value:i.newPassword,onChange:j=>x({...i,newPassword:j.target.value}),placeholder:"Enter new password"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"confirm-password",children:"Confirm New Password"}),e.jsx(_,{id:"confirm-password",type:"password",value:i.confirmPassword,onChange:j=>x({...i,confirmPassword:j.target.value}),placeholder:"Confirm new password"})]}),e.jsxs(L,{onClick:d,className:"w-full",children:[e.jsx(Ga,{className:"h-4 w-4 mr-2"}),"Change Password"]})]})]}),e.jsxs(O,{children:[e.jsxs(se,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"h-5 w-5"}),"Audit & Monitoring"]}),e.jsx(Ce,{children:"Configure system audit and monitoring"})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"enable-audit-log",children:"Enable Audit Log"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Log all system activities"})]}),e.jsx(ss,{id:"enable-audit-log",checked:t.enableAuditLog,onCheckedChange:j=>n({...t,enableAuditLog:j})})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"log-level",children:"Log Level"}),e.jsxs(Ne,{value:t.logLevel,onValueChange:j=>n({...t,logLevel:j}),children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"Select log level"})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"error",children:"Error"}),e.jsx(ae,{value:"warn",children:"Warning"}),e.jsx(ae,{value:"info",children:"Info"}),e.jsx(ae,{value:"debug",children:"Debug"})]})]})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"retention-days",children:"Log Retention (days)"}),e.jsx(_,{id:"retention-days",type:"number",value:t.retentionDays,onChange:j=>n({...t,retentionDays:j.target.value}),placeholder:"Enter retention days"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"log-failed-logins",children:"Log Failed Logins"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track failed login attempts"})]}),e.jsx(ss,{id:"log-failed-logins",checked:t.logFailedLogins,onCheckedChange:j=>n({...t,logFailedLogins:j})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"log-data-changes",children:"Log Data Changes"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track all data modifications"})]}),e.jsx(ss,{id:"log-data-changes",checked:t.logDataChanges,onCheckedChange:j=>n({...t,logDataChanges:j})})]}),e.jsxs(L,{onClick:p,className:"w-full",children:[e.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Update Audit Settings"]})]})]})]})})},Cd=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ka,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage system configuration and master data"})]})]}),e.jsxs(Qs,{defaultValue:"master-data",className:"space-y-6",children:[e.jsxs(Us,{className:"grid w-full grid-cols-4",children:[e.jsxs(Ve,{value:"master-data",className:"flex items-center gap-2",children:[e.jsx(Da,{className:"h-4 w-4"}),"Master Data"]}),e.jsxs(Ve,{value:"user-settings",className:"flex items-center gap-2",children:[e.jsx(Ns,{className:"h-4 w-4"}),"User Settings"]}),e.jsxs(Ve,{value:"system",className:"flex items-center gap-2",children:[e.jsx(ka,{className:"h-4 w-4"}),"System"]}),e.jsxs(Ve,{value:"security",className:"flex items-center gap-2",children:[e.jsx(xt,{className:"h-4 w-4"}),"Security"]})]}),e.jsx(Ie,{value:"master-data",children:e.jsx(yd,{})}),e.jsx(Ie,{value:"user-settings",children:e.jsx(vd,{})}),e.jsx(Ie,{value:"system",children:e.jsx(Ad,{})}),e.jsx(Ie,{value:"security",children:e.jsx(wd,{})})]})]}),mr=["PERCENTAGE","FIXED"];function xr(){const{toast:s}=os(),[r,t]=a.useState([]),[n,i]=a.useState(!0),[x,g]=a.useState(!1),[p,d]=a.useState("All"),[j,P]=a.useState(!1),[W,T]=a.useState(!1),[J,X]=a.useState(null),[w,V]=a.useState({code:"",taxName:"",taxType:"PERCENTAGE",taxPercentage:0,fixedAmount:0,status:"ACTIVE"});a.useEffect(()=>{N()},[]);const F="http://13.202.62.178:9090/backend-dfds",N=async()=>{i(!0);try{const l=await me.get(`${F}/api/tax-master`);t(l.data||[])}catch{s({title:"Error fetching taxes",description:"Could not load tax data. Please try again.",variant:"destructive"})}i(!1)},b=a.useMemo(()=>r.filter(l=>p==="All"?!0:l.taxType===p),[r,p]),A=()=>{V({code:"",taxName:"",taxType:"PERCENTAGE",taxPercentage:0,fixedAmount:0,status:"ACTIVE"}),T(!1),X(null)},C=()=>{A(),T(!1),P(!0)},q=l=>{V({id:l.id,code:l.code,taxName:l.taxName,taxType:l.taxType,taxPercentage:l.taxPercentage,fixedAmount:l.fixedAmount,status:l.status}),T(!0),X(l.id),P(!0)},Z=l=>{const M=Number(l);return Number.isFinite(M)?M:0},B=async()=>{if(!w.code||!w.taxName||!w.taxType){s({title:"Missing Fields",description:"Code, Name and Type are required.",variant:"destructive"});return}if(w.taxType==="PERCENTAGE"&&(w.taxPercentage===void 0||w.taxPercentage===null)){s({title:"Percentage required",description:"Please enter tax percentage.",variant:"destructive"});return}if(w.taxType==="FIXED"&&(w.fixedAmount===void 0||w.fixedAmount===null)){s({title:"Fixed amount required",description:"Please enter fixed amount.",variant:"destructive"});return}g(!0);try{const l={code:String(w.code||"").trim().toUpperCase(),taxName:String(w.taxName||"").trim(),taxType:w.taxType,taxPercentage:w.taxType==="PERCENTAGE"?Z(w.taxPercentage):0,fixedAmount:w.taxType==="FIXED"?Z(w.fixedAmount):0,status:W&&w.status||"ACTIVE"};W&&J!==null?(await me.put(`${F}/api/tax-master/${J}`,l),s({title:"Tax Updated",description:"Tax updated successfully."})):(await me.post(`${F}/api/tax-master`,l),s({title:"Tax Added",description:"New tax added successfully."})),P(!1),A(),N()}catch{s({title:W?"Error Updating Tax":"Error Adding Tax",description:W?"Could not update tax.":"Could not add new tax.",variant:"destructive"})}g(!1)},te=async l=>{if(window.confirm("Are you sure you want to delete this tax?"))try{await me.delete(`${F}/api/tax-master/${l}`),s({title:"Tax Deleted",description:"Tax deleted successfully."}),N()}catch{s({title:"Error Deleting Tax",description:"Could not delete tax.",variant:"destructive"})}},Q=async(l,M)=>{try{const m=M==="ACTIVE"?"INACTIVE":"ACTIVE";await me.put(`${F}/api/tax-master/${l}/status?status=${m}`),N(),s({title:"Status Changed",description:`Tax is now ${m}.`})}catch{s({title:"Status Change Failed",description:"Could not update status.",variant:"destructive"})}},G=(l,M)=>{V(m=>{if(l==="taxType"){if(M==="PERCENTAGE")return{...m,taxType:M,fixedAmount:0};if(M==="FIXED")return{...m,taxType:M,taxPercentage:0}}return{...m,[l]:M}})};return e.jsx("div",{className:"p-2 bg-gray-50 min-h-[calc(100vh-64px)]",children:e.jsxs(O,{className:"border border-gray-100 rounded-xl shadow-sm max-w-6xl mx-auto",children:[e.jsxs(se,{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 px-6 pt-6 pb-2",children:[e.jsxs("div",{children:[e.jsx(ee,{className:"text-2xl font-bold",children:"Tax-Deduction Master"}),e.jsx("p",{className:"mt-1 text-gray-500 text-sm",children:"Define & Manage Tax Codes & Rates"})]}),e.jsxs("div",{className:"flex items-end gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1",children:"Filter Type"}),e.jsxs("select",{className:"w-40 border border-gray-300 rounded px-2 py-1 text-sm focus:ring-2 focus:ring-blue-100",value:p,onChange:l=>d(l.target.value),children:[e.jsx("option",{children:"All"}),mr.map(l=>e.jsx("option",{children:l},l))]})]}),e.jsxs(ts,{open:j,onOpenChange:l=>{P(l),l||A()},children:[e.jsx(gt,{asChild:!0,children:e.jsxs(L,{className:"flex items-center gap-2",variant:"default",onClick:C,children:[e.jsx(ps,{className:"w-4 h-4"})," Add Tax"]})}),e.jsxs(Ze,{className:"max-w-lg w-full p-0",children:[e.jsx(as,{className:"bg-blue-50 rounded-t-lg px-6 py-4 border-b",children:e.jsx(rs,{className:"text-lg font-semibold",children:W?"Edit Tax":"Add New Tax"})}),e.jsxs("form",{onSubmit:l=>{l.preventDefault(),B()},className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Tax Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(_,{value:w.code||"",onChange:l=>G("code",l.target.value),placeholder:"e.g. CGST",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Tax Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(_,{value:w.taxName||"",onChange:l=>G("taxName",l.target.value),placeholder:"e.g. Central GST",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{className:"w-full border border-gray-300 rounded px-2 py-2 text-sm focus:ring-2 focus:ring-blue-100",value:w.taxType||"PERCENTAGE",onChange:l=>G("taxType",l.target.value),required:!0,children:mr.map(l=>e.jsx("option",{children:l},l))})]}),w.taxType==="PERCENTAGE"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Percentage (%)"}),e.jsx(_,{type:"number",min:"0",step:"0.01",value:w.taxPercentage??0,onChange:l=>G("taxPercentage",parseFloat(l.target.value)),placeholder:"e.g. 9",required:!0})]}),w.taxType==="FIXED"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Fixed Amount (₹)"}),e.jsx(_,{type:"number",min:"0",step:"0.01",value:w.fixedAmount??0,onChange:l=>G("fixedAmount",parseFloat(l.target.value)),placeholder:"e.g. 1000",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-6 mt-6 border-t",children:[e.jsx(L,{variant:"outline",type:"button",onClick:()=>{P(!1),A()},disabled:x,children:"Cancel"}),e.jsx(L,{type:"submit",disabled:x,children:x?W?"Updating...":"Saving...":W?"Update":"Save"})]})]})]})]})]})]}),e.jsx($,{className:"p-0 overflow-x-auto",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ke,{className:"min-w-full border border-gray-300 rounded-md",children:[e.jsx(Be,{className:"bg-gray-100",children:e.jsx(ue,{children:["S.No","Code","Name","Type","Rate/Amount","Status","Actions"].map(l=>e.jsx(U,{className:"border border-gray-300 px-4 py-2 text-left text-sm font-semibold text-gray-700 uppercase",children:l},l))})}),e.jsx(We,{children:n?e.jsx(ue,{children:e.jsx(h,{colSpan:7,className:"py-8 text-center text-gray-400 text-sm border",children:"Loading..."})}):b.length===0?e.jsx(ue,{children:e.jsx(h,{colSpan:7,className:"py-8 text-center text-gray-400 text-sm border",children:"No taxes available."})}):b.map((l,M)=>e.jsxs(ue,{className:"hover:bg-blue-50 transition-all",children:[e.jsx(h,{className:"border border-gray-300 px-4 py-3 text-sm text-gray-600",children:M+1}),e.jsx(h,{className:"border border-gray-300 px-4 py-3 text-sm font-medium",children:l.code}),e.jsx(h,{className:"border border-gray-300 px-4 py-3 text-sm",children:l.taxName}),e.jsx(h,{className:"border border-gray-300 px-4 py-3 text-sm",children:l.taxType}),e.jsx(h,{className:"border border-gray-300 px-4 py-3 text-sm",children:l.taxType==="PERCENTAGE"?`${l.taxPercentage}%`:`₹${l.fixedAmount}`}),e.jsx(h,{className:"border border-gray-300 px-4 py-3 text-sm",children:e.jsx("span",{className:`inline-block px-2 py-1 text-xs font-bold rounded-full cursor-pointer border ${l.status==="ACTIVE"?"bg-green-50 text-green-800 border-green-200":"bg-red-50 text-red-800 border-red-200"}`,title:"Toggle Status",onClick:()=>Q(l.id,l.status),children:l.status})}),e.jsx(h,{className:"border border-gray-300 px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{variant:"ghost",size:"icon",title:"Edit",onClick:()=>q(l),children:e.jsx(la,{className:"w-4 h-4"})}),e.jsx(L,{variant:"ghost",size:"icon",title:"Delete",onClick:()=>te(l.id),children:e.jsx(Os,{className:"w-4 h-4 text-red-600"})})]})})]},l.id))})]})})})]})})}const Ca="http://13.202.62.178:9090/backend-dfds",hr="/api/works/workList",Sd="/api/works/aa-approve";function Sa(){return localStorage.getItem("token")||localStorage.getItem("authToken")||localStorage.getItem("jwt")||sessionStorage.getItem("token")}const _t=s=>Array.from(new Set(s)),Xt=(...s)=>s.filter(Boolean).join(" "),bs=s=>`₹${(s||0).toLocaleString()}`;function ot({value:s,onChange:r,options:t,placeholder:n="Select…",className:i}){const[x,g]=a.useState(!1),p=a.useMemo(()=>[...t].sort((d,j)=>d.localeCompare(j,"en",{sensitivity:"base"})),[t]);return e.jsxs($t,{open:x,onOpenChange:g,children:[e.jsx(zt,{asChild:!0,children:e.jsxs(L,{variant:"outline",role:"combobox","aria-expanded":x,className:Xt("w-full justify-between h-9 text-xs",i),children:[e.jsx("span",{className:Xt(!s&&"text-muted-foreground"),children:s||n}),e.jsx(Vt,{className:"ml-2 h-4 w-4 opacity-60"})]})}),e.jsx(jt,{className:"p-0 w-[--radix-popover-trigger-width] min-w-[220px]",align:"start",children:e.jsxs(Nt,{children:[e.jsx(ft,{placeholder:"Type to search…",className:"h-9 text-xs"}),e.jsx(bt,{children:"No results found."}),e.jsx(yt,{className:"max-h-64 overflow-auto",children:p.map(d=>{const j=s===d;return e.jsxs(vt,{value:d,onSelect:P=>{r(P),g(!1)},className:"text-xs",children:[e.jsx(ws,{className:Xt("mr-2 h-4 w-4",j?"opacity-100":"opacity-0")}),e.jsx("span",{className:"truncate",children:d})]},d)})})]})})]})}function kd({status:s}){const t={Pending:{bg:"bg-amber-100",text:"text-amber-800",label:"Pending"},Sanctioned:{bg:"bg-blue-100",text:"text-blue-800",label:"Sanctioned"},Approved:{bg:"bg-emerald-100",text:"text-emerald-800",label:"Approved"}}[s];return e.jsx("span",{className:Xt("px-2 py-0.5 rounded-full text-xs font-medium",t.bg,t.text),children:t.label})}function Ld({open:s,onOpenChange:r,row:t,iaOptions:n,onSave:i}){const[x,g]=a.useState((t==null?void 0:t.iaName)||""),[p,d]=a.useState(t!=null&&t.aaAmount?String(t.aaAmount):""),[j,P]=a.useState((t==null?void 0:t.aaLetterNo)||""),[W,T]=a.useState((t==null?void 0:t.aaLetterFileName)||null),[J,X]=a.useState({});Kr.useEffect(()=>{g((t==null?void 0:t.iaName)||""),d(t!=null&&t.aaAmount?String(t.aaAmount):""),P((t==null?void 0:t.aaLetterNo)||""),T((t==null?void 0:t.aaLetterFileName)||null),X({})},[t]);const w=p.trim()===""?null:Number(p),V=w!==null&&!Number.isNaN(w),F=J.ia&&!x?"Implementing agency is required.":"",N=J.amt&&(!V||w<=0)?"Enter a valid AA amount greater than 0.":"",b=J.no&&V&&!j?"AA Letter No. is required when AA amount is entered.":"",A=!!x&&V&&((j==null?void 0:j.trim().length)??0)>0,C=G=>{var M;const l=(M=G.target.files)==null?void 0:M[0];l&&T(l.name)},q=G=>{var M;G.preventDefault();const l=(M=G.dataTransfer.files)==null?void 0:M[0];l&&T(l.name)},Z=()=>{if(!A){X({ia:!0,amt:!0,no:!0});return}i({iaName:x,aaAmount:w,aaLetterNo:j||null,aaLetterFileName:W||null}),r(!1)};if(!t)return null;const B=t.work.recommendedAmount||0,te=w||0,Q=Math.max(0,te-(t.fundDisbursed||0));return e.jsx(ts,{open:s,onOpenChange:r,children:e.jsxs(Ze,{className:"max-w-3xl p-0 overflow-hidden",children:[e.jsx("div",{className:"px-5 py-4 bg-gradient-to-r from-indigo-50 to-indigo-100 border-b",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base font-semibold text-indigo-900",children:["Edit & Sanction – ",t.work.workCode]}),e.jsx("p",{className:"mt-0.5 text-xs text-indigo-800/80",children:t.work.name}),e.jsxs("div",{className:"mt-1 flex flex-wrap gap-2 text-[11px]",children:[e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/70 border border-indigo-200 text-indigo-800",children:["MLA: ",t.work.mlaName]}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/70 border border-indigo-200 text-indigo-800",children:["District: ",t.work.district]}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/70 border border-indigo-200 text-indigo-800",children:["FY: ",t.work.financialYear]})]})]}),e.jsxs("div",{className:"text-right text-[11px] text-indigo-900",children:[e.jsx("div",{className:"font-semibold",children:"Recommended"}),e.jsx("div",{className:"text-lg",children:bs(B)})]})]})}),e.jsxs("div",{className:"p-5 space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[e.jsxs("div",{className:"rounded-md p-3 border-l-4 border-emerald-500 bg-emerald-50",children:[e.jsx("p",{className:"text-[11px] font-semibold text-emerald-700 uppercase",children:"AA Amount"}),e.jsx("p",{className:"text-lg font-bold text-emerald-900",children:bs(te)})]}),e.jsxs("div",{className:"rounded-md p-3 border-l-4 border-blue-500 bg-blue-50",children:[e.jsx("p",{className:"text-[11px] font-semibold text-blue-700 uppercase",children:"Disbursed So Far"}),e.jsx("p",{className:"text-lg font-bold text-blue-900",children:bs(t.fundDisbursed||0)})]}),e.jsxs("div",{className:"rounded-md p-3 border-l-4 border-amber-500 bg-amber-50",children:[e.jsx("p",{className:"text-[11px] font-semibold text-amber-700 uppercase",children:"Pending (AA − Disbursed)"}),e.jsx("p",{className:"text-lg font-bold text-amber-900",children:bs(Q)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(S,{className:"text-xs",children:["Implementing Agency ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ot,{value:x,onChange:G=>{g(G),X(l=>({...l,ia:!0}))},options:n}),F&&e.jsx("p",{className:"mt-1 text-[11px] text-red-600",children:F}),e.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"Choose the executing department/agency responsible for the work."})]}),e.jsxs("div",{children:[e.jsxs(S,{htmlFor:"aaAmt",className:"text-xs",children:["AA Amount (₹) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(_,{id:"aaAmt",type:"number",value:p,onChange:G=>{d(G.target.value),X(l=>({...l,amt:!0}))},placeholder:"e.g. 1500",className:"h-9 text-sm"}),N&&e.jsx("p",{className:"mt-1 text-[11px] text-red-600",children:N}),e.jsxs("div",{className:"mt-1 flex items-center justify-between text-[11px] text-gray-500",children:[e.jsx("span",{children:"Tip: AA should not exceed the available MLA limit."}),e.jsx("button",{type:"button",className:"underline text-blue-700",onClick:()=>{d(String(B)),X(G=>({...G,amt:!0}))},children:"Fill from Recommended"})]})]}),e.jsxs("div",{children:[e.jsxs(S,{htmlFor:"aaNo",className:"text-xs",children:["AA Letter No. ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(_,{id:"aaNo",value:j,onChange:G=>{P(G.target.value),X(l=>({...l,no:!0}))},placeholder:"e.g. PWD/AA/2024/123",className:"h-9 text-sm"}),b&&e.jsx("p",{className:"mt-1 text-[11px] text-red-600",children:b}),e.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"Enter the official AA reference number issued by the sanctioning authority."})]}),e.jsxs("div",{children:[e.jsx(S,{className:"text-xs",children:"Upload AA Letter (PDF / DOCX)"}),e.jsxs("label",{htmlFor:"aaFile",onDragOver:G=>G.preventDefault(),onDrop:q,className:"mt-1 flex items-center justify-center gap-2 h-24 rounded-md border border-dashed hover:border-blue-400 hover:bg-blue-50/40 transition-colors cursor-pointer",title:"Click or drag a file",children:[e.jsx(Ur,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-[12px] text-blue-700",children:"Click or drag to upload"})]}),e.jsx("input",{id:"aaFile",type:"file",className:"hidden",onChange:C}),e.jsx("div",{className:"mt-1 text-[12px] text-gray-600 truncate",children:W?e.jsxs(e.Fragment,{children:["Selected: ",e.jsx("span",{className:"font-medium",children:W})]}):"No file chosen"})]})]})]}),e.jsxs("div",{className:"px-5 py-3 border-t flex items-center justify-end gap-2",children:[e.jsx(L,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(L,{onClick:Z,children:"Save"})]})]})})}function Dd(){const[s,r]=a.useState([]),[t,n]=a.useState(!1),[i,x]=a.useState(null),[g,p]=a.useState("All"),[d,j]=a.useState("All"),[P,W]=a.useState("All"),[T,J]=a.useState("All"),[X,w]=a.useState("All"),[V,F]=a.useState(null),N=s.find(k=>k.id===V)||null,[b,A]=a.useState(!1);a.useEffect(()=>{const k=Sa();if(!k){x("Auth token not found. Please login first.");return}(async()=>{var D,de;n(!0),x(null);try{const I=await me.get(`${Ca}${hr}`,{headers:{Authorization:`Bearer ${k}`},params:{filter:JSON.stringify({})}}),oe=(Array.isArray(I.data)?I.data:[]).map(pe=>{var xs,He,Ue,Je,$e,Ss;const E=Number(pe.grossAmount||0),R=Number(pe.balanceAmount||0),z=Math.max(0,E-R),re=(pe.status||"").toUpperCase(),xe=re==="APPROVED"?"Approved":re==="SANCTIONED"?"Sanctioned":"Pending",Ee=pe.financialYear||((He=(xs=pe.scheme)==null?void 0:xs.financialYear)==null?void 0:He.finacialYear)||"—",De=((Ue=pe.district)==null?void 0:Ue.districtName)||"—",Fe=((Je=pe.constituency)==null?void 0:Je.constituencyName)||"—",ms=(($e=pe.recommendedByMla)==null?void 0:$e.mlaName)||"—",Ye=((Ss=pe.implementingAgency)==null?void 0:Ss.fullname)||"—",Te={id:pe.id,workCode:pe.workCode||`WORK-${pe.id}`,name:pe.workName||"—",district:De,constituency:Fe,mlaName:ms,financialYear:Ee,recommendedAmount:Number(pe.grossAmount||0),mlaLetterNo:pe.workCode||"—"};return{id:pe.id,work:Te,iaName:Ye,aaAmount:pe.adminApprovedAmount??null,aaLetterNo:pe.adminApprovedletterUrl||null,aaLetterFileName:null,fundDisbursed:z,status:xe}});r(oe)}catch(I){console.error(I),x(((de=(D=I==null?void 0:I.response)==null?void 0:D.data)==null?void 0:de.message)||(I==null?void 0:I.message)||"Failed to fetch works.")}finally{n(!1)}})()},[]);const C=a.useMemo(()=>["All",..._t(s.map(k=>k.work.financialYear))],[s]),q=a.useMemo(()=>["All",..._t(s.map(k=>k.work.district))],[s]),Z=a.useMemo(()=>["All",..._t(s.filter(k=>d==="All"?!0:k.work.district===d).map(k=>k.work.constituency))],[s,d]),B=a.useMemo(()=>["All",..._t(s.filter(k=>d==="All"?!0:k.work.district===d).filter(k=>P==="All"?!0:k.work.constituency===P).map(k=>k.work.mlaName))],[s,d,P]),te=["All","Pending","Sanctioned","Approved"],Q=s.filter(k=>!(g!=="All"&&k.work.financialYear!==g||d!=="All"&&k.work.district!==d||P!=="All"&&k.work.constituency!==P||T!=="All"&&k.work.mlaName!==T||X!=="All"&&k.status!==X)),G=Q.reduce((k,c)=>k+c.work.recommendedAmount,0),l=Q.length,M=Q.filter(k=>k.status==="Pending").length,m=async k=>{var de,I;if(!V)return;const c=Sa();if(!c){alert("Auth token not found. Please login again.");return}const D=s.find(H=>H.id===V);if(D)try{const H={id:D.id,adminApprovedAmount:k.aaAmount??D.aaAmount??0,adminApprovedletterUrl:k.aaLetterNo??D.aaLetterNo??null,implementingAgencyName:k.iaName??D.iaName};await me.put(`${Ca}${Sd}`,H,{headers:{Authorization:`Bearer ${c}`}}),r(oe=>oe.map(pe=>pe.id===V?{...pe,...k}:pe))}catch(H){console.error(H),alert(((I=(de=H==null?void 0:H.response)==null?void 0:de.data)==null?void 0:I.message)||(H==null?void 0:H.message)||"Failed to update AA details.")}},y=k=>{r(c=>c.map(D=>D.id===k?{...D,status:"Approved"}:D))},o=k=>{r(c=>c.map(D=>D.id!==k?D:!D.aaAmount||!D.aaLetterNo?(alert("Please add AA Amount and AA Letter first (Edit), then Sanction."),D):{...D,status:"Sanctioned"}))},ne=k=>{F(k),A(!0)},he=async()=>{var c,D;const k=Sa();if(!k){x("Auth token not found. Please login first.");return}n(!0),x(null);try{const de=await me.get(`${Ca}${hr}`,{headers:{Authorization:`Bearer ${k}`},params:{filter:JSON.stringify({})}}),H=(Array.isArray(de.data)?de.data:[]).map(oe=>{var Te,xs,He,Ue,Je,$e;const pe=Number(oe.grossAmount||0),E=Number(oe.balanceAmount||0),R=Math.max(0,pe-E),z=(oe.status||"").toUpperCase(),re=z==="APPROVED"?"Approved":z==="SANCTIONED"?"Sanctioned":"Pending",xe=oe.financialYear||((xs=(Te=oe.scheme)==null?void 0:Te.financialYear)==null?void 0:xs.finacialYear)||"—",Ee=((He=oe.district)==null?void 0:He.districtName)||"—",De=((Ue=oe.constituency)==null?void 0:Ue.constituencyName)||"—",Fe=((Je=oe.recommendedByMla)==null?void 0:Je.mlaName)||"—",ms=(($e=oe.implementingAgency)==null?void 0:$e.fullname)||"—",Ye={id:oe.id,workCode:oe.workCode||`WORK-${oe.id}`,name:oe.workName||"—",district:Ee,constituency:De,mlaName:Fe,financialYear:xe,recommendedAmount:Number(oe.grossAmount||0),mlaLetterNo:oe.workCode||"—"};return{id:oe.id,work:Ye,iaName:ms,aaAmount:oe.adminApprovedAmount??null,aaLetterNo:oe.adminApprovedletterUrl||null,aaLetterFileName:null,fundDisbursed:R,status:re}});r(H)}catch(de){console.error(de),x(((D=(c=de==null?void 0:de.response)==null?void 0:c.data)==null?void 0:D.message)||(de==null?void 0:de.message)||"Failed to refresh works.")}finally{n(!1)}};return e.jsxs("div",{className:"p-6 space-y-6 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[t&&e.jsx("div",{className:"text-sm text-gray-600",children:"Loading works…"}),i&&e.jsx("div",{className:"text-sm text-red-600",children:i})]}),e.jsx(L,{variant:"outline",onClick:he,className:"h-9",children:"Refresh"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs(Ae.div,{className:"rounded-md p-4 shadow-sm border-l-4 border-indigo-500 bg-gradient-to-br from-indigo-50 to-indigo-100",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:[e.jsx("p",{className:"text-xs font-semibold text-indigo-700 uppercase",children:"Total Recommended Amount"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-indigo-900",children:bs(G)}),e.jsx("p",{className:"text-[11px] text-indigo-700/70 mt-1",children:"Within current filters"})]}),e.jsxs(Ae.div,{className:"rounded-md p-4 shadow-sm border-l-4 border-emerald-500 bg-gradient-to-br from-emerald-50 to-emerald-100",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05},children:[e.jsx("p",{className:"text-xs font-semibold text-emerald-700 uppercase",children:"Total Recommendations"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-emerald-900",children:l}),e.jsx("p",{className:"text-[11px] text-emerald-700/70 mt-1",children:"Records listed below"})]}),e.jsxs(Ae.div,{className:"rounded-md p-4 shadow-sm border-l-4 border-amber-500 bg-gradient-to-br from-amber-50 to-amber-100",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsx("p",{className:"text-xs font-semibold text-amber-700 uppercase",children:"Fund Demands Pending"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-amber-900",children:M}),e.jsx("p",{className:"text-[11px] text-amber-700/70 mt-1",children:d==="All"?"All districts":`District: ${d}`})]})]}),e.jsxs(O,{className:"rounded-md shadow-sm",children:[e.jsx(se,{className:"pb-2",children:e.jsx(ee,{className:"text-sm",children:"Filters"})}),e.jsx($,{className:"p-3",children:e.jsxs("div",{className:"grid grid-cols-12 gap-3 items-end",children:[e.jsxs("div",{className:"col-span-12 sm:col-span-6 md:col-span-3 lg:col-span-2",children:[e.jsx(S,{className:"text-[11px] mb-1 block",children:"Financial Year"}),e.jsx(ot,{value:g,onChange:p,options:C})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-6 md:col-span-3 lg:col-span-3",children:[e.jsx(S,{className:"text-[11px] mb-1 block",children:"Nodal District"}),e.jsx(ot,{value:d,onChange:j,options:q})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-6 md:col-span-3 lg:col-span-3",children:[e.jsx(S,{className:"text-[11px] mb-1 block",children:"Assembly Constituency"}),e.jsx(ot,{value:P,onChange:W,options:Z})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-6 md:col-span-3 lg:col-span-3",children:[e.jsx(S,{className:"text-[11px] mb-1 block",children:"MLA Name"}),e.jsx(ot,{value:T,onChange:J,options:B})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-6 md:col-span-3 lg:col-span-1",children:[e.jsx(S,{className:"text-[11px] mb-1 block",children:"Status"}),e.jsx(ot,{value:X,onChange:w,options:te})]})]})})]}),e.jsxs(O,{className:"rounded-md shadow-sm",children:[e.jsx(se,{className:"pb-2",children:e.jsx(ee,{className:"text-base",children:"Recent Recommendations"})}),e.jsx($,{className:"p-0 overflow-x-auto",children:e.jsxs(Ke,{className:"min-w-full table-fixed text-xs",children:[e.jsx(Be,{children:e.jsx(ue,{children:["Sr No","Work Name","IA Name","MLA Letter","Recommended Amount","AA Amount","AA Letter","Fund Disbursed","Pending Amount","Status","Actions"].map(k=>e.jsx(U,{className:"border px-2 py-1 text-[11px] font-semibold whitespace-nowrap",children:k},k))})}),e.jsx(We,{children:Q.length===0?e.jsx(ue,{children:e.jsx(h,{colSpan:11,className:"text-center py-6 text-sm text-gray-500",children:"No records found."})}):Q.map((k,c)=>{const D=Math.max(0,(k.aaAmount||0)-(k.fundDisbursed||0));return e.jsxs(ue,{className:"hover:bg-gray-50",children:[e.jsx(h,{className:"border px-2 py-1",children:c+1}),e.jsxs(h,{className:"border px-2 py-1 align-top",children:[e.jsx("div",{className:"font-medium truncate max-w-[320px]",children:k.work.name}),e.jsxs("div",{className:"text-[11px] text-gray-500",children:["FY: ",k.work.financialYear]})]}),e.jsx(h,{className:"border px-2 py-1",children:e.jsx("div",{className:"truncate max-w-[220px]",children:k.iaName})}),e.jsx(h,{className:"border px-2 py-1",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ze,{className:"w-3.5 h-3.5 text-gray-600"}),e.jsx("a",{className:"text-blue-600 underline text-[12px] truncate max-w-[150px]",href:"#",onClick:de=>de.preventDefault(),title:k.work.mlaLetterNo,children:k.work.mlaLetterNo})]})}),e.jsx(h,{className:"border px-2 py-1 text-right tabular-nums whitespace-nowrap",children:bs(k.work.recommendedAmount)}),e.jsx(h,{className:"border px-2 py-1 text-right tabular-nums whitespace-nowrap",children:k.aaAmount?bs(k.aaAmount):"—"}),e.jsx(h,{className:"border px-2 py-1",children:k.aaLetterNo?e.jsxs("div",{className:"flex items-center gap-1 text-blue-700",children:[e.jsx(ze,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"underline text-[12px] truncate max-w-[140px]",title:k.aaLetterNo,children:k.aaLetterNo})]}):e.jsx("span",{className:"text-gray-400 text-[12px]",children:"Not Assigned"})}),e.jsx(h,{className:"border px-2 py-1 text-right tabular-nums text-emerald-700 whitespace-nowrap",children:bs(k.fundDisbursed)}),e.jsx(h,{className:"border px-2 py-1 text-right tabular-nums whitespace-nowrap",children:bs(D)}),e.jsx(h,{className:"border px-2 py-1",children:e.jsx(kd,{status:k.status})}),e.jsx(h,{className:"border px-2 py-1",children:e.jsxs("div",{className:"flex items-center flex-wrap gap-1",children:[e.jsxs(ts,{children:[e.jsx(gt,{asChild:!0,children:e.jsx(L,{variant:"ghost",size:"icon",className:"h-7 w-7 p-0",children:e.jsx(Re,{className:"w-4 h-4 text-blue-600"})})}),e.jsxs(Ze,{className:"max-w-3xl",children:[e.jsx(as,{children:e.jsxs(rs,{children:["Work Details – ",k.work.workCode]})}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Name:"})," ",k.work.name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"District:"})," ",k.work.district]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Constituency:"})," ",k.work.constituency]}),e.jsxs("div",{children:[e.jsx("strong",{children:"MLA:"})," ",k.work.mlaName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Financial Year:"})," ",k.work.financialYear]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Recommended Amount:"})," ",bs(k.work.recommendedAmount)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"IA:"})," ",k.iaName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"AA Amount:"})," ",k.aaAmount?bs(k.aaAmount):"—"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"AA Letter:"})," ",k.aaLetterNo||"—"]})]})]})]}),e.jsxs(L,{variant:"outline",onClick:()=>ne(k.id),className:"h-7 px-2 text-[11px]",children:[e.jsx(la,{className:"w-3.5 h-3.5 mr-1"}),"Edit"]}),e.jsx(L,{onClick:()=>o(k.id),className:"h-7 px-2 text-[11px] bg-blue-600 hover:bg-blue-700 text-white",disabled:k.status==="Sanctioned"||k.status==="Approved",children:"Sanction"}),e.jsxs(L,{onClick:()=>y(k.id),className:"h-7 px-2 text-[11px] bg-emerald-600 hover:bg-emerald-700 text-white",disabled:k.status==="Approved",children:[e.jsx(ra,{className:"w-3.5 h-3.5 mr-1"}),"Approve"]})]})})]},k.id)})})]})})]}),e.jsx(Ld,{open:b,onOpenChange:A,row:N,iaOptions:["Executive Engineer, Public Works North Division, Pune","Executive Engineer, ZP Pune (Rural Works)","Chief Officer, Pune Municipal Corporation","Executive Engineer, Water Resources Dept., Pune","Executive Engineer, Rural Development Dept., Pune"],onSave:m})]})}function Md(){const[s,r]=a.useState([]),[t,n]=a.useState([]),[i,x]=a.useState("2024-25"),[g,p]=a.useState(""),[d,j]=a.useState(!0),[P,W]=a.useState(null),[T,J]=a.useState(null),X={mlaName:"Shri Dilip Dattatray Walse",constituency:"Ambegaon Assembly Constituency",tenure:"2024-2029",totalLimit:25},w=async()=>{try{const m="http://13.202.62.178:9090/backend-dfds",y=localStorage.getItem("token"),o=await me.get(`${m}/api/dropdown/financial-years`,{headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json"}});n(o.data||[])}catch(m){console.error("Error fetching financial years:",m)}},V=async()=>{try{const m="http://13.202.62.178:9090/backend-dfds",y=localStorage.getItem("token"),o=await me.get(`${m}/api/mla-budget/getMLABudgets`,{headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json"}});J(o.data||null)}catch(m){console.error("Error fetching MLA budget:",m)}},F=async()=>{var m,y;try{j(!0),W(null);const o="http://13.202.62.178:9090/backend-dfds",ne=localStorage.getItem("token"),he=await me.get(`${o}/api/works`,{headers:{Authorization:`Bearer ${ne}`,"Content-Type":"application/json"}});r(he.data||[])}catch(o){console.error("Error fetching works data:",o),W(((y=(m=o.response)==null?void 0:m.data)==null?void 0:y.message)||"Failed to fetch works data")}finally{j(!1)}};a.useEffect(()=>{w()},[]),a.useEffect(()=>{F()},[]),a.useEffect(()=>{V()},[]);const N=m=>m>=1e7?`₹${(m/1e7).toFixed(1)} Cr`:m>=1e5?`₹${(m/1e5).toFixed(1)} L`:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(m),b=()=>{console.log("Export functionality to be implemented")};if(d)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"w-6 h-6 animate-spin text-blue-600"}),e.jsx("span",{className:"text-lg font-medium text-gray-600",children:"Loading dashboard..."})]})});if(P)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(O,{className:"w-full max-w-md",children:e.jsxs($,{className:"p-6 text-center",children:[e.jsx(us,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error Loading Dashboard"}),e.jsx("p",{className:"text-gray-600 mb-4",children:P}),e.jsxs(L,{onClick:F,className:"w-full",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Retry"]})]})})});const A=s.filter(m=>m.financialYear===i),C=A.filter(m=>m.status==="RECOMMENDED"||m.status==="PENDING"),q=A.filter(m=>m.status==="APPROVED"||m.status==="SANCTIONED"),Z=(T==null?void 0:T.allocatedBudget)||q.reduce((m,y)=>m+y.adminApprovedAmount,0),B=C.reduce((m,y)=>m+y.grossAmount,0),te=q.reduce((m,y)=>m+y.adminApprovedAmount,0),Q=(T==null?void 0:T.remainingBudget)||Z-te,G=(T==null?void 0:T.lastYearSpill)||50,l=(T==null?void 0:T.permissibleScope)||X.totalLimit*1e7-Q,M=s.filter(m=>{var y;return m.workName.toLowerCase().includes(g.toLowerCase())||m.workCode.toLowerCase().includes(g.toLowerCase())||((y=m.implementingAgency)==null?void 0:y.fullname.toLowerCase().includes(g.toLowerCase()))});return e.jsxs("div",{className:"p-6 space-y-6 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:e.jsx(Es,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"MLA Dashboard"}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mt-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Es,{className:"w-4 h-4 mr-1"}),X.mlaName]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ia,{className:"w-4 h-4 mr-1"}),X.constituency]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(mt,{className:"w-4 h-4 mr-1"}),"Tenure: ",X.tenure]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ea,{className:"w-4 h-4 mr-1"}),"Total Limit: ₹",X.totalLimit," Crores"]})]}),e.jsx(ye,{className:"bg-green-100 text-green-800 mt-2",children:"Active Session"})]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(Ne,{value:i,onValueChange:x,children:[e.jsx(je,{className:"w-48",children:e.jsx(fe,{placeholder:"Select Financial Year"})}),e.jsx(ge,{children:t.map(m=>e.jsx(ae,{value:m.name,children:m.name},m.id))})]}),e.jsxs("div",{className:"relative",children:[e.jsx(zs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(_,{placeholder:"Search works, IA name, or AA letter...",value:g,onChange:m=>p(m.target.value),className:"pl-10 w-96"})]})]}),e.jsxs(L,{onClick:b,variant:"outline",children:[e.jsx(Xs,{className:"w-4 h-4 mr-2"}),"Export"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(Ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsx(O,{className:"bg-white border border-gray-200",children:e.jsx($,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(ea,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Current FY Budget Sanctioned"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N(Z)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Remaining Balance: ",N(Q)," | Last Year Spill: ",N(G)]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Re,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:"View"})]})]})})})}),e.jsx(Ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsx(O,{className:"bg-white border border-gray-200",children:e.jsx($,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(on,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Total Works Recommended"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:C.length}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Total Work Cost: ",N(B)]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Re,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:"View"})]})]})})})}),e.jsx(Ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsx(O,{className:"bg-white border border-gray-200",children:e.jsx($,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(ra,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Total Works Sanctioned"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:q.length}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Cost of Sanctioned Works: ",N(te)]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Re,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:"View"})]})]})})})}),e.jsx(Ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:e.jsx(O,{className:"bg-white border border-gray-200",children:e.jsx($,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(mn,{className:"w-5 h-5 text-yellow-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Permissible Scope"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N(l)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Remaining Scope: ",N(l-B)]})]})})})})})]}),e.jsx(O,{className:"bg-white border border-gray-200",children:e.jsx($,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ke,{children:[e.jsx(Be,{children:e.jsxs(ue,{className:"bg-gray-50",children:[e.jsx(U,{className:"text-center font-semibold",children:"Sr No"}),e.jsx(U,{className:"font-semibold",children:"Work Name"}),e.jsx(U,{className:"font-semibold",children:"IA Name"}),e.jsx(U,{className:"font-semibold",children:"MLA Letter"}),e.jsx(U,{className:"text-right font-semibold",children:"Recommended Amount"}),e.jsx(U,{className:"text-right font-semibold",children:"AA Amount"}),e.jsx(U,{className:"font-semibold",children:"AA Letter"}),e.jsx(U,{className:"text-right font-semibold",children:"Fund Disbursed"}),e.jsx(U,{className:"font-semibold",children:"Status"})]})}),e.jsx(We,{children:M.map((m,y)=>{var o,ne;return e.jsxs(ue,{className:"hover:bg-gray-50",children:[e.jsx(h,{className:"text-center font-medium",children:y+1}),e.jsx(h,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:m.workName}),e.jsxs("p",{className:"text-xs text-gray-500",children:["FY: ",m.financialYear]})]})}),e.jsx(h,{children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:((o=m.implementingAgency)==null?void 0:o.fullname)||"Executive Engineer, Public Works North Division, Pune"}),e.jsx("p",{className:"text-xs text-gray-500",children:((ne=m.implementingAgency)==null?void 0:ne.designation)||"Executive Engineer"})]})}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"text-sm",children:["ML/2425/",m.id]}),e.jsx(sa,{className:"w-3 h-3 text-blue-500 cursor-pointer hover:text-blue-700"})]})}),e.jsx(h,{className:"text-right font-medium",children:N(m.grossAmount)}),e.jsx(h,{className:"text-right font-medium",children:N(m.adminApprovedAmount)}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"text-sm",children:"AA/2024/001"}),e.jsx(sa,{className:"w-3 h-3 text-blue-500 cursor-pointer hover:text-blue-700"})]})}),e.jsx(h,{className:"text-right font-medium text-green-600",children:"₹0.0"}),e.jsx(h,{children:e.jsx(ye,{className:m.status==="APPROVED"?"bg-green-100 text-green-800":m.status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800",children:m.status==="APPROVED"?"Not Started":m.status})})]},m.id)})}),M.length===0&&e.jsx(js,{children:e.jsx(ue,{children:e.jsx(h,{colSpan:9,className:"text-center py-8 text-gray-500",children:"No works found"})})})]})})})})]})}const $n=Il,zn=a.createContext({}),hs=({...s})=>e.jsx(zn.Provider,{value:{name:s.name},children:e.jsx(Fl,{...s})}),ca=()=>{const s=a.useContext(zn),r=a.useContext(Un),{getFieldState:t,formState:n}=Tl(),i=t(s.name,n);if(!s)throw new Error("useFormField should be used within <FormField>");const{id:x}=r;return{id:x,name:s.name,formItemId:`${x}-form-item`,formDescriptionId:`${x}-form-item-description`,formMessageId:`${x}-form-item-message`,...i}},Un=a.createContext({}),ls=a.forwardRef(({className:s,...r},t)=>{const n=a.useId();return e.jsx(Un.Provider,{value:{id:n},children:e.jsx("div",{ref:t,className:ie("space-y-2",s),...r})})});ls.displayName="FormItem";const is=a.forwardRef(({className:s,...r},t)=>{const{error:n,formItemId:i}=ca();return e.jsx(S,{ref:t,className:ie(n&&"text-destructive",s),htmlFor:i,...r})});is.displayName="FormLabel";const ds=a.forwardRef(({...s},r)=>{const{error:t,formItemId:n,formDescriptionId:i,formMessageId:x}=ca();return e.jsx(vr,{ref:r,id:n,"aria-describedby":t?`${i} ${x}`:`${i}`,"aria-invalid":!!t,...s})});ds.displayName="FormControl";const Pd=a.forwardRef(({className:s,...r},t)=>{const{formDescriptionId:n}=ca();return e.jsx("p",{ref:t,id:n,className:ie("text-sm text-muted-foreground",s),...r})});Pd.displayName="FormDescription";const cs=a.forwardRef(({className:s,children:r,...t},n)=>{const{error:i,formMessageId:x}=ca(),g=i?String(i==null?void 0:i.message):r;return g?e.jsx("p",{ref:n,id:x,className:ie("text-sm font-medium text-destructive",s),...t,children:g}):null});cs.displayName="FormMessage";const Ed=pn({financialYear:As().min(1,"Please select financial year"),sector:As().min(1,"Please select sector"),implementingAgency:As().min(1,"Please select implementing agency"),workName:As().min(1,"Work name is required"),recommendedAmount:gn().min(1,"Amount must be greater than 0"),recommendationLetter:jn().optional()});function Td(){var c,D,de;const[s,r]=a.useState([]),[t,n]=a.useState([]),[i,x]=a.useState([]),[g,p]=a.useState([]),[d,j]=a.useState("all"),[P,W]=a.useState(""),[T,J]=a.useState(!0),[X,w]=a.useState(null),[V,F]=a.useState(!1),[N,b]=a.useState(!1),[A,C]=a.useState(null),[q,Z]=a.useState(""),{toast:B}=os(),te=xn({resolver:Nn(Ed),defaultValues:{financialYear:"",sector:"",implementingAgency:"",workName:"",recommendedAmount:0}}),Q=async()=>{try{const I="http://13.202.62.178:9090/backend-dfds",oe={Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},pe=await me.get(`${I}/api/dropdown/financial-years`,{headers:oe});n(pe.data||[]);const E=await me.get(`${I}/api/dropdown/sectors`,{headers:oe});x(E.data||[]);const z=JSON.parse(localStorage.getItem("user")||"{}").districtId;if(z){const re=await me.get(`${I}/api/dropdown/implementing-agencies?districtId=${z}`,{headers:oe});p(re.data||[])}}catch(I){console.error("Error fetching dropdown data:",I)}},G=async()=>{var I,H;try{J(!0),w(null);const oe="http://13.202.62.178:9090/backend-dfds",pe=localStorage.getItem("token"),E=d!=="all"?{financialYearId:d}:{},R=await me.get(`${oe}/api/works`,{headers:{Authorization:`Bearer ${pe}`,"Content-Type":"application/json"},params:E});r(R.data||[])}catch(oe){console.error("Error fetching works:",oe),w(((H=(I=oe.response)==null?void 0:I.data)==null?void 0:H.message)||"Failed to fetch works")}finally{J(!1)}};a.useEffect(()=>{Q()},[]),a.useEffect(()=>{G()},[d]);const l=I=>I>=1e7?`₹${(I/1e7).toFixed(1)} Cr`:I>=1e5?`₹${(I/1e5).toFixed(1)} L`:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(I),M=I=>new Date(I).toLocaleDateString("en-IN"),m=I=>{const H={APPROVED:{color:"bg-green-100 text-green-800",icon:qe},PENDING:{color:"bg-yellow-100 text-yellow-800",icon:ys},REJECTED:{color:"bg-red-100 text-red-800",icon:us},IN_PROGRESS:{color:"bg-blue-100 text-blue-800",icon:ys},COMPLETED:{color:"bg-green-100 text-green-800",icon:qe},NOT_STARTED:{color:"bg-gray-100 text-gray-800",icon:ys}},oe=H[I]||H.PENDING,pe=oe.icon;return e.jsxs(ye,{className:oe.color,children:[e.jsx(pe,{className:"w-3 h-3 mr-1"}),I.replace("_"," ")]})},y=I=>{var oe;const H=(oe=I.target.files)==null?void 0:oe[0];H&&(Z(H.name),te.setValue("recommendationLetter",H))},o=async I=>{try{C(I),b(!0)}catch{B({title:"Error",description:"Failed to prepare form data",variant:"destructive"})}},ne=async()=>{var I,H;try{const oe="http://13.202.62.178:9090/backend-dfds",pe=localStorage.getItem("token"),E=new FormData;E.append("financialYearId",A.financialYear),E.append("sectorId",A.sector),E.append("implementingAgencyId",A.implementingAgency),E.append("workName",A.workName),E.append("recommendedAmount",A.recommendedAmount.toString()),A.recommendationLetter&&E.append("recommendationLetter",A.recommendationLetter);const R=await me.post(`${oe}/api/works/recommend/mla`,E,{headers:{Authorization:`Bearer ${pe}`,"Content-Type":"multipart/form-data"}});R.data.success?(B({title:"Success",description:"Work recommendation submitted successfully"}),F(!1),b(!1),te.reset(),Z(""),C(null),G()):B({title:"Error",description:R.data.message||"Failed to submit recommendation",variant:"destructive"})}catch(oe){B({title:"Error",description:((H=(I=oe.response)==null?void 0:I.data)==null?void 0:H.message)||"Failed to submit recommendation",variant:"destructive"})}},he=()=>{console.log("Export functionality to be implemented")},k=s.filter(I=>{var H;return I.workName.toLowerCase().includes(P.toLowerCase())||I.workCode.toLowerCase().includes(P.toLowerCase())||((H=I.implementingAgency)==null?void 0:H.fullname.toLowerCase().includes(P.toLowerCase()))});return T?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"w-6 h-6 animate-spin text-blue-600"}),e.jsx("span",{className:"text-lg font-medium text-gray-600",children:"Loading works..."})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"MLA Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage work recommendations"})]}),e.jsxs(L,{onClick:G,variant:"outline",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),e.jsx(O,{children:e.jsxs($,{className:"p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Recommend New Work"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Submit new work recommendations for approval and budget allocation."}),e.jsxs(L,{onClick:()=>F(!0),size:"lg",children:[e.jsx(ps,{className:"w-5 h-5 mr-2"}),"+ Recommend New Work"]})]})}),e.jsxs(O,{children:[e.jsx(se,{children:e.jsx(ee,{className:"text-xl font-bold",children:"Recent Works"})}),e.jsxs($,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center mb-6",children:[e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Financial Year"}),e.jsxs(Ne,{value:d,onValueChange:j,children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"All Financial Years"})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"all",children:"All Financial Years"}),t.map(I=>e.jsx(ae,{value:I.id.toString(),children:I.name},I.id))]})]})]}),e.jsxs("div",{className:"flex-1 min-w-[300px]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(zs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(_,{placeholder:"Search works, implementing agency...",value:P,onChange:I=>W(I.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "}),e.jsxs(L,{onClick:he,variant:"outline",children:[e.jsx(Xs,{className:"w-4 h-4 mr-2"}),"Export"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ke,{children:[e.jsx(Be,{children:e.jsxs(ue,{children:[e.jsx(U,{children:"Sr No"}),e.jsx(U,{children:"Work Name"}),e.jsx(U,{children:"Work Code"}),e.jsx(U,{children:"Implementing Agency"}),e.jsx(U,{className:"text-right",children:"Gross Amount"}),e.jsx(U,{className:"text-right",children:"Balance Amount"}),e.jsx(U,{children:"Status"}),e.jsx(U,{children:"Created Date"})]})}),e.jsx(We,{children:k.map((I,H)=>{var oe,pe;return e.jsxs(ue,{children:[e.jsx(h,{className:"font-medium",children:H+1}),e.jsx(h,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:I.workName}),e.jsx("p",{className:"text-xs text-gray-500",children:I.description})]})}),e.jsx(h,{children:e.jsx("span",{className:"text-sm",children:I.workCode})}),e.jsx(h,{children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:(oe=I.implementingAgency)==null?void 0:oe.fullname}),e.jsx("p",{className:"text-xs text-gray-500",children:(pe=I.implementingAgency)==null?void 0:pe.designation})]})}),e.jsx(h,{className:"text-right font-medium",children:l(I.grossAmount)}),e.jsx(h,{className:"text-right font-medium",children:l(I.balanceAmount)}),e.jsx(h,{children:m(I.status)}),e.jsx(h,{className:"text-sm text-gray-500",children:M(I.createdAt)})]},I.id)})}),k.length===0&&e.jsx(js,{children:e.jsx(ue,{children:e.jsx(h,{colSpan:9,className:"text-center py-8 text-gray-500",children:"No works found"})})})]})})]})]}),e.jsx(ts,{open:V,onOpenChange:F,children:e.jsx(Ze,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:N?e.jsxs(e.Fragment,{children:[e.jsxs(as,{children:[e.jsx(rs,{className:"text-xl font-semibold",children:"Confirm Submission"}),e.jsx(Zs,{children:"Please review your work recommendation details before final submission."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-3",children:[e.jsx("h4",{className:"font-medium",children:"Work Recommendation Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Financial Year:"}),e.jsx("div",{className:"font-medium",children:(c=t.find(I=>I.id.toString()===(A==null?void 0:A.financialYear)))==null?void 0:c.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Sector:"}),e.jsx("div",{className:"font-medium",children:(D=i.find(I=>I.id.toString()===(A==null?void 0:A.sector)))==null?void 0:D.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Implementing Agency:"}),e.jsx("div",{className:"font-medium",children:(de=g.find(I=>I.id.toString()===(A==null?void 0:A.implementingAgency)))==null?void 0:de.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Amount:"}),e.jsx("div",{className:"font-medium",children:l((A==null?void 0:A.recommendedAmount)||0)})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Work Name:"}),e.jsx("div",{className:"font-medium",children:A==null?void 0:A.workName})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[e.jsx(L,{type:"button",variant:"outline",onClick:()=>b(!1),children:"Back to Edit"}),e.jsx(L,{onClick:ne,children:"Confirm & Submit"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(as,{children:[e.jsx(rs,{className:"text-xl font-semibold",children:"Recommend New Work"}),e.jsx(Zs,{children:"Submit a new work recommendation for approval and budget allocation."})]}),e.jsx($n,{...te,children:e.jsxs("form",{onSubmit:te.handleSubmit(o),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(hs,{control:te.control,name:"financialYear",render:({field:I})=>e.jsxs(ls,{children:[e.jsx(is,{children:"Financial Year"}),e.jsxs(Ne,{onValueChange:I.onChange,defaultValue:I.value,children:[e.jsx(ds,{children:e.jsx(je,{children:e.jsx(fe,{placeholder:"Select Financial Year"})})}),e.jsx(ge,{children:t.map(H=>e.jsx(ae,{value:H.id.toString(),children:H.name},H.id))})]}),e.jsx(cs,{})]})}),e.jsx(hs,{control:te.control,name:"sector",render:({field:I})=>e.jsxs(ls,{children:[e.jsx(is,{children:"Sector"}),e.jsxs(Ne,{onValueChange:I.onChange,defaultValue:I.value,children:[e.jsx(ds,{children:e.jsx(je,{children:e.jsx(fe,{placeholder:"Select Sector"})})}),e.jsx(ge,{children:i.map(H=>e.jsx(ae,{value:H.id.toString(),children:H.name},H.id))})]}),e.jsx(cs,{})]})})]}),e.jsx(hs,{control:te.control,name:"implementingAgency",render:({field:I})=>e.jsxs(ls,{children:[e.jsx(is,{children:"Implementing Agency"}),e.jsxs(Ne,{onValueChange:I.onChange,defaultValue:I.value,children:[e.jsx(ds,{children:e.jsx(je,{children:e.jsx(fe,{placeholder:"Select Implementing Agency"})})}),e.jsx(ge,{children:g.map(H=>e.jsxs(ae,{value:H.id.toString(),children:[H.name," (",H.code,")"]},H.id))})]}),e.jsx(cs,{})]})}),e.jsx(hs,{control:te.control,name:"workName",render:({field:I})=>e.jsxs(ls,{children:[e.jsx(is,{children:"Work Name"}),e.jsx(ds,{children:e.jsx(Ks,{placeholder:"Enter detailed work description",className:"min-h-[80px]",...I})}),e.jsx(cs,{})]})}),e.jsx(hs,{control:te.control,name:"recommendedAmount",render:({field:I})=>e.jsxs(ls,{children:[e.jsx(is,{children:"Recommended Amount (₹)"}),e.jsx(ds,{children:e.jsx(_,{type:"number",placeholder:"Enter amount",...I,onChange:H=>I.onChange(Number(H.target.value))})}),e.jsx(cs,{})]})}),e.jsx(hs,{control:te.control,name:"recommendationLetter",render:({field:I})=>e.jsxs(ls,{children:[e.jsx(is,{children:"Recommendation Letter"}),e.jsx(ds,{children:e.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",accept:".pdf,.doc,.docx",onChange:y,className:"hidden",id:"file-upload"}),e.jsx("label",{htmlFor:"file-upload",className:"cursor-pointer",children:e.jsx("div",{className:"flex flex-col items-center space-y-2",children:q?e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"h-8 w-8 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:q}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Click to change file"})]}):e.jsxs(e.Fragment,{children:[e.jsx(hn,{className:"h-8 w-8 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Click to upload recommendation letter"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"PDF, DOC, DOCX up to 10MB"})]})})})]})}),e.jsx(cs,{})]})}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[e.jsx(L,{type:"button",variant:"outline",onClick:()=>F(!1),children:"Cancel"}),e.jsx(L,{type:"submit",children:"Submit Recommendation"})]})]})})]})})})]})}function Id(){return e.jsx("div",{})}function Fd(){const[s,r]=a.useState([]),[t,n]=a.useState([]),[i,x]=a.useState("2024-25"),[g,p]=a.useState(""),[d,j]=a.useState(!0),[P,W]=a.useState(null),[T,J]=a.useState(null),X={mlcName:"Shri Dilip Dattatray Walse",region:"Western Maharashtra",tenure:"2024-2029",totalLimit:25},w=async()=>{try{const m="http://13.202.62.178:9090/backend-dfds",y=localStorage.getItem("token"),o=await me.get(`${m}/api/dropdown/financial-years`,{headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json"}});n(o.data||[])}catch(m){console.error("Error fetching financial years:",m)}},V=async()=>{try{const m="http://13.202.62.178:9090/backend-dfds",y=localStorage.getItem("token"),o=await me.get(`${m}/api/mlc-budget/getMLCBudgets`,{headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json"}});J(o.data||null)}catch(m){console.error("Error fetching MLC budget:",m)}},F=async()=>{var m,y;try{j(!0),W(null);const o="http://13.202.62.178:9090/backend-dfds",ne=localStorage.getItem("token"),he=await me.get(`${o}/api/works`,{headers:{Authorization:`Bearer ${ne}`,"Content-Type":"application/json"}});r(he.data||[])}catch(o){console.error("Error fetching works data:",o),W(((y=(m=o.response)==null?void 0:m.data)==null?void 0:y.message)||"Failed to fetch works data")}finally{j(!1)}};a.useEffect(()=>{w()},[]),a.useEffect(()=>{F()},[]),a.useEffect(()=>{V()},[]);const N=m=>m>=1e7?`₹${(m/1e7).toFixed(1)} Cr`:m>=1e5?`₹${(m/1e5).toFixed(1)} L`:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(m),b=()=>{console.log("Export functionality to be implemented")};if(d)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"w-6 h-6 animate-spin text-blue-600"}),e.jsx("span",{className:"text-lg font-medium text-gray-600",children:"Loading dashboard..."})]})});if(P)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(O,{className:"w-full max-w-md",children:e.jsxs($,{className:"p-6 text-center",children:[e.jsx(us,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error Loading Dashboard"}),e.jsx("p",{className:"text-gray-600 mb-4",children:P}),e.jsxs(L,{onClick:F,className:"w-full",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Retry"]})]})})});const A=s.filter(m=>m.financialYear===i),C=A.filter(m=>m.status==="RECOMMENDED"||m.status==="PENDING"),q=A.filter(m=>m.status==="APPROVED"||m.status==="SANCTIONED"),Z=(T==null?void 0:T.allocatedBudget)||q.reduce((m,y)=>m+y.adminApprovedAmount,0),B=C.reduce((m,y)=>m+y.grossAmount,0),te=q.reduce((m,y)=>m+y.adminApprovedAmount,0),Q=(T==null?void 0:T.remainingBudget)||Z-te,G=(T==null?void 0:T.lastYearSpill)||50,l=(T==null?void 0:T.permissibleScope)||X.totalLimit*1e7-Q,M=s.filter(m=>{var y;return m.workName.toLowerCase().includes(g.toLowerCase())||m.workCode.toLowerCase().includes(g.toLowerCase())||((y=m.implementingAgency)==null?void 0:y.fullname.toLowerCase().includes(g.toLowerCase()))});return e.jsxs("div",{className:"p-6 space-y-6 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:e.jsx(Es,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"MLC Dashboard"}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mt-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Es,{className:"w-4 h-4 mr-1"}),X.mlcName]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ia,{className:"w-4 h-4 mr-1"}),X.region]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(mt,{className:"w-4 h-4 mr-1"}),"Tenure: ",X.tenure]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ea,{className:"w-4 h-4 mr-1"}),"Total Limit: ₹",X.totalLimit," Crores"]})]}),e.jsx(ye,{className:"bg-green-100 text-green-800 mt-2",children:"Active Session"})]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(Ne,{value:i,onValueChange:x,children:[e.jsx(je,{className:"w-48",children:e.jsx(fe,{placeholder:"Select Financial Year"})}),e.jsx(ge,{children:t.map(m=>e.jsx(ae,{value:m.name,children:m.name},m.id))})]}),e.jsxs("div",{className:"relative",children:[e.jsx(zs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(_,{placeholder:"Search works, IA name, or AA letter...",value:g,onChange:m=>p(m.target.value),className:"pl-10 w-96"})]})]}),e.jsxs(L,{onClick:b,variant:"outline",children:[e.jsx(Xs,{className:"w-4 h-4 mr-2"}),"Export"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(Ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsx(O,{className:"bg-white border border-gray-200",children:e.jsx($,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(ea,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Current FY Budget Sanctioned"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N(Z)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Remaining Balance: ",N(Q)," | Last Year Spill: ",N(G)]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Re,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:"View"})]})]})})})}),e.jsx(Ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsx(O,{className:"bg-white border border-gray-200",children:e.jsx($,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(on,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Total Works Recommended"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:C.length}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Total Work Cost: ",N(B)]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Re,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:"View"})]})]})})})}),e.jsx(Ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsx(O,{className:"bg-white border border-gray-200",children:e.jsx($,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(ra,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Total Works Sanctioned"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:q.length}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Cost of Sanctioned Works: ",N(te)]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Re,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:"View"})]})]})})})}),e.jsx(Ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:e.jsx(O,{className:"bg-white border border-gray-200",children:e.jsx($,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(mn,{className:"w-5 h-5 text-yellow-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Permissible Scope"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N(l)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Remaining Scope: ",N(l-B)]})]})})})})})]}),e.jsx(O,{className:"bg-white border border-gray-200",children:e.jsx($,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ke,{children:[e.jsx(Be,{children:e.jsxs(ue,{className:"bg-gray-50",children:[e.jsx(U,{className:"text-center font-semibold",children:"Sr No"}),e.jsx(U,{className:"font-semibold",children:"Work Name"}),e.jsx(U,{className:"font-semibold",children:"IA Name"}),e.jsx(U,{className:"font-semibold",children:"MLC Letter"}),e.jsx(U,{className:"text-right font-semibold",children:"Recommended Amount"}),e.jsx(U,{className:"text-right font-semibold",children:"AA Amount"}),e.jsx(U,{className:"font-semibold",children:"AA Letter"}),e.jsx(U,{className:"text-right font-semibold",children:"Fund Disbursed"}),e.jsx(U,{className:"font-semibold",children:"Status"})]})}),e.jsx(We,{children:M.map((m,y)=>{var o,ne;return e.jsxs(ue,{className:"hover:bg-gray-50",children:[e.jsx(h,{className:"text-center font-medium",children:y+1}),e.jsx(h,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:m.workName}),e.jsxs("p",{className:"text-xs text-gray-500",children:["FY: ",m.financialYear]})]})}),e.jsx(h,{children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:((o=m.implementingAgency)==null?void 0:o.fullname)||"Executive Engineer, Public Works North Division, Pune"}),e.jsx("p",{className:"text-xs text-gray-500",children:((ne=m.implementingAgency)==null?void 0:ne.designation)||"Executive Engineer"})]})}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"text-sm",children:["ML/2425/",m.id]}),e.jsx(sa,{className:"w-3 h-3 text-blue-500 cursor-pointer hover:text-blue-700"})]})}),e.jsx(h,{className:"text-right font-medium",children:N(m.grossAmount)}),e.jsx(h,{className:"text-right font-medium",children:N(m.adminApprovedAmount)}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"text-sm",children:"AA/2024/001"}),e.jsx(sa,{className:"w-3 h-3 text-blue-500 cursor-pointer hover:text-blue-700"})]})}),e.jsx(h,{className:"text-right font-medium text-green-600",children:"₹0.0"}),e.jsx(h,{children:e.jsx(ye,{className:m.status==="APPROVED"?"bg-green-100 text-green-800":m.status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800",children:m.status==="APPROVED"?"Not Started":m.status})})]},m.id)})}),M.length===0&&e.jsx(js,{children:e.jsx(ue,{children:e.jsx(h,{colSpan:9,className:"text-center py-8 text-gray-500",children:"No works found"})})})]})})})})]})}const Rd=pn({financialYear:As().min(1,"Please select financial year"),sector:As().min(1,"Please select sector"),workType:As().min(1,"Please select work type"),district:As().optional(),implementingAgency:As().min(1,"Please select implementing agency"),workName:As().min(1,"Work name is required"),recommendedAmount:gn().min(1,"Amount must be greater than 0"),recommendationLetter:jn().optional()});function Od(){var oe,pe,E,R;const[s,r]=a.useState([]),[t,n]=a.useState([]),[i,x]=a.useState([]),[g,p]=a.useState([]),[d,j]=a.useState([]),[P,W]=a.useState("all"),[T,J]=a.useState(""),[X,w]=a.useState(""),[V,F]=a.useState(!0),[N,b]=a.useState(null),[A,C]=a.useState(!1),[q,Z]=a.useState(!1),[B,te]=a.useState(null),[Q,G]=a.useState(""),{toast:l}=os(),M=xn({resolver:Nn(Rd),defaultValues:{financialYear:"",sector:"",workType:"",district:"",implementingAgency:"",workName:"",recommendedAmount:0}}),m=async()=>{try{const z="http://13.202.62.178:9090/backend-dfds",xe={Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},Ee=await me.get(`${z}/api/dropdown/financial-years`,{headers:xe});n(Ee.data||[]);const De=await me.get(`${z}/api/dropdown/sectors`,{headers:xe});x(De.data||[]);const ms=JSON.parse(localStorage.getItem("user")||"{}").districtId;if(ms){const Te=await me.get(`${z}/api/dropdown/implementing-agencies?districtId=${ms}`,{headers:xe});p(Te.data||[])}const Ye=await me.get(`${z}/api/dropdown/districts`,{headers:xe});j(Ye.data||[])}catch(z){console.error("Error fetching dropdown data:",z)}},y=async()=>{var z,re;try{F(!0),b(null);const xe="http://13.202.62.178:9090/backend-dfds",Ee=localStorage.getItem("token"),De=P!=="all"?{financialYearId:P}:{},Fe=await me.get(`${xe}/api/works`,{headers:{Authorization:`Bearer ${Ee}`,"Content-Type":"application/json"},params:De});r(Fe.data||[])}catch(xe){console.error("Error fetching works:",xe),b(((re=(z=xe.response)==null?void 0:z.data)==null?void 0:re.message)||"Failed to fetch works")}finally{F(!1)}};a.useEffect(()=>{m()},[]),a.useEffect(()=>{y()},[P]);const o=M.watch("workType");a.useEffect(()=>{J(o),o==="NODAL"&&M.setValue("district","")},[o,M]);const ne=z=>z>=1e7?`₹${(z/1e7).toFixed(1)} Cr`:z>=1e5?`₹${(z/1e5).toFixed(1)} L`:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(z),he=z=>new Date(z).toLocaleDateString("en-IN"),k=z=>{const re={APPROVED:{color:"bg-green-100 text-green-800",icon:qe},PENDING:{color:"bg-yellow-100 text-yellow-800",icon:ys},REJECTED:{color:"bg-red-100 text-red-800",icon:us},IN_PROGRESS:{color:"bg-blue-100 text-blue-800",icon:ys},COMPLETED:{color:"bg-green-100 text-green-800",icon:qe},NOT_STARTED:{color:"bg-gray-100 text-gray-800",icon:ys}},xe=re[z]||re.PENDING,Ee=xe.icon;return e.jsxs(ye,{className:xe.color,children:[e.jsx(Ee,{className:"w-3 h-3 mr-1"}),z.replace("_"," ")]})},c=z=>{var xe;const re=(xe=z.target.files)==null?void 0:xe[0];re&&(G(re.name),M.setValue("recommendationLetter",re))},D=async z=>{try{te(z),Z(!0)}catch{l({title:"Error",description:"Failed to prepare form data",variant:"destructive"})}},de=async()=>{var z,re;try{const xe="http://13.202.62.178:9090/backend-dfds",Ee=localStorage.getItem("token"),De=new FormData;De.append("financialYearId",B.financialYear),De.append("sectorId",B.sector),De.append("workType",B.workType),B.district&&De.append("districtId",B.district),De.append("implementingAgencyId",B.implementingAgency),De.append("workName",B.workName),De.append("recommendedAmount",B.recommendedAmount.toString()),B.recommendationLetter&&De.append("recommendationLetter",B.recommendationLetter);const Fe=await me.post(`${xe}/api/works/recommend/mlc`,De,{headers:{Authorization:`Bearer ${Ee}`,"Content-Type":"multipart/form-data"}});Fe.data.success?(l({title:"Success",description:"Work recommendation submitted successfully"}),C(!1),Z(!1),M.reset(),G(""),te(null),y()):l({title:"Error",description:Fe.data.message||"Failed to submit recommendation",variant:"destructive"})}catch(xe){l({title:"Error",description:((re=(z=xe.response)==null?void 0:z.data)==null?void 0:re.message)||"Failed to submit recommendation",variant:"destructive"})}},I=()=>{console.log("Export functionality to be implemented")},H=s.filter(z=>{var re;return z.workName.toLowerCase().includes(X.toLowerCase())||z.workCode.toLowerCase().includes(X.toLowerCase())||((re=z.implementingAgency)==null?void 0:re.fullname.toLowerCase().includes(X.toLowerCase()))});return V?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"w-6 h-6 animate-spin text-blue-600"}),e.jsx("span",{className:"text-lg font-medium text-gray-600",children:"Loading works..."})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"MLC Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage work recommendations"})]}),e.jsxs(L,{onClick:y,variant:"outline",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),e.jsx(O,{children:e.jsxs($,{className:"p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Recommend New Work"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Submit new work recommendations for approval and budget allocation."}),e.jsxs(L,{onClick:()=>C(!0),size:"lg",children:[e.jsx(ps,{className:"w-5 h-5 mr-2"}),"+ Recommend New Work"]})]})}),e.jsxs(O,{children:[e.jsx(se,{children:e.jsx(ee,{className:"text-xl font-bold",children:"Recent Works"})}),e.jsxs($,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center mb-6",children:[e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Financial Year"}),e.jsxs(Ne,{value:P,onValueChange:W,children:[e.jsx(je,{children:e.jsx(fe,{placeholder:"All Financial Years"})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"all",children:"All Financial Years"}),t.map(z=>e.jsx(ae,{value:z.id.toString(),children:z.name},z.id))]})]})]}),e.jsxs("div",{className:"flex-1 min-w-[300px]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(zs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(_,{placeholder:"Search works, implementing agency...",value:X,onChange:z=>w(z.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "}),e.jsxs(L,{onClick:I,variant:"outline",children:[e.jsx(Xs,{className:"w-4 h-4 mr-2"}),"Export"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ke,{children:[e.jsx(Be,{children:e.jsxs(ue,{children:[e.jsx(U,{children:"Sr No"}),e.jsx(U,{children:"Work Name"}),e.jsx(U,{children:"Work Code"}),e.jsx(U,{children:"Implementing Agency"}),e.jsx(U,{className:"text-right",children:"Gross Amount"}),e.jsx(U,{className:"text-right",children:"Balance Amount"}),e.jsx(U,{children:"Status"}),e.jsx(U,{children:"Created Date"})]})}),e.jsx(We,{children:H.map((z,re)=>{var xe,Ee;return e.jsxs(ue,{children:[e.jsx(h,{className:"font-medium",children:re+1}),e.jsx(h,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:z.workName}),e.jsx("p",{className:"text-xs text-gray-500",children:z.description})]})}),e.jsx(h,{children:e.jsx("span",{className:"text-sm",children:z.workCode})}),e.jsx(h,{children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:(xe=z.implementingAgency)==null?void 0:xe.fullname}),e.jsx("p",{className:"text-xs text-gray-500",children:(Ee=z.implementingAgency)==null?void 0:Ee.designation})]})}),e.jsx(h,{className:"text-right font-medium",children:ne(z.grossAmount)}),e.jsx(h,{className:"text-right font-medium",children:ne(z.balanceAmount)}),e.jsx(h,{children:k(z.status)}),e.jsx(h,{className:"text-sm text-gray-500",children:he(z.createdAt)})]},z.id)})}),H.length===0&&e.jsx(js,{children:e.jsx(ue,{children:e.jsx(h,{colSpan:9,className:"text-center py-8 text-gray-500",children:"No works found"})})})]})})]})]}),e.jsx(ts,{open:A,onOpenChange:C,children:e.jsx(Ze,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:q?e.jsxs(e.Fragment,{children:[e.jsxs(as,{children:[e.jsx(rs,{className:"text-xl font-semibold",children:"Confirm Submission"}),e.jsx(Zs,{children:"Please review your work recommendation details before final submission."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-3",children:[e.jsx("h4",{className:"font-medium",children:"Work Recommendation Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Financial Year:"}),e.jsx("div",{className:"font-medium",children:(oe=t.find(z=>z.id.toString()===(B==null?void 0:B.financialYear)))==null?void 0:oe.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Sector:"}),e.jsx("div",{className:"font-medium",children:(pe=i.find(z=>z.id.toString()===(B==null?void 0:B.sector)))==null?void 0:pe.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Work Type:"}),e.jsx("div",{className:"font-medium",children:B==null?void 0:B.workType})]}),(B==null?void 0:B.district)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"District:"}),e.jsx("div",{className:"font-medium",children:(E=d.find(z=>z.id.toString()===(B==null?void 0:B.district)))==null?void 0:E.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Implementing Agency:"}),e.jsx("div",{className:"font-medium",children:(R=g.find(z=>z.id.toString()===(B==null?void 0:B.implementingAgency)))==null?void 0:R.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Amount:"}),e.jsx("div",{className:"font-medium",children:ne((B==null?void 0:B.recommendedAmount)||0)})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Work Name:"}),e.jsx("div",{className:"font-medium",children:B==null?void 0:B.workName})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[e.jsx(L,{type:"button",variant:"outline",onClick:()=>Z(!1),children:"Back to Edit"}),e.jsx(L,{onClick:de,children:"Confirm & Submit"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(as,{children:[e.jsx(rs,{className:"text-xl font-semibold",children:"Recommend New Work"}),e.jsx(Zs,{children:"Submit a new work recommendation for approval and budget allocation."})]}),e.jsx($n,{...M,children:e.jsxs("form",{onSubmit:M.handleSubmit(D),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(hs,{control:M.control,name:"financialYear",render:({field:z})=>e.jsxs(ls,{children:[e.jsx(is,{children:"Financial Year"}),e.jsxs(Ne,{onValueChange:z.onChange,defaultValue:z.value,children:[e.jsx(ds,{children:e.jsx(je,{children:e.jsx(fe,{placeholder:"Select Financial Year"})})}),e.jsx(ge,{children:t.map(re=>e.jsx(ae,{value:re.id.toString(),children:re.name},re.id))})]}),e.jsx(cs,{})]})}),e.jsx(hs,{control:M.control,name:"sector",render:({field:z})=>e.jsxs(ls,{children:[e.jsx(is,{children:"Sector"}),e.jsxs(Ne,{onValueChange:z.onChange,defaultValue:z.value,children:[e.jsx(ds,{children:e.jsx(je,{children:e.jsx(fe,{placeholder:"Select Sector"})})}),e.jsx(ge,{children:i.map(re=>e.jsx(ae,{value:re.id.toString(),children:re.name},re.id))})]}),e.jsx(cs,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(hs,{control:M.control,name:"workType",render:({field:z})=>e.jsxs(ls,{children:[e.jsx(is,{children:"Work Type"}),e.jsxs(Ne,{onValueChange:z.onChange,defaultValue:z.value,children:[e.jsx(ds,{children:e.jsx(je,{children:e.jsx(fe,{placeholder:"Select Work Type"})})}),e.jsxs(ge,{children:[e.jsx(ae,{value:"NODAL",children:"NODAL"}),e.jsx(ae,{value:"NON-NODAL",children:"NON-NODAL"})]})]}),e.jsx(cs,{})]})}),T==="NON-NODAL"&&e.jsx(hs,{control:M.control,name:"district",render:({field:z})=>e.jsxs(ls,{children:[e.jsx(is,{children:"District"}),e.jsxs(Ne,{onValueChange:z.onChange,defaultValue:z.value,children:[e.jsx(ds,{children:e.jsx(je,{children:e.jsx(fe,{placeholder:"Select District"})})}),e.jsx(ge,{children:d.map(re=>e.jsx(ae,{value:re.id.toString(),children:re.name},re.id))})]}),e.jsx(cs,{})]})})]}),e.jsx(hs,{control:M.control,name:"implementingAgency",render:({field:z})=>e.jsxs(ls,{children:[e.jsx(is,{children:"Implementing Agency"}),e.jsxs(Ne,{onValueChange:z.onChange,defaultValue:z.value,children:[e.jsx(ds,{children:e.jsx(je,{children:e.jsx(fe,{placeholder:"Select Implementing Agency"})})}),e.jsx(ge,{children:g.map(re=>e.jsxs(ae,{value:re.id.toString(),children:[re.name," (",re.code,")"]},re.id))})]}),e.jsx(cs,{})]})}),e.jsx(hs,{control:M.control,name:"workName",render:({field:z})=>e.jsxs(ls,{children:[e.jsx(is,{children:"Work Name"}),e.jsx(ds,{children:e.jsx(Ks,{placeholder:"Enter detailed work description",className:"min-h-[80px]",...z})}),e.jsx(cs,{})]})}),e.jsx(hs,{control:M.control,name:"recommendedAmount",render:({field:z})=>e.jsxs(ls,{children:[e.jsx(is,{children:"Recommended Amount (₹)"}),e.jsx(ds,{children:e.jsx(_,{type:"number",placeholder:"Enter amount",...z,onChange:re=>z.onChange(Number(re.target.value))})}),e.jsx(cs,{})]})}),e.jsx(hs,{control:M.control,name:"recommendationLetter",render:({field:z})=>e.jsxs(ls,{children:[e.jsx(is,{children:"Recommendation Letter"}),e.jsx(ds,{children:e.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",accept:".pdf,.doc,.docx",onChange:c,className:"hidden",id:"file-upload"}),e.jsx("label",{htmlFor:"file-upload",className:"cursor-pointer",children:e.jsx("div",{className:"flex flex-col items-center space-y-2",children:Q?e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"h-8 w-8 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:Q}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Click to change file"})]}):e.jsxs(e.Fragment,{children:[e.jsx(hn,{className:"h-8 w-8 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Click to upload recommendation letter"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"PDF, DOC, DOCX up to 10MB"})]})})})]})}),e.jsx(cs,{})]})}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[e.jsx(L,{type:"button",variant:"outline",onClick:()=>C(!1),children:"Cancel"}),e.jsx(L,{type:"submit",children:"Submit Recommendation"})]})]})})]})})})]})}function Vd(){return e.jsx("div",{})}function $d(){const[s,r]=a.useState(null),[t,n]=a.useState(!0),[i,x]=a.useState(null),[g,p]=a.useState("overview"),d=async()=>{var N,b,A,C,q,Z,B,te,Q;try{n(!0),x(null);const G="http://13.202.62.178:9090/backend-dfds",l=localStorage.getItem("token");console.log("Token available:",!!l),console.log("Base URL:",G),console.log("Using token:",l?l.substring(0,20)+"...":"No token");let M,m;try{const y=`${G}/api/vendor/dashboard`,o={Authorization:`Bearer ${l}`,"Content-Type":"application/json"};console.log("Trying endpoint 1:",y),console.log("Request Headers:",o),M=await me.get(y,{headers:o}),console.log("Success with endpoint 1!")}catch(y){console.log("Endpoint 1 failed:",(N=y.response)==null?void 0:N.status),m=y;try{const o=`${G}/api/vendors/dashboard`;console.log("Trying endpoint 2:",o),M=await me.get(o,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}}),console.log("Success with endpoint 2!")}catch(o){console.log("Endpoint 2 failed:",(b=o.response)==null?void 0:b.status),m=o;try{const ne=`${G}/api/vendor`;console.log("Trying endpoint 3:",ne),M=await me.get(ne,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}}),console.log("Success with endpoint 3!")}catch(ne){console.log("Endpoint 3 failed:",(A=ne.response)==null?void 0:A.status),m=ne;try{const he=`${G}/api/vendor/dashboard`;console.log("Trying endpoint 4 (no Bearer):",he),M=await me.get(he,{headers:{Authorization:l,"Content-Type":"application/json"}}),console.log("Success with endpoint 4!")}catch{throw console.log("All endpoints failed"),m}}}}r(M.data)}catch(G){console.error("Full error object:",G),console.error("Error response:",G.response),console.error("Error status:",(C=G.response)==null?void 0:C.status),console.error("Error data:",(q=G.response)==null?void 0:q.data),((Z=G.response)==null?void 0:Z.status)===403?x("Access forbidden. Please check your authentication token."):((B=G.response)==null?void 0:B.status)===401?x("Unauthorized. Please login again."):x(((Q=(te=G.response)==null?void 0:te.data)==null?void 0:Q.message)||"Failed to fetch dashboard data")}finally{n(!1)}};a.useEffect(()=>{d()},[]);const j=N=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(N),P=N=>new Date(N).toLocaleDateString("en-IN"),W=N=>{const b={PENDING:{color:"bg-yellow-100 text-yellow-800",icon:ys},APPROVED:{color:"bg-green-100 text-green-800",icon:qe},REJECTED:{color:"bg-red-100 text-red-800",icon:Ts},TRANSFERRED:{color:"bg-blue-100 text-blue-800",icon:_a},APPROVED_BY_STATE:{color:"bg-purple-100 text-purple-800",icon:qe}},A=b[N]||b.PENDING,C=A.icon;return e.jsxs(ye,{className:A.color,children:[e.jsx(C,{className:"w-3 h-3 mr-1"}),N.replace("_"," ")]})},T=N=>{const b={IN_PROGRESS:{color:"bg-blue-100 text-blue-800",icon:ha},COMPLETED:{color:"bg-green-100 text-green-800",icon:qe},PENDING:{color:"bg-yellow-100 text-yellow-800",icon:ys},ON_HOLD:{color:"bg-orange-100 text-orange-800",icon:us}},A=b[N]||b.PENDING,C=A.icon;return e.jsxs(ye,{className:A.color,children:[e.jsx(C,{className:"w-3 h-3 mr-1"}),N.replace("_"," ")]})};if(t)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"w-6 h-6 animate-spin text-blue-600"}),e.jsx("span",{className:"text-lg font-medium text-gray-600",children:"Loading dashboard..."})]})});if(i)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(O,{className:"w-full max-w-md",children:e.jsxs($,{className:"p-6 text-center",children:[e.jsx(us,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error Loading Dashboard"}),e.jsx("p",{className:"text-gray-600 mb-4",children:i}),e.jsxs(L,{onClick:d,className:"w-full",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Retry"]})]})})});if(!s)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(O,{className:"w-full max-w-md",children:e.jsxs($,{className:"p-6 text-center",children:[e.jsx(us,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Data Available"}),e.jsx("p",{className:"text-gray-600",children:"No dashboard data found."})]})})});const J=s.totalDemands,X=s.totalWorks,w=s.totalGrossDemanded,V=s.totalNetDemanded,F=s.totalTransferred;return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Vendor Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Overview of your demands and works"})]}),e.jsxs(L,{onClick:d,variant:"outline",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(Ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsx(O,{className:"border-l-4 border-blue-500",children:e.jsx($,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Demands"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:J})]}),e.jsx(ze,{className:"w-8 h-8 text-blue-500"})]})})})}),e.jsx(Ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsx(O,{className:"border-l-4 border-green-500",children:e.jsx($,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Works"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:X})]}),e.jsx(ha,{className:"w-8 h-8 text-green-500"})]})})})}),e.jsx(Ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsx(O,{className:"border-l-4 border-purple-500",children:e.jsx($,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Gross Amount"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j(w)})]}),e.jsx(Rl,{className:"w-8 h-8 text-purple-500"})]})})})}),e.jsx(Ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:e.jsx(O,{className:"border-l-4 border-orange-500",children:e.jsx($,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Net Amount"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j(V)})]}),e.jsx(Rs,{className:"w-8 h-8 text-orange-500"})]})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx(O,{className:"bg-yellow-50 border-yellow-200",children:e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Pending"}),e.jsx("p",{className:"text-xl font-bold text-yellow-900",children:s.pendingDemands})]}),e.jsx(ys,{className:"w-6 h-6 text-yellow-600"})]})})}),e.jsx(O,{className:"bg-green-50 border-green-200",children:e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Approved"}),e.jsx("p",{className:"text-xl font-bold text-green-900",children:s.approvedByStateDemands})]}),e.jsx(qe,{className:"w-6 h-6 text-green-600"})]})})}),e.jsx(O,{className:"bg-red-50 border-red-200",children:e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:"Rejected"}),e.jsx("p",{className:"text-xl font-bold text-red-900",children:s.rejectedDemands})]}),e.jsx(Ts,{className:"w-6 h-6 text-red-600"})]})})}),e.jsx(O,{className:"bg-blue-50 border-blue-200",children:e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Transferred"}),e.jsx("p",{className:"text-xl font-bold text-blue-900",children:s.transferredDemands})]}),e.jsx(_a,{className:"w-6 h-6 text-blue-600"})]})})}),e.jsx(O,{className:"bg-purple-50 border-purple-200",children:e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-800",children:"Total Transferred"}),e.jsx("p",{className:"text-xl font-bold text-purple-900",children:j(F)})]}),e.jsx(Rs,{className:"w-6 h-6 text-purple-600"})]})})})]}),e.jsxs(Qs,{value:g,onValueChange:p,className:"space-y-4",children:[e.jsxs(Us,{className:"grid w-full grid-cols-2",children:[e.jsx(Ve,{value:"overview",children:"Demands Overview"}),e.jsx(Ve,{value:"works",children:"Works Overview"})]}),e.jsx(Ie,{value:"overview",className:"space-y-4",children:e.jsxs(O,{children:[e.jsx(se,{children:e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5"}),"Demands Details"]})}),e.jsx($,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ke,{children:[e.jsx(Be,{children:e.jsxs(ue,{children:[e.jsx(U,{children:"Demand ID"}),e.jsx(U,{children:"Work Details"}),e.jsx(U,{children:"Scheme"}),e.jsx(U,{children:"District"}),e.jsx(U,{children:"Demand Date"}),e.jsx(U,{className:"text-right",children:"Gross Amount"}),e.jsx(U,{className:"text-right",children:"Net Payable"}),e.jsx(U,{children:"Status"}),e.jsx(U,{children:"Payment Ref"})]})}),e.jsx(We,{children:s.demands.map(N=>e.jsxs(ue,{children:[e.jsx(h,{className:"font-medium",children:N.demandId}),e.jsx(h,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:N.workName}),e.jsx("p",{className:"text-xs text-gray-500",children:N.workCode})]})}),e.jsx(h,{children:N.schemeName}),e.jsx(h,{children:N.districtName}),e.jsx(h,{children:P(N.demandDate)}),e.jsx(h,{className:"text-right font-medium",children:j(N.grossAmount)}),e.jsx(h,{className:"text-right font-medium",children:j(N.netPayable)}),e.jsx(h,{children:W(N.status)}),e.jsx(h,{children:N.paymentRefNo?e.jsx("span",{className:"text-sm text-gray-600",children:N.paymentRefNo}):e.jsx("span",{className:"text-sm text-gray-400",children:"-"})})]},N.id))}),s.demands.length===0&&e.jsx(js,{children:e.jsx(ue,{children:e.jsx(h,{colSpan:9,className:"text-center py-8 text-gray-500",children:"No demands found"})})})]})})})]})}),e.jsx(Ie,{value:"works",className:"space-y-4",children:e.jsxs(O,{children:[e.jsx(se,{children:e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(ha,{className:"w-5 h-5"}),"Works Details"]})}),e.jsx($,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ke,{children:[e.jsx(Be,{children:e.jsxs(ue,{children:[e.jsx(U,{children:"Work Code"}),e.jsx(U,{children:"Work Name"}),e.jsx(U,{children:"Scheme"}),e.jsx(U,{children:"District"}),e.jsx(U,{children:"IA Details"}),e.jsx(U,{className:"text-right",children:"Approved Amount"}),e.jsx(U,{className:"text-right",children:"Balance Amount"}),e.jsx(U,{children:"Status"})]})}),e.jsx(We,{children:s.works.map(N=>e.jsxs(ue,{children:[e.jsx(h,{className:"font-medium",children:N.workCode}),e.jsx(h,{children:e.jsx("div",{children:e.jsx("p",{className:"font-medium text-sm",children:N.workName})})}),e.jsx(h,{children:N.schemeName}),e.jsx(h,{children:N.districtName}),e.jsx(h,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:N.iaFullname}),e.jsx("p",{className:"text-xs text-gray-500",children:N.iaUsername})]})}),e.jsx(h,{className:"text-right font-medium",children:j(N.adminApprovedAmount)}),e.jsx(h,{className:"text-right font-medium",children:j(N.balanceAmount)}),e.jsx(h,{children:T(N.status)})]},N.workId))}),s.works.length===0&&e.jsx(js,{children:e.jsx(ue,{children:e.jsx(h,{colSpan:8,className:"text-center py-8 text-gray-500",children:"No works found"})})})]})})})]})})]}),Object.keys(s.worksByStatus).length>0&&e.jsxs(O,{children:[e.jsx(se,{children:e.jsx(ee,{children:"Works by Status"})}),e.jsx($,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(s.worksByStatus).map(([N,b])=>e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:N.replace("_"," ")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:b})]},N))})})]})]})}const zd=new ql,ke=({children:s})=>{const{user:r,isLoading:t}=Cs();return t?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})}):r?e.jsx(pi,{children:s}):e.jsx(_e,{to:"/login"})},Ud=()=>{const{user:s,isLoading:r}=Cs();if(r)return null;if(!s)return e.jsx(_e,{to:"/login",replace:!0});switch(s.role){case"IA_ADMIN":return e.jsx(_e,{to:"/iadashboard",replace:!0});case"DISTRICT_ADMIN":case"DISTRICT_COLLECTOR":case"DISTRICT_DPO":case"DISTRICT_ADPO":case"DISTRICT_CHECKER":case"DISTRICT_MAKER":return e.jsx(_e,{to:"/district-dashboard",replace:!0});case"STATE_ADMIN":case"STATE_CHECKER":case"STATE_MAKER":return e.jsx(_e,{to:"/dashboard",replace:!0});case"MLA":case"MLA_REP":return e.jsx(_e,{to:"/mla/dashboard",replace:!0});case"MLC":return e.jsx(_e,{to:"/mlc/dashboard",replace:!0});case"HADP_ADMIN":return e.jsx(_e,{to:"/hadp/dashboard",replace:!0});case"VENDOR":return e.jsx(_e,{to:"/vendor/dashboard",replace:!0});default:return e.jsx(_e,{to:"/dashboard",replace:!0})}},Bd=s=>{if(!s)return[];switch(s.role){case"STATE_ADMIN":case"STATE_CHECKER":case"STATE_MAKER":return[e.jsx(we,{path:"/dashboard",element:e.jsx(ke,{children:e.jsx(er,{})})},"dashboard"),e.jsx(we,{path:"/budget-allocation",element:e.jsx(ke,{children:e.jsx(qi,{})})},"budget-allocation"),e.jsx(we,{path:"/district-management",element:e.jsx(ke,{children:e.jsx(Ji,{})})},"district-management"),e.jsx(we,{path:"/mla-fund-demands",element:e.jsx(ke,{children:e.jsx(Hi,{})})},"mla-fund-demands"),e.jsx(we,{path:"/mla-mlc-master",element:e.jsx(ke,{children:e.jsx(Bi,{})})},"mla-master"),e.jsx(we,{path:"/tax-master",element:e.jsx(ke,{children:e.jsx(xr,{})})},"tax-master"),e.jsx(we,{path:"/fund-history",element:e.jsx(ke,{children:e.jsx(Vi,{})})},"fund-history"),e.jsx(we,{path:"/reports",element:e.jsx(ke,{children:e.jsx(wa,{})})},"reports"),e.jsx(we,{path:"/settings",element:e.jsx(ke,{children:e.jsx(Cd,{})})},"settings")];case"DISTRICT_ADMIN":case"DISTRICT_COLLECTOR":case"DISTRICT_DPO":case"DISTRICT_ADPO":case"DISTRICT_CHECKER":case"DISTRICT_MAKER":return[e.jsx(we,{path:"/district-dashboard",element:e.jsx(ke,{children:e.jsx(Gi,{})})},"dashboard"),e.jsx(we,{path:"/view-demands",element:e.jsx(ke,{children:e.jsx(Qi,{})})},"view-demands"),e.jsx(we,{path:"/ia-master",element:e.jsx(ke,{children:e.jsx(_i,{})})},"ia-master"),e.jsx(we,{path:"/mla-mlc-recommendation",element:e.jsx(ke,{children:e.jsx(Dd,{})})},"mla-recommendation"),e.jsx(we,{path:"/reports",element:e.jsx(ke,{children:e.jsx(wa,{})})},"reports")];case"IA_ADMIN":return[e.jsx(we,{path:"/iadashboard",element:e.jsx(ke,{children:e.jsx(Mi,{})})},"dashboard"),e.jsx(we,{path:"/fund-demand",element:e.jsx(ke,{children:e.jsx(ld,{})})},"fund-demand"),e.jsx(we,{path:"/vendor-master",element:e.jsx(ke,{children:e.jsx(xd,{})})},"vendor-master"),e.jsx(we,{path:"/work-vendor",element:e.jsx(ke,{children:e.jsx(Ti,{})})},"work-vendor"),e.jsx(we,{path:"/tax-master",element:e.jsx(ke,{children:e.jsx(xr,{})})},"tax-master"),e.jsx(we,{path:"/reports",element:e.jsx(ke,{children:e.jsx(wa,{})})},"reports")];case"MLA":case"MLA_REP":return[e.jsx(we,{path:"/mla/dashboard",element:e.jsx(ke,{children:e.jsx(Md,{})})},"mla-dashboard"),e.jsx(we,{path:"/mla/view-recommendation",element:e.jsx(ke,{children:e.jsx(Td,{})})},"mla-recommendation"),e.jsx(we,{path:"/mla/reports",element:e.jsx(ke,{children:e.jsx(Id,{})})},"mla-reports")];case"MLC":return[e.jsx(we,{path:"/mlc/dashboard",element:e.jsx(ke,{children:e.jsx(Fd,{})})},"mlc-dashboard"),e.jsx(we,{path:"/mlc/view-recommendation",element:e.jsx(ke,{children:e.jsx(Od,{})})},"mlc-recommendation"),e.jsx(we,{path:"/mlc/reports",element:e.jsx(ke,{children:e.jsx(Vd,{})})},"mlc-reports")];case"HADP_ADMIN":return[e.jsx(we,{path:"/hadp/dashboard",element:e.jsx(ke,{children:e.jsx("div",{children:"HADP Dashboard (coming soon)"})})},"hadp-dashboard")];case"VENDOR":return[e.jsx(we,{path:"/vendor/dashboard",element:e.jsx(ke,{children:e.jsx($d,{})})},"vendor-dashboard")];default:return[e.jsx(we,{path:"/dashboard",element:e.jsx(ke,{children:e.jsx(er,{})})},"dashboard")]}},Wd=()=>{var n,i;const{user:s}=Cs(),[r,t]=a.useState(!0);return a.useEffect(()=>{s&&t(!1)},[s]),r&&!s?e.jsx(Ja,{onSuccess:()=>t(!1)}):e.jsxs($l,{children:[e.jsx(we,{path:"/",element:e.jsx(Ud,{})}),e.jsx(we,{path:"/login",element:s?s.role==="IA_ADMIN"?e.jsx(_e,{to:"/iadashboard",replace:!0}):(n=s.role)!=null&&n.startsWith("DISTRICT")?e.jsx(_e,{to:"/district-dashboard",replace:!0}):(i=s.role)!=null&&i.startsWith("STATE")?e.jsx(_e,{to:"/dashboard",replace:!0}):s.role==="MLA"||s.role==="MLA_REP"?e.jsx(_e,{to:"/mla/dashboard",replace:!0}):s.role==="MLC"?e.jsx(_e,{to:"/mlc/dashboard",replace:!0}):s.role==="HADP_ADMIN"?e.jsx(_e,{to:"/hadp/dashboard",replace:!0}):s.role==="VENDOR"?e.jsx(_e,{to:"/vendor/dashboard",replace:!0}):e.jsx(_e,{to:"/dashboard",replace:!0}):e.jsx(Ja,{onSuccess:()=>t(!1)})}),...Bd(s),e.jsx(we,{path:"*",element:e.jsx(hd,{})})]})},Yd=()=>e.jsx(Ol,{client:zd,children:e.jsxs(ni,{children:[e.jsx(ai,{}),e.jsx(ri,{}),e.jsx(Vl,{children:e.jsx(ii,{children:e.jsx(Wd,{})})})]})});zl(document.getElementById("root")).render(e.jsx(Yd,{}));
